(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1093:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(21),o=a.n(i),s=a(6),l=a(8),c=a(7),d=a(9),p=a(2),u=a(146),h=a.n(u),m=a(299),g=a.n(m),y=a(117),f=a.n(y),b=a(494),v=a.n(b),E=a(35),k=a.n(E),w=a(67),S=a(53),T=a(50),j=a(12),O=a(1100),x=a(1113),C=a(1101),D=a(1102),N=a(1103),A=a(1),_=a.n(A),M=a(496),L=a(301),I={key:_.a.string.isRequired,default:_.a.any.isRequired},P={getUserConfig:_.a.func,setUserConfig:_.a.func},R=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={userConfig:{loading:!0}},a.update=a.update.bind(Object(p.a)(Object(p.a)(a))),a.setUserConfig=a.setUserConfig.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"getChildContext",value:function(){return{getUserConfig:this.getUserConfig,setUserConfig:this.setUserConfig}}},{key:"getUserConfig",value:function(){return new Promise(function(e,t){var a=localStorage["userConfig"];e(a?JSON.parse(a):{})})}},{key:"setUserConfig",value:function(e){var t=this;return new Promise(function(t,a){var n,r;n="userConfig",r=JSON.stringify(e),localStorage.setItem(n,r),t()}).then(function(){t.update()})}},{key:"update",value:function(){var e=this;this.getUserConfig().then(function(t){e.setState({userConfig:t})})}},{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){return r.a.createElement(L.a,{value:this.state.userConfig,channel:"userConfig"},r.a.createElement("div",null,this.props.children))}}]),t}(n.PureComponent);R.childContextTypes=P;_.a.shape({config:_.a.any.isRequired,setUserConfig:_.a.func.isRequired,getUserConfig:_.a.func.isRequired,loading:_.a.bool}).isRequired;var F=a(302),U=a.n(F),H=a(1096),W=a(473),B=a(1111),V=function(e,t){return r.a.createElement("div",{style:{position:"relative"}},e,r.a.createElement("span",{className:"panel-button right"},r.a.createElement(W.a,{onClick:t,bsSize:"small"},r.a.createElement("i",{className:"fa fa-close"}))))},z=function(e){var t=e.children,a=e.onRemove,n=e.editable,i=e.title;return r.a.createElement("div",{className:"widget ".concat(n&&"editable")},!n&&t,n&&r.a.createElement(B.a,{header:V(i,a)},r.a.cloneElement(t,{editMode:n})))},q=a(1112),K=function(e){var t=e.widgets,a=e.layout,n=e.isOpen,i=e.onClose,o=e.onSelect,s=new Set;a.rows.forEach(function(e){e.columns.forEach(function(e){e.widgets.forEach(function(e){s.add(e.key)})})});var l=Object.keys(t).filter(function(e){return!s.has(e)}).map(function(e,a){var n=t[e];return r.a.createElement("div",{key:a,className:"picker-item",onClick:function(){o(e)}},r.a.createElement("h3",null,n.title),r.a.createElement("p",null,n.description))});return l.length||(l=r.a.createElement("h2",null,"No available widgets")),r.a.createElement(q.a,{show:n,onHide:i,className:"WidgetPicker"},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Pick a Widget")),r.a.createElement(q.a.Body,{className:"picker-grid"},l),r.a.createElement(q.a.Footer,null,r.a.createElement(W.a,{onClick:i},"Cancel")))},G={rows:[{columns:[{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]},{className:"col-sm-4",widgets:[]}]}]},J=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={editable:null!=e.saveDashboard,editMode:e.isNew,layout:e.layout,title:e.title,widgetPicker:!1,newWidgetOptions:{}},a.onAdd=a.onAdd.bind(Object(p.a)(Object(p.a)(a))),a.updateLayout=a.updateLayout.bind(Object(p.a)(Object(p.a)(a))),a.updateTitle=a.updateTitle.bind(Object(p.a)(Object(p.a)(a))),a.reset=a.reset.bind(Object(p.a)(Object(p.a)(a))),a.saveDashboard=a.saveDashboard.bind(Object(p.a)(Object(p.a)(a))),a.toggleEdit=a.toggleEdit.bind(Object(p.a)(Object(p.a)(a))),a.togglePicker=a.togglePicker.bind(Object(p.a)(Object(p.a)(a))),a.selectWidget=a.selectWidget.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"onAdd",value:function(e,t,a){this.setState({widgetPicker:!0,newWidgetOptions:{row:t,col:a}})}},{key:"updateLayout",value:function(e){this.setState({layout:e})}},{key:"updateTitle",value:function(e){this.setState({title:e.target.value})}},{key:"toggleEdit",value:function(){this.setState({editMode:!this.state.editMode})}},{key:"saveDashboard",value:function(){this.state.title?(this.props.saveDashboard(this.state.title,this.state.layout),this.toggleEdit()):this.props.errorToggle("Please enter a dashboard title")}},{key:"reset",value:function(){this.setState({layout:this.props.layout,title:this.props.title,editMode:!1,widgetPicker:!1,newWidgetOptions:{}})}},{key:"togglePicker",value:function(){this.setState({widgetPicker:!this.state.widgetPicker})}},{key:"selectWidget",value:function(e){var t=this.state.newWidgetOptions,a=t.row,n=t.col;this.updateLayout(Object(F.addWidget)(this.state.layout,a,n,e)),this.togglePicker()}},{key:"render",value:function(){return r.a.createElement("div",{className:"dashboard"},r.a.createElement(K,{widgets:this.props.widgets,layout:this.state.layout,isOpen:this.state.widgetPicker,onClose:this.togglePicker,onSelect:this.selectWidget}),r.a.createElement(Y,{title:this.state.title,editable:this.state.editable,editMode:this.state.editMode,onEdit:this.toggleEdit,onSave:this.saveDashboard,onCancel:this.reset,handleTitleChange:this.updateTitle,isNew:this.props.isNew}),r.a.createElement(H.a,{fluid:!0},r.a.createElement(U.a,{onRemove:this.updateLayout,onMove:this.updateLayout,onAdd:this.onAdd,editable:this.state.editMode,layout:this.state.layout,widgets:this.props.widgets,frameComponent:z})))}}]),t}(n.PureComponent);J.defaultProps={title:"",layout:G,isNew:!1};var Y=function(e){var t=e.title,a=e.editMode,n=e.onEdit,i=e.onSave,o=e.onCancel,s=e.handleTitleChange,l=e.isNew;return e.editable?r.a.createElement("div",{className:"titleBar clearfix"},a&&r.a.createElement("form",{onSubmit:i},r.a.createElement("input",{type:"text",className:"title",value:t,placeholder:"Dashboard Title",onChange:s}),r.a.createElement(W.a,{bsStyle:"primary",bsSize:"small",onClick:i},"Save"),r.a.createElement(W.a,{bsStyle:"warning",bsSize:"small",disabled:l,onClick:o},"Cancel")),!a&&r.a.createElement("div",{className:"edit"},r.a.createElement(W.a,{bsSize:"xsmall",onClick:n},r.a.createElement("i",{className:"fa fa-edit"})))):null},Q=a(3),X=a.n(Q),$=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={statusData:{},error:null},a.updateData=a.updateData.bind(Object(p.a)(Object(p.a)(a))),a.fetchError=a.fetchError.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){X.a.ajax({type:"get",url:"scot/api/v2/status",success:this.updateData,error:this.fetchError}),this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"updateData",value:function(e){this._isMounted&&this.setState({statusData:e})}},{key:"fetchError",value:function(e){this._isMounted&&this.setState({error:e})}},{key:"render",value:function(){var e=this.props.className,t=void 0===e?"":e,a=[];if(Array.isArray(this.state.statusData)){var n=!0,i=!1,o=void 0;try{for(var s,l=this.state.statusData[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value,d=c.name,p=c.status;p||(p="unknown"),a.push(r.a.createElement(Z,{key:d,name:d,status:p}))}}catch(h){i=!0,o=h}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}}var u=["Status",t];return a.length>4&&u.push("cols-2"),r.a.createElement("div",{className:u.join(" ")},this.state.error&&r.a.createElement(B.a,{bsStyle:"danger",header:"Error"},this.state.error),a)}}]),t}(n.PureComponent),Z=function(e){var t=e.name,a=e.status;return r.a.createElement("div",{className:"service status-".concat(a),title:"Status: ".concat(a)},t)},ee=$,te=a(1097),ae=a(1098),ne=function(e){return r.a.createElement("span",{className:"emoji",role:"img","aria-label":e.label?e.label:"","aria-hidden":e.label?"false":"true"},e.symbol)},re=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},ie=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateCategory=function(){var e=(a.state.categoryIndex+1)%a.state.gameCategories.length;a._isMounted&&a.setState({categoryIndex:e})},a.updateData=function(e){var t=[];for(var n in e)null!==n&&(console.log("".concat(re(n))),t.push(r.a.createElement(oe,{category:n,data:e[n]})));a._isMounted&&a.setState({gameData:e,gameCategories:t})},a.fetchError=function(e){a._isMounted&&a.setState({error:e})},a.state={gameData:[],gameCategories:[],categoryIndex:0,error:null},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,X.a.ajax({type:"get",url:"/scot/api/v2/game",success:this.updateData,error:this.fetchError}),this.categoryInterval=setInterval(this.updateCategory,5e3)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.categoryInterval&&clearInterval(this.categoryInterval),this._isMounted=!1}},{key:"render",value:function(){return r.a.createElement(te.a,{className:"Gamification"},r.a.createElement("h3",null,"Leaders"),this.state.error&&r.a.createElement(B.a,{bsStyle:"danger",header:"Error"},this.state.error),this.state.gameCategories[this.state.categoryIndex])}}]),t}(n.PureComponent),oe=function(e){var t=e.category,a=e.data;return r.a.createElement(B.a,{className:"category"},r.a.createElement(B.a.Title,null,r.a.createElement("b",null,"".concat(re(t)," - ").concat(a[0].tooltip))),r.a.createElement(B.a.Body,null,r.a.createElement("div",null,""!==a[0].username&&null!==a[0].username&&null!=a[0].count&&""!==a[0].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd47"})," ",a[0].username," ",r.a.createElement(ae.a,null,a[0].count)):null,""!==a[1].username&&null!=a[1].username&&null!=a[1].count&&""!==a[1].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd48"})," ",a[1].username," ",r.a.createElement(ae.a,null,a[1].count)):null,""!==a[2].username&&null!=a[2].username&&null!=a[2].count&&""!==a[2].count?r.a.createElement("div",null,r.a.createElement(ne,{symbol:"\ud83e\udd49"})," ",a[2].username," ",r.a.createElement(ae.a,null,a[2].count)):null)))},se=ie,le=function(e,t){localStorage.setItem(e,t)},ce=function(e){return localStorage[e]},de=function(e,t){localStorage.setItem(e,t)},pe=function(e){localStorage.removeItem(e)},ue=function(e){return localStorage[e]},he=a(1099);var me=a(57),ge=a.n(me),ye=a(474),fe=Object(ye.extendMoment)(ge.a),be=function(e,t){return!e||Date.now()-e>1e3*t},ve=function(){return{start:Math.floor(new Date(Date.now()-864e5).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+864e5).setHours(23,59,59,999)/1e3)}},Ee=function(){return{start:Math.floor(new Date(Date.now()-6048e5).setHours(0,0,0,0)/1e3),end:Math.floor(new Date(Date.now()+864e5).setHours(23,59,59,999)/1e3)}},ke=function(e){return[e.start,e.end]},we=function(e){return e.start+", "+e.end},Se={wall:"warning",create:"info",delete:"danger"},Te=["create","delete"],je={create:120,delete:60,wall:3600},Oe=0,xe=1,Ce=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={users:[],notifications:a.loadWall()},a.updateActivity=a.updateActivity.bind(Object(p.a)(Object(p.a)(a))),a.updateUsers=a.updateUsers.bind(Object(p.a)(Object(p.a)(a))),a.wallMessage=a.wallMessage.bind(Object(p.a)(Object(p.a)(a))),a.notification=a.notification.bind(Object(p.a)(Object(p.a)(a))),a.fetchError=a.fetchError.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.refreshTimer=setInterval(this.updateActivity,3e4),this.updateActivity(),this.props.createCallback("wall",this.wallMessage)}},{key:"componentWillUnmount",value:function(){this.refreshTimer&&clearInterval(this.refreshTimer)}},{key:"updateActivity",value:function(){this.updateUsers();var e=this.state.notifications.filter(function(e){return!be(1e3*e.time,je[e.action])});this.setState({notifications:e},this.persistWall)}},{key:"updateUsers",value:function(){var e=this;X.a.ajax({type:"get",url:"/scot/api/v2/who",success:function(t){e.setState({users:t.records.map(function(e){return{type:Oe,who:e.username,time:(t=e.last_activity,(Date.now()-1e3*t)/1e3)};var t})})},error:this.fetchError})}},{key:"persistWall",value:function(){var e=this.state.notifications.filter(function(e){return"wall"===e.action});le("walls",JSON.stringify(e))}},{key:"loadWall",value:function(){var e=ce("walls");return e?JSON.parse(e):[]}},{key:"wallMessage",value:function(e){var t=this.state.notifications;t.push({type:xe,time:e.activemqwhen,who:e.activemqwho,message:e.activemqmessage,level:Se.wall,action:"wall"}),this.setState({notifications:t},this.persistWall)}},{key:"notification",value:function(e){if(!["scot-flair","scot-alerts","scot-admin","","api"].includes(e.activemqwho)&&!0!==e.activemqwall&&"entity"!==e.activemqtype&&["create","delete"].includes(e.activemqstate)){var t=this.state.notifications;t.push({type:xe,time:Date.now()/1e3,who:e.activemqwho,message:e.activemqmessage+e.activemqid,level:Se[e.activemqstate],action:e.activemqstate}),this.setState({notifications:t})}}},{key:"addDebugItems",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this.state.notifications,a=0;a<e;a++)t.push({type:xe,time:Date.now()/1e3,who:"fred",message:"blah",level:Se.create,action:"create"});this.setState({notifications:t})}},{key:"fetchError",value:function(e){}},{key:"buildActivityItem",value:function(e,t){var a,n=function(e){var t=Math.floor(e/31536e3);return t>1?t+" years":(t=Math.floor(e/2592e3))>1?t+" months":(t=Math.floor(e/86400))>1?t+" days":(t=Math.floor(e/3600))>1?t+" hours":(t=Math.floor(e/60))>1?t+" minutes":Math.floor(e)+" seconds"}((a=e.time,(Date.now()-1e3*a)/1e3)),i="";switch(e.type){default:case Oe:i=e.who;break;case xe:i="".concat(e.who,": ").concat(e.message)}return r.a.createElement(De,{key:t,badge:n,style:e.level},i)}},{key:"render",value:function(){var e=this,t=this.props.className,a=["Activity",void 0===t?"":t],n=this.state.users.concat(this.state.notifications).sort(function(e,t){return t.time-e.time}).map(this.buildActivityItem),i=!0;if(this.marquee&&this.well){var s=window.getComputedStyle(this.marquee);parseInt(s.width,10)-parseInt(s.paddingLeft,10)>this.well.offsetWidth&&(i=!1)}return r.a.createElement(te.a,{bsSize:"small",className:a.join(" "),ref:function(t){return e.well=o.a.findDOMNode(t)}},r.a.createElement("div",{className:"marquee ".concat(i?"stopped":""),ref:function(t){return e.marquee=t}},n))}}]),t}(n.Component),De=function(e){var t=e.children,a=e.badge,n=void 0===a?null:a,i=e.style,o=void 0===i?"default":i;return r.a.createElement("div",{className:"activity-item"},r.a.createElement(he.a,{bsStyle:o},t,null!==n&&r.a.createElement(ae.a,null,n)))},Ne=Ce,Ae=a(165),_e=a(22),Me=a(41),Le=a.n(Me),Ie=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getData=function(){var e="/scot/api/v2/graph/dhheatmap?collection="+a.state.collection+"&type="+a.state.type+"&year="+a.state.year;Le.a.get(e).then(function(e){a.setState({data:e.data})})},a.loadHeatMap=function(){if(!a.props.editMode){var e=30,t=30,n=1e3-(t-0),r=300-(e-30),i=Math.floor(n/24),o=1.5*i,s=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],l=_e.n("#report_heatmap"),c=l.select("g");c.empty()&&(c=l.append("g").attr("transform","translate( "+t+", "+e+" )")),c.selectAll(".dayLabel").data(["Mo","Tu","We","Th","Fr","Sa","Su"]).enter().append("text").text(function(e){return e}).attr("x",0).attr("y",function(e,t){return t*i}).style("text-anchor","end").attr("transform","translate( -6, "+i/1.5+" )").attr("class",function(e,t){return t>=0&&t<=4?"dayLabel axis axis-worktime":"dayLabel axis"}),c.selectAll(".timeLabel").data(["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"]).enter().append("text").text(function(e){return e}).attr("x",function(e,t){return t*i}).attr("y",0).style("text-anchor","middle").attr("transform","translate( "+i/2+", -6 )").attr("class",function(e,t){return t>=7&&t<=16?"timeLabel axis axis-worktime":"timeLabel axis"}),l.selectAll(".legend").remove(),l.selectAll(".legend-text").remove();var d=_e.k().domain([0,8,_e.g(a.state.data,function(e){return e.value})]).range(s),p=c.selectAll(".hour").data(a.state.data,function(e){return e.day+":"+e.hour});p.append("title"),p.enter().append("rect").style("fill",s[0]).merge(p).attr("x",function(e){return(e.hour-1)*i}).attr("y",function(e){return(e.day-1)*i}).attr("rx",4).attr("ry",4).attr("class","hour").attr("width",i).attr("height",i).transition().duration(1e3).style("fill",function(e){return d(e.value)}),p.select("title").text(function(e){return e.value}),p.exit().remove();var u=c.selectAll(".legend").data([0].concat(d.quantiles()),function(e){return e});u.enter().append("rect").attr("class","legend").attr("x",function(e,t){return o*t}).attr("y",r).attr("width",o).attr("height",i/2).style("fill",function(e,t){return s[t]}),u.enter().append("text").text(function(e){return"\u2265 "+Math.round(e)}).attr("class","legend-text").attr("x",function(e,t){return o*t}).attr("y",r+i)}},a.collectionChange=function(e){a.setState({collection:e.target.value})},a.yearChange=function(e){a.setState({year:e.target.value})},a.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_heatmap")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},a.state={collection:"event",type:"created",year:"2017",data:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.getData(),this.loadHeatMap()}},{key:"componentDidUpdate",value:function(){this.loadHeatMap()}},{key:"render",value:function(){var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Day of Week, Hour of Day Heatmap"),r.a.createElement("label",{htmlFor:"year",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Year = ",r.a.createElement("span",{id:"year-value"}),r.a.createElement("input",{className:"report_input",type:"number",min:"2013",step:"1",value:this.state.year,id:"year",onChange:this.yearChange,disabled:e})),r.a.createElement("label",{htmlFor:"collection",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Collection = ",r.a.createElement("span",{id:"year-value"}),r.a.createElement("select",{id:"collection",value:this.state.collection,onChange:this.collectionChange,disabled:e},r.a.createElement("option",{value:"event"},"event"),r.a.createElement("option",{value:"alert"},"alert"),r.a.createElement("option",{value:"incident"},"incident"))),r.a.createElement(W.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_heatmap",viewBox:"0 0 1000 380"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),t}(n.PureComponent);function Pe(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var r=this,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];clearTimeout(t),t=setTimeout(function(){t=null,n||e.apply(r,o)},a),n&&!t&&e.apply(this,[].concat(o))}}var Re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=e[0],n=e[e.length-1],r=_e.o(a,n,t);return function(e){var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),i=Math.floor(e%60);return t?r<86400?"".concat(t,"d ").concat(a,"h"):t+"d":a?r<3600?"".concat(a,"h ").concat(n,"m"):a+"h":n?r<60?"".concat(n,"m ").concat(i,"s"):n+"m":i+"s"}},Fe=function(e){var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60)+"s";return n&&(r=n+"m "+r),a&&(r=a+"h "+r),t&&(r=t+"d "+r),r},Ue={top:20,right:20,bottom:60,left:50},He=1e3-Ue.left-Ue.right,We=500-Ue.top-Ue.bottom,Be={All:"#3b35a6",Promoted:"#eebd31",Incident:"#e63041"},Ve=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).initChart=function(){a.svg=_e.n("#report_art").append("g").attr("transform","translate( "+Ue.left+","+Ue.top+" )"),a.xAxisEl=a.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(We," )")),a.yAxisEl=a.svg.append("g").attr("class","y axis"),a.yAxisEl.append("text").attr("transform","rotate(-90)").attr("x",0-We/2).attr("y",0).attr("dy","1em").style("text-anchor","start").style("fill","black").text("Response Time"),a.chartInit=!0},a.updateChart=function(){var e=new Set;a.state.chartData.dates.forEach(function(t){t.values.forEach(function(t){e.add(t.name)})});var t=new Set;a.state.chartData.lines.forEach(function(e){t.add(e.name)});var n=_e.g(a.state.chartData.dates,function(e){return _e.g(e.values,function(e){return e.value})}),r=_e.h().padding(.1).rangeRound([0,He]).domain(a.state.chartData.dates.map(function(e){return e.date})),i=_e.h().domain(Array.from(e)).rangeRound([0,r.bandwidth()]),o=_e.i().clamp(!0).range([We,0]).domain([0,n]).nice(),s=_e.a().scale(r),l=_e.b().scale(o).ticks(20).tickFormat(Re(o.domain(),20));a.xAxisEl.transition().call(s),a.yAxisEl.transition().call(l);var c=a.svg.selectAll(".date").data(a.state.chartData.dates,function(e){return e.date});c.exit().transition().style("opacity",0).attr("height",0).attr("y",We).remove(),c.enter().append("g").attr("class","date").attr("transform",function(e){return"translate( ".concat(r(e.date),", 0 )")}).selectAll(".bar").data(function(e){return e.values}).enter().append("rect").attr("class","bar").style("fill",function(e){return Be[e.name]}).attr("width",i.bandwidth()).attr("x",function(e){return i(e.name)}).attr("y",We).attr("height",0).append("title").text(function(e){return Fe(e.value)}),c.transition().attr("transform",function(e){return"translate( ".concat(r(e.date),", 0 )")}),a.svg.selectAll(".date").selectAll(".bar").transition().attr("width",i.bandwidth()).attr("x",function(e){return i(e.name)}).attr("y",function(e){return o(e.value)}).attr("height",function(e){return We-o(e.value)}),a.svg.select(".avg-holder").remove(),a.svg.select(".avg-holder-border").remove();var d=a.svg.append("g").attr("class","avg-holder"),p=d.selectAll(".avg").data(a.state.chartData.lines).enter().append("text").attr("class","avg").attr("transform",function(e,t){return"translate( 0, ".concat(15*t," )")});p.append("tspan").attr("x",0).attr("font-weight","bold").text(function(e){return"".concat(e.name,":")}),p.append("tspan").attr("x",100).text(function(e){return Fe(e.value)});var u=d.node().getBBox();d.attr("transform","translate( ".concat(He-u.width,", 0 )"));a.svg.append("rect").attr("fill","none").attr("stroke","black").attr("class","avg-holder-border").attr("x",u.x-2).attr("y",u.y-2).attr("width",u.width+4).attr("height",u.height+4).node().transform.baseVal.initialize(d.node().transform.baseVal.getItem(0));a.svg.select(".legend-holder").remove();var h=a.svg.append("g").attr("class","legend-holder"),m=h.selectAll(".legend").data(Array.from(e)).enter().append("g").attr("class","legend");m.append("rect").attr("width",20).attr("x",0).attr("y",0).attr("height",20).style("fill",function(e){return Be[e]}),m.append("text").attr("x",25).attr("y",10).attr("dy",".35em").style("text-anchor","start").text(function(e){return e});var g=0;h.selectAll(".legend").attr("transform",function(e,t){var a=g;return g+=this.getBBox().width+15,"translate( ".concat(a,", 0 )")});var y=h.node().getBBox().width;h.attr("transform","translate( ".concat(He/2-y/2,", ").concat(We+Ue.bottom/2," )"))},a.loadArt=function(){if(a.state.date&&a.state.length&&!a.props.editMode){var e="?days=".concat(a.state.length,"&targetdate=").concat(a.state.date,"&unit=").concat(a.state.unit);Le.a.get("/scot/api/v2/metric/response_avg_last_x_days"+e).then(function(e){a.setState({chartData:e.data})})}},a.unitChange=function(e){a.setState({unit:e.target.value},function(){return a.loadArt()})},a.lengthChange=function(e){a.setState({length:e.target.value},function(){return a.loadArt()})},a.dateChange=function(e){a.setState({date:e.target.value},function(){return a.loadArt()})},a.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_art")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML='<img src="'+e+'"/>',n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o};var n=(new Date).toISOString().slice(0,10);return a.state={length:7,date:n,unit:"day",chartData:{dates:[],lines:[]}},a.loadArt=Pe(a.loadArt),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.initChart(),this.loadArt()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Alert Response Time"),r.a.createElement("label",{htmlFor:"date",style:{display:"inline-block",textAlign:"right"}},"Initial Date =\xa0",r.a.createElement("input",{className:"report_input",type:"date",value:this.state.date,onChange:this.dateChange,placeholder:"yyyy-mm-dd",pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}",disabled:e})),r.a.createElement("label",{htmlFor:"length",style:{display:"inline-block",textAlign:"right"}},"Length =\xa0",r.a.createElement("input",{className:"report_name",type:"number",min:"1",step:"1",value:this.state.length,id:"length",onChange:this.lengthChange,disabled:e})),r.a.createElement("label",{htmlFor:"unit",style:{display:"inline-block",width:"240px",textAlign:"right"}},"Unit =\xa0",r.a.createElement("select",{id:"unit",value:this.state.unit,onChange:this.unitChange,disabled:!0},r.a.createElement("option",{value:"hour"},"hourly"),r.a.createElement("option",{value:"day"},"daily"),r.a.createElement("option",{value:"month"},"monthly"),r.a.createElement("option",{value:"year"},"yearly"))),r.a.createElement(W.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG"),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_art",viewBox:"0 0 1000 500"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),t}(n.PureComponent),ze=a(32),qe=function(e,t){e.each(function(e,a){if(!(this.getComputedTextLength()<t)){for(var n=_e.n(this),r=n.text().split(/\s+/).reverse(),i=null,o=[],s=1,l=n.attr("x"),c=n.attr("y"),d=parseFloat(n.attr("dy")),p=n.text(null).append("tspan").attr("x",l).attr("y",c).attr("dy",d+"em");i=r.pop();)o.push(i),p.text(o.join(" ")),p.node().getComputedTextLength()>t&&(s++,o.pop(),p.text(o.join(" ")),o=[i],p=n.append("tspan").attr("x",l).attr("y",c).attr("dy",.8+d+"em").text(i));var u=this.getBBox().height/(2*s)*(s-1);n.attr("transform","translate( 0, -".concat(u," )"))}})},Ke={top:5,left:200,right:30,bottom:60},Ge=1e3-Ke.left-Ke.right,Je=20,Ye=15,Qe=5,Xe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).initChart=function(){a.height=0,a.xScale=_e.i().rangeRound([0,Ge]),a.yScale=_e.h().rangeRound([0,a.height]).padding(.3),a.colors=_e.j(_e.m),a.xAxis=_e.a().scale(a.xScale),a.yAxis=_e.b().scale(a.yScale),a.svg=_e.n("#report_alertpower").attr("viewBox","0 0 1000 ".concat(a.height+Ke.top+Ke.bottom)).append("g").attr("transform","translate( ".concat(Ke.left,", ").concat(Ke.top," )")),a.yAxisEl=a.svg.append("g").attr("class","y axis"),a.xAxisEl=a.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(a.height," )")),a.xAxisEl.append("text").attr("text-anchor","middle").attr("x",Ge/2).attr("y",30).style("fill","black").style("font-size","12px").text("Alert Count"),a.LegendHolder=a.svg.append("g").attr("class","legend-holder"),a.chartInit=!0},a.updateChart=function(){var e=a.state.chartData;a.height=32*e.length,_e.n("#report_alertpower").transition().attr("viewBox","0 0 1000 ".concat(a.height+Ke.top+Ke.bottom)),a.dataTypes=_e.e(e[0]).filter(function(e){return!["name","values","total","score","max"].includes(e)}),a.colors.domain(a.dataTypes),e.forEach(function(e){e.name=e.name.replace(/ \([0-9]+\)/,""),"number"===typeof e.score&&(e.score=""+e.score);var t=0;e.values=a.dataTypes.map(function(a){var n=t,r=t+e[a];return t+=e[a],{name:a,count:e[a],start:n,end:r}}),e.total=e.values[e.values.length-1].end,e.max=_e.g(a.dataTypes,function(t){return e[t]})}),a.stackedMax=_e.g(e,function(e){return e.total}),a.groupedMax=_e.g(e,function(e){return _e.g(a.dataTypes,function(t){return e[t]})}),a.yScale.rangeRound([0,a.height]).domain(e.map(function(e){return e.name})),a.yAxisEl.call(a.yAxis),a.svg.selectAll(".y.axis .tick text").call(qe,Ke.left-20);var t=a.svg.selectAll(".alert").data(e,function(e){return e.name});t.exit().transition().attr("height",0).style("opacity",0).remove(),t.enter().append("g").attr("class","alert").attr("transform",function(e){return"translate( 1, ".concat(a.yScale(e.name)," )")}).append("text").attr("dy","1.2em"),t.transition().attr("transform",function(e){return"translate( 1, ".concat(a.yScale(e.name)," )")});var n=a.svg.selectAll(".alert").selectAll("rect").data(function(e){return e.values}),r=n.enter().append("rect").attr("x",0).attr("y",0).attr("width",0).attr("height",a.yScale.bandwidth());r.merge(n).style("fill",function(e){return a.colors(e.name)}),r.append("title").merge(n.select("title")).text(function(e){return"".concat(e.name,": ").concat(e.count)});var i=a.LegendHolder.selectAll(".legend").data(a.dataTypes);i.exit().remove(),(i=i.enter().append("g").attr("class","legend")).append("rect").attr("width",Je).attr("x",0).attr("y",0).attr("height",Je).style("fill",function(e){return a.colors(e)}),i.append("text").attr("x",Je+Qe).attr("y",Je/2).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text(function(e){return e});var o=0;a.LegendHolder.selectAll(".legend").attr("transform",function(e,t){var a=o;return o+=this.getBBox().width+Ye,"translate( ".concat(a,", 0 )")});var s=a.LegendHolder.node().getBBox().width;a.LegendHolder.transition().attr("transform","translate( ".concat(Ge/2-s/2,", ").concat(a.height+Ke.bottom-Je," )")),"grouped"===a.state.displayMode?a.transitionGrouped():a.transitionStacked()},a.transitionStacked=function(){a.xScale.domain([0,a.stackedMax]).nice(),a.xAxisEl.transition().call(a.xAxis).attr("transform","translate( 0, ".concat(a.height," )")),a.svg.selectAll(".alert rect").transition().delay(function(e,t){return 5*t}).duration(500).attr("width",function(e){return a.xScale(e.end)-a.xScale(e.start)}).attr("x",function(e){return a.xScale(e.start)}).transition().attr("height",a.yScale.bandwidth()).attr("y",0),a.svg.selectAll(".alert text").transition().delay(function(e,t){return t*a.dataTypes.length*5+t}).duration(500).attr("transform",function(e){return"translate( ".concat(a.xScale(e.total)+10,", 0 )")}).tween("text",function(e){var t=_e.n(this),a=_e.d(t.text(),e.score),n=e.score.split("."),r=n.length>1?Math.pow(10,n[0].length):1;return function(e){return t.text(Math.round(a(e)*r)/r)}})},a.transitionGrouped=function(){a.xScale.domain([0,a.groupedMax]).nice(),a.xAxisEl.transition().call(a.xAxis).attr("transform","translate( 0, ".concat(a.height," )"));var e=a.displayModeChanged?500:0;a.svg.selectAll(".alert").selectAll("rect").transition().delay(function(e,t){return 5*t}).duration(e).attr("height",a.yScale.bandwidth()/a.dataTypes.length).attr("y",function(e,t){return a.yScale.bandwidth()/a.dataTypes.length*t}).transition().duration(500).attr("x",0).attr("width",function(e){return a.xScale(e.end)-a.xScale(e.start)}),a.svg.selectAll(".alert text").transition().delay(function(t,a){return 5*a+e}).attr("transform",function(e){return"translate( ".concat(a.xScale(e.max)+10,", 0 )")}).tween("text",function(e){var t=_e.n(this),a=_e.d(t.text(),e.score),n=e.score.split("."),r=n.length>1?Math.pow(10,n[0].length):1;return function(e){return t.text(Math.round(a(e)*r)/r)}}),a.displayModeChanged=!1},a.loadData=function(){if(a.state.chartResults&&!a.props.editMode){var e="?sort=".concat(a.state.chartSort,"&dir=").concat(a.state.chartSortDir,"&count=").concat(a.state.chartResults,"&filter=").concat(encodeURIComponent(a.state.chartFilter));Le.a.get("/scot/api/v2/metric/alert_power"+e).then(function(e){a.setState({chartData:e.data})})}},a.dataChange=function(e){var t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),a.setState(Object(ze.a)({},t.name,t.value),a.loadData)},a.displayModeChang=function(e){a.displayModeChanged=!0,a.setState({displayMode:e.target.value})},a.preventSubmit=function(e){e.preventDefault(),e.stopPropagation()},a.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_alertpower")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},a.state={displayMode:"stacked",chartData:[],chartResults:20,chartSort:"power",chartSortDir:"desc",chartFilter:""},a.loadData=Pe(a.loadData),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.initChart(),this.updateChart(),this.loadData()}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Alert Power"),r.a.createElement("form",{onSubmit:this.preventSubmit},r.a.createElement("label",null,"Filter =\xa0",r.a.createElement("input",{className:"report_input",type:"text",style:{background:"initial",border:"1px solid #ccc"},name:"chartFilter",value:this.state.chartFilter,onChange:this.dataChange,placeholder:"All",disabled:e}))),r.a.createElement("form",{onSubmit:this.preventSubmit},r.a.createElement("label",null,"Sort by =\xa0",r.a.createElement("select",{name:"chartSort",value:this.state.chartSort,onChange:this.dataChange,disabled:e},r.a.createElement("option",{value:"power"},"Power Score"),r.a.createElement("option",{value:"count"},"Alert Count"),r.a.createElement("option",{value:"promoted"},"Promoted Count"),r.a.createElement("option",{value:"incident"},"Incident Count")),r.a.createElement("select",{name:"chartSortDir",value:this.state.chartSortDir,onChange:this.dataChange,disabled:e},r.a.createElement("option",{value:"desc"},"Desc"),r.a.createElement("option",{value:"asc"},"Asc"))),r.a.createElement("label",null,"Results =\xa0",r.a.createElement("input",{className:"report_input",type:"number",min:1,max:50,name:"chartResults",value:this.state.chartResults,onChange:this.dataChange,disabled:e}))),r.a.createElement("form",null,r.a.createElement("label",null,r.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"grouped",checked:"grouped"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Grouped"),"\xa0",r.a.createElement("label",null,r.a.createElement("input",{className:"report_input",type:"radio",name:"mode",value:"stacked",checked:"stacked"===this.state.displayMode,onChange:this.displayModeChange,disabled:e})," ","Stacked"),r.a.createElement(W.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_alertpower",viewBox:"0 0 1000 100"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),t}(n.PureComponent),$e={top:5,left:40,right:20,bottom:60},Ze=1e3-$e.left-$e.right,et=600-$e.top-$e.bottom,tt=6048e5,at=20,nt=15,rt=5,it=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).initChart=function(){var e=new Date;a.xScale=_e.l().rangeRound([0,Ze]).domain([e-tt,e]),a.yScale=_e.i().rangeRound([et,0]).domain([0,0]),a.xAxis=_e.a().scale(a.xScale),a.yAxis=_e.b().scale(a.yScale),a.svg=_e.n("#report_created").attr("viewBox","0 0 1000 ".concat(et+$e.top+$e.bottom)).append("g").attr("transform","translate( ".concat($e.left,", ").concat($e.top," )")),a.yAxisEl=a.svg.append("g").attr("class","y axis"),a.yAxisEl.call(a.yAxis),a.xAxisEl=a.svg.append("g").attr("class","x axis").attr("transform","translate( 0, ".concat(et," )")),a.xAxisEl.append("text").attr("text-anchor","middle").attr("x",Ze/2).attr("y",$e.bottom-10).style("font-size","10px").style("fill","black").text("Toggle Trendlines"),a.xAxisEl.call(a.xAxis),a.statusLine=_e.f().curve(_e.c).x(function(e){return a.xScale(new Date(1e3*e.time))}).y(function(e){return a.yScale(e.value)}),a.lineHolder=a.svg.append("g").attr("class","lines").attr("clip-path","url(#bounds)"),a.LegendHolder=a.svg.append("g").attr("class","legend-holder").style("font-family","sans-serif"),a.chartInit=!0},a.updateChart=function(){a.yScale.domain([0,Math.max(_e.g(a.state.chartData,function(e){return e.shown&&e.data.length?_e.g(e.data,function(e){return e.value}):0}),10)]).nice(),a.colors=_e.j(_e.m).domain(a.state.chartData.map(function(e){return e.name}));var e=a.lineHolder.selectAll(".line").data(a.state.chartData,function(e){return e.name});e.exit().transition().style("opacity",0).remove(),e.enter().append("path").attr("class",function(e){return"line ".concat(e.name)}).style("stroke",function(e){return a.colors(e.name)}).style("stroke-width",2).style("fill","none").attr("d",function(e){return a.statusLine(e.data)}),a.LegendHolder.selectAll(".legend").remove();var t=a.LegendHolder.selectAll(".legend").data(a.state.chartData,function(e){return e.name});(t=t.enter().append("g").attr("class","legend").style("cursor","pointer").on("click",function(e){var t=a.state.chartData.map(function(t){return t.name===e.name&&(t.shown=!e.shown),t});console.log("newData = ".concat(t)),a.setState({chartData:t})})).append("rect").attr("width",at).attr("x",0).attr("y",(at-5)/2).attr("height",5).style("fill",function(e){return e.shown?a.colors(e.name):"transparent"}).style("stroke",function(e){return a.colors(e.name)}).style("stroke-width",1),t.append("text").attr("x",at+rt).attr("y",at/2).attr("dy",".35em").style("text-anchor","start").style("text-transform","capitalize").text(function(e){return e.name}).append("title").text(function(e){return"Toggle ".concat(e.name," line")});var n=0;a.LegendHolder.selectAll(".legend").attr("transform",function(e,t){var a=n;return n+=this.getBBox().width+nt,"translate( ".concat(a,", 0 )")});var r=a.LegendHolder.node().getBBox().width;a.LegendHolder.attr("transform","translate( ".concat(Ze/2-r/2,", ").concat(et+$e.bottom-2*at," )")),a.yAxisEl.transition().call(a.yAxis),e.transition().attr("d",function(e){return a.statusLine(e.data)}).style("stroke",function(e){return e.shown?a.colors(e.name):"transparent"})},a.loadData=function(){if(a.props.editMode){var e=a.genData();return e=e.map(function(e){return e.shown=a.state.chartData.reduce(function(t,a){return t&&(a.name!==e.name||a.shown)},!0),e}),void a.setState({chartData:e})}Le.a.get("/scot/api/v2/metric/create_histo?range=7").then(function(e){try{console.log(e),e=e.data.map(function(e){return e.shown=a.state.chartData.reduce(function(t,a){return t&&(a.name!==e.name||a.shown)},!0),e}),a.setState({chartData:e})}catch(t){console.log("Malformed data"),console.log(e),console.error(t)}})},a.genData=function(){var e={alerts:5e3,alertgroups:500,entries:100,events:15,intel:5,incidents:5},t=new Date,a=new Date(Date.now()-tt),n=[];for(["alerts","alertgroups","events","incidents","entries","intel"].forEach(function(e){n.push({name:e,data:[]})});a<=t;a=new Date(a.getTime()+216e5))n.forEach(function(t){t.data.push({time:a.getTime()/1e3,value:Math.random()*e[t.name]})});return n},a.exportToPNG=function(){var e=(new XMLSerializer).serializeToString(document.querySelector("#report_created")),t=document.createElement("canvas"),a=t.getContext("2d"),n=window.self.URL||window.self.webkitURL||window.self,r=new Image,i=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=n.createObjectURL(i);r.onload=function(){a.drawImage(r,0,0);var e=t.toDataURL("image/png");document.querySelector("#png-container").innerHTML="<img src='".concat(e,"'/>"),n.revokeObjectURL(e);var i=X()("<a>").attr("href",e).attr("download","img.png").appendTo("body");i[0].click(),i.remove()},r.src=o},a.state={chartData:[]},a.loadData=Pe(a.loadData),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.initChart(),this.loadData()}},{key:"dataChange",value:function(e){var t=e.target;"chartResults"===t.name&&t.value&&(t.value>50&&(t.value=50),t.value<1&&(t.value=1)),this.setState(Object(ze.a)({},t.name,t.value),this.loadData)}},{key:"render",value:function(){this.chartInit&&this.updateChart();var e=this.props.editMode;return r.a.createElement("div",{className:"dashboard"},!this.props.editMode&&r.a.createElement("h1",null,"Items Created"),r.a.createElement("form",null,r.a.createElement(W.a,{id:"export",bsSize:"xsmall",bsStyle:"default",onClick:this.exportToPNG,disabled:e},"Export to PNG")),r.a.createElement("div",{id:"chart"},r.a.createElement("svg",{id:"report_created",viewBox:"0 0 1000 600"})),r.a.createElement("div",{id:"png-container",hidden:!0}))}}]),t}(n.Component),ot=function(e){switch(e){default:case"heatmap":return Ie;case"alertpower":return Xe;case"art":return Ve;case"created":return it}},st=function(e){switch(e){default:case"heatmap":return"Heatmap";case"alertpower":return"Alert Power";case"art":return"Alert Response Time";case"created":return"Items Created"}},lt=function(e){switch(e){default:case"heatmap":return"Heatmap of incoming alerts, event, and incidents";case"alertpower":return"Chart of alerts in terms of how frequently they're promoted or become incidents";case"art":return"Chart of average alert, event, and incident response time";case"created":return"Chart of newly created items"}},ct=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.a.createElement("div",{style:{position:"relative"}},st(e),t&&r.a.createElement(Ae.a,{to:"/reports/".concat(e),className:"panel-button right"},r.a.createElement(W.a,{bsSize:"small"},r.a.createElement("i",{className:"fa fa-external-link","aria-hidden":!0}))),a&&r.a.createElement(Ae.a,{to:"/reports",className:"panel-button left"},r.a.createElement(W.a,{bsSize:"small"},r.a.createElement("i",{className:"fa fa-arrow-left","aria-hidden":!0}))))},dt=function(){return r.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h2",null,"Reports")),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement(B.a,{header:ct("heatmap",!0)},r.a.createElement(Ie,null)),r.a.createElement(B.a,{header:ct("alertpower",!0)},r.a.createElement(Xe,null))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(B.a,{header:ct("art",!0)},r.a.createElement(Ve,null)),r.a.createElement(B.a,{header:ct("created",!0)},r.a.createElement(it,null)))))},pt=function(e){var t=e.reportType,a=void 0===t?"heatmap":t;return r.a.createElement("div",{id:"report",className:"dashboard",style:{height:"calc( 100vh - 51px )",overflow:"auto"}},r.a.createElement("div",{className:"container"},r.a.createElement(B.a,{header:ct(a,!1,!0)},function(e){switch(e){default:case"heatmap":return r.a.createElement(Ie,null);case"alertpower":return r.a.createElement(Xe,null);case"art":return r.a.createElement(Ve,null);case"created":return r.a.createElement(it,null)}}(a))))},ut=a(1115),ht=a(475),mt=a.n(ht),gt=a(45);var yt=Object(gt.withStyles)(function(e){return{progress:{margin:2*e.spacing.unit}}})(function(e){var t=e.classes,a=e.loading;return r.a.createElement("div",{className:"LoadingContainer"},a&&r.a.createElement(mt.a,{className:t.progress}))}),ft=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={data:[],loading:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"fetchData",value:function(){var e=this;this.setState({loading:!0});var t=X.a.extend(!0,{},this.props.queryOptions);t.sort&&(t.sort=JSON.stringify(t.sort)),t.filter&&delete(t=Object(S.a)({},t,t.filter)).filter,this.props.newBadge&&t.columns.push("created"),X.a.ajaxSetup({traditional:!0}),X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.thingType,data:t}).then(function(t){e.setState({data:e.props.processData(t.records),loading:!1})},function(t){e.props.errorToggle("Failed to fetch data: "+t),e.setState({loading:!1})})}},{key:"componentDidMount",value:function(){this.props.editMode||this.fetchData()}},{key:"genThingItem",value:function(e,t){return r.a.createElement(Ae.a,{key:t,to:this.props.getLink(this.props.thingType,e),className:"list-group-item"},this.props.getSummary(e),this.props.newBadge&&(a=e.created,!be(1e3*a,86400))&&r.a.createElement(he.a,{bsStyle:"primary"},"New!"),r.a.createElement("i",{className:"fa fa-angle-right"}));var a}},{key:"render",value:function(){var e=this,t=this.state.data.map(function(t,a){return e.genThingItem(t,a)});return this.props.editMode?t=[1,2,3,4,5].map(function(t){return r.a.createElement("div",{className:"list-group-item"},e.props.thingType," - ",t)}):0===t.length&&(t=r.a.createElement("div",{className:"list-group-item list-group-item-".concat(this.props.emptyStyle)},this.props.emptyString)),r.a.createElement("div",{className:"ThingList"},!this.props.editMode&&r.a.createElement("h1",null,this.props.title),this.state.loading?r.a.createElement(yt,{loading:!0}):r.a.createElement(ut.a,null,t))}}]),t}(n.PureComponent);ft.defaultProps={queryOptions:{limit:5,offset:0,sort:{id:-1},columns:["id","subject"]},processData:function(e){return e},getSummary:function(e){return e.subject},getLink:function(e,t){return"".concat(e,"/").concat(t.id)},emptyString:"No Data",emptyStyle:"warning",newBadge:!0};var bt,vt={intel:{type:ft,title:"Recent Intel",description:"List of the 5 most recent Intel entries",props:{thingType:"intel",title:"Recent Intel"}}},Et={events:{type:ft,title:"Recent Events",description:"List of the 5 most recent events",props:{thingType:"event",title:"Recent Events"}}},kt={incidents:{type:ft,title:"Recent Incidents",description:"List of the 5 most recent Incidents",props:{thingType:"incident",title:"Recent Incidents"}}},wt={tasks:{type:ft,title:"Open Tasks",description:"List of recent open tasks",props:{thingType:"task",title:"Open Tasks",queryOptions:{limit:5,offset:0,sort:{updated:-1},filter:{"metadata.task.status":"open"},columns:["id","body_plain","target"]},getSummary:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},getLink:function(e,t){var a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None",emptyStyle:"info"}}},St={yourTasks:{type:ft,title:"Your Tasks",description:"List of open tasks that you own",props:{thingType:"task",title:"Your Tasks",queryOptions:{limit:5,offset:0,sort:{updated:1},filter:{"metadata.task.status":"open",owner:ce("whoami")},columns:["id","body_plain","target"]},getSummary:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},getLink:function(e,t){var a=t.target;return"".concat(e,"/").concat(a.type,"/").concat(a.id,"/").concat(t.id)},emptyString:"None!",emptyStyle:"success"}}},Tt={unviewedAlerts:{type:ft,title:"Unviewed Alerts",description:"Recent alerts with zero views",props:{thingType:"alertgroup",title:"Unviewed Alerts",queryOptions:{limit:5,offset:0,sort:{id:-1},filter:{created:JSON.stringify(ke(ve())),views:0},columns:["id","subject"]},newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},jt={topEvents:{type:ft,title:"Important Events",description:"Recent Events with open tasks",props:{thingType:"event",title:"Important Events",queryOptions:{limit:5,offset:0,sort:{has_tasks:1},filter:{created:JSON.stringify(ke(ve()))},columns:["id","subject","has_tasks"]},processData:function(e){return e.filter(function(e){return e.has_tasks})},getSummary:function(e){return"".concat(e.subject," (").concat(e.has_tasks," open task").concat(e.has_tasks>1?"s":"",")")},newBadge:!1,emptyString:"None!",emptyStyle:"success"}}},Ot={viewedEvents:{type:ft,title:"Most Viewed Events",description:"Events with the most views over the last week",props:{thingType:"event",title:"Most Viewed Events",queryOptions:{limit:5,offset:0,sort:{views:-1},filter:{created:JSON.stringify(ke(Ee()))},columns:["id","subject","views"]},processData:function(e){return e.filter(function(e){return e.views>0})},getSummary:function(e){return"".concat(e.subject," (").concat(e.views," view").concat(e.views>1?"s":"",")")}}}},xt={entryEvents:{type:ft,title:"Events with Entries",description:"Events with the most entries over the last week",props:{thingType:"event",title:"Events with Entries",queryOptions:{limit:5,offset:0,sort:{entry_count:-1},filter:{created:JSON.stringify(ke(Ee()))},columns:["id","subject","entry_count"]},processData:function(e){return e.filter(function(e){return e.entry_count>0})},getSummary:function(e){return"".concat(e.subject," (").concat(e.entry_count," ").concat(e.entry_count>1?"entries":"entry",")")}}}},Ct=Object(S.a)({},Object(S.a)({},vt,Et,kt,wt,St,Tt,jt,Ot,xt),function(){for(var e={},t=0,a=["heatmap","art","alertpower","created"];t<a.length;t++){var n=a[t];e[n]={type:ot(n),title:st(n),description:lt(n)}}return e}()),Dt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={_isMounted:!1},a.switchTab=a.switchTab.bind(Object(p.a)(Object(p.a)(a))),a.closeTab=a.closeTab.bind(Object(p.a)(Object(p.a)(a))),a.saveTab=a.saveTab.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"defaultTab",value:function(){var e=X.a.extend(!0,{},G);return e.rows[0].columns[0].widgets.push({key:"heatmap"}),e.rows[0].columns[1].widgets.push({key:"art"}),e.rows[0].columns[2].widgets.push({key:"created"}),{title:"Default",layout:r.a.createElement(J,{widgets:Ct,title:"Default",layout:e,errorToggle:this.props.errorToggle})}}},{key:"newTab",value:function(){var e=this.props.userConfig.config,t=Object(T.a)(e.tabs);t.push({}),this.updateDashboardConfig({curTab:t.length,tabs:t})}},{key:"buildTab",value:function(e,t){var a=this,n=r.a.createElement(J,{widgets:Ct,title:e.title,layout:e.layout,saveDashboard:function(e,n){a.saveTab(t,e,n)},isNew:null==e.layout,errorToggle:this.props.errorToggle});return{title:e.title,layout:n}}},{key:"saveTab",value:function(e,t,a){var n=this.props.userConfig.config,r=Object(T.a)(n.tabs),i={title:t,layout:a};r[e]=i,this.updateDashboardConfig({tabs:r})}},{key:"closeTab",value:function(e){if(!(e<1)){var t=this.props.userConfig.config,a=Object(T.a)(t.tabs);a.splice(e-1,1),this.updateDashboardConfig({curTab:e-1,tabs:a})}}},{key:"switchTab",value:function(e){e!==this.props.userConfig.config.curTab&&("new"!==e?this.updateDashboardConfig({curTab:e}):this.newTab())}},{key:"updateDashboardConfig",value:function(e){var t=this.props.userConfig.config;this.props.userConfig.setUserConfig(Object(S.a)({},t,e))}},{key:"render",value:function(){var e=this;if(!this.props.loggedIn||this.props.userConfig.loading)return r.a.createElement("div",{className:"homePageDisplay"},r.a.createElement("div",{className:"home-grid loggedOut"},r.a.createElement("div",{className:"title-area"},r.a.createElement("h1",null,"Sandia Cyber Omni Tracker",r.a.createElement("br",null),"3.5"))));var t=r.a.createElement("div",{className:"home-grid"},r.a.createElement("div",{className:"title-area"}),r.a.createElement(ee,{className:"status-area"}),r.a.createElement("div",{className:"game-area"},r.a.createElement(se,null)),r.a.createElement(Ne,{createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,className:"activity-area"})),a=this.props.userConfig.config,n=a.tabs,i=[];i.push(this.defaultTab());var o=0,s=!0,l=!1,c=void 0;try{for(var d,p=n[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var u=d.value;i.push(this.buildTab(u,o++))}}catch(g){l=!0,c=g}finally{try{s||null==p.return||p.return()}finally{if(l)throw c}}var h=i.map(function(t,n){var i=t.title,o=void 0===i?"New Dashboard":i;t.layout,Object(w.a)(t,["title","layout"]);return r.a.createElement(O.a,{eventKey:n,key:n},o,n===a.curTab&&0!==n&&r.a.createElement("span",{onClick:function(){return e.closeTab(n)}},"\xa0",r.a.createElement("i",{className:"fa fa-times",style:{cursor:"pointer"}})))});h.push(r.a.createElement(O.a,{eventKey:"new",key:"new"},"+"));var m=i.map(function(e,t){e.title;var a=e.layout,n=Object(w.a)(e,["title","layout"]);return r.a.createElement(x.a.Pane,Object.assign({eventKey:t,key:t},n),a)});return r.a.createElement("div",{className:"homePageDisplay"},r.a.createElement(x.a.Container,{id:"DashboardTabs",activeKey:a.curTab,onSelect:this.switchTab},r.a.createElement(C.a,null,r.a.createElement(D.a,{sm:12},r.a.createElement(N.a,{bsStyle:"tabs"},h)),r.a.createElement(D.a,{sm:12},r.a.createElement(x.a.Content,{mountOnEnter:!0,unmountOnExit:!0},t,m)))))}}]),t}(n.PureComponent),Nt=(bt={key:"dashboard",default:{curTab:0,tabs:[]}},_.a.checkPropTypes(I,bt,"argument","withUserConfig"),function(e){var t=function(t){function a(e){var t;return Object(s.a)(this,a),(t=Object(l.a)(this,Object(c.a)(a).call(this,e))).state={},t.setUserSubConfig=t.setUserSubConfig.bind(Object(p.a)(Object(p.a)(t))),t}return Object(d.a)(a,t),Object(j.a)(a,[{key:"setUserSubConfig",value:function(e){var t=Object(S.a)({},this.props.userConfig);t[bt.key]=e,this.context.setUserConfig(t)}},{key:"render",value:function(){var t=this.props,a=t.userConfig,n=Object(w.a)(t,["userConfig"]),i=a[bt.key]||bt.default,o={userConfig:{loading:!0===a.loading,config:i,setUserConfig:this.setUserSubConfig,getUserConfig:this.context.getUserConfig}};return r.a.createElement(e,Object.assign({},n,o))}}]),a}(n.PureComponent);return t.contextTypes=P,t.displayName="withUserConfig(".concat(Object(M.a)(e),")"),function(e){return r.a.createElement(L.b,{channel:"userConfig"},function(a){return r.a.createElement(t,Object.assign({userConfig:a},e))})}})(Dt),At=function(e){var t=_t(e);if(""!==t)return t},_t=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},Mt=function(e){document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"},Lt=function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r},It=a(476),Pt=a.n(It),Rt=a(303),Ft=a.n(Rt),Ut=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){X()(document).keyup(function(e){void 0!==X()("#main-search-results")[0]&&27===e.keyCode&&(this.closeSearch(),e.preventDefault())}.bind(Object(p.a)(Object(p.a)(a))))},a.closeSearch=function(){a.setState({showSearchToolbar:!1,searchString:""})},a.doSearch=function(e){X.a.ajax({type:"get",url:"/scot/api/v2/esearch",data:{qstring:e},success:function(t){e===X()("#main-search")[0].value&&this.setState({results:t.records,showSearchToolbar:!0,searching:!1,searchString:e})}.bind(Object(p.a)(Object(p.a)(a))),error:function(){this.setState({searching:!1})}.bind(Object(p.a)(Object(p.a)(a)))}),a.setState({searching:!0})},a.handleEnterKey=function(e){"Enter"===e.key&&a.doSearch(e.target.value)},a.onChange=function(e){a.doSearch(e.target.value)},a.componentDidUpdate=function(){a.state.searchString},a.render=function(){var e=[];if(void 0!==a.state.results)if(void 0!==a.state.results[0])for(var t=0;t<a.state.results.length;t++)e.push(r.a.createElement(Wt,{dataOne:a.state.results[t],key:t,index:t,searchString:a.state.searchString}));else e.push(r.a.createElement("div",{style:{display:"inline-flex"}},r.a.createElement("div",{style:{display:"flex"}},"No results returned")));return r.a.createElement("div",{className:"esearch",style:{zIndex:"100"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("input",{id:"main-search",className:"esearch-query",style:{marginTop:"3px",padding:"10px 10px",float:"right",position:"relative",color:"black"},placeholder:"\uf002 Search",charSet:"utf-8",onKeyPress:a.handleEnterKey,onChange:a.onChange}),a.state.searching?r.a.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw",style:{color:"white"}}):null),a.state.showSearchToolbar?r.a.createElement("div",{id:"main-search-results",style:{display:"flex",flexFlow:"row",position:"absolute",right:"10px",top:"53px",background:"#f3f3f3",border:"black",borderStyle:"solid"}},r.a.createElement("div",null,r.a.createElement(Ht,{closeSearch:a.closeSearch}),r.a.createElement("div",{style:{overflowY:"auto",maxHeight:"600px",display:"table-caption"}},e))):null)},a.componentWillUnmount=function(){X()(document).off("keypress")},a.state={showSearchToolbar:!1,searchResults:null,entityHeight:"60vh",searching:!1,searchString:""},a}return Object(d.a)(t,e),t}(r.a.Component),Ht=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){return r.a.createElement("div",{className:"table-row header",style:{color:"black",display:"flex"}},r.a.createElement("div",{style:{flexGrow:1,display:"flex"}},r.a.createElement("div",{style:{width:"100%",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},"Search Results - Score Displayed",r.a.createElement("i",{className:"fa fa-times pull-right",style:{color:"red",margin:"2px",cursor:"pointer"},onClick:a.props.closeSearch}))))},a}return Object(d.a)(t,e),t}(r.a.Component),Wt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=a.props.dataOne.type,t=a.props.dataOne.id,n=a.props.dataOne.entryid,i=a.props.dataOne.score,o=[],s="even";a.props.index%2!==0&&(s="odd");var l="search_result_row list-view-row"+s,c="/"+e+"/"+t;if(void 0!==n&&(c="/"+e+"/"+t+"/"+n),void 0!==a.props.dataOne.highlight)if("string"===typeof a.props.dataOne.highlight)o.push(r.a.createElement("span",{className:"search_snippet_container panel col"},r.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),r.a.createElement("span",{className:"search_snippet_result"},a.props.dataOne.highlight)));else if(X.a.isArray(a.props.dataOne.highlight))o.push(r.a.createElement("span",{className:"search_snippet_container panel col"},r.a.createElement("span",{className:"search_snippet_header"},"Snippet:"),r.a.createElement("span",{className:"search_snippet_result"},a.props.dataOne.highlight[0])));else for(var d in a.props.dataOne.highlight){var p,u=a.props.searchString.split(" ");o.push(r.a.createElement(Pt.a,(p={activeClassName:Ft.a.Active,highlightClassName:"search_snippet_result",className:"search_snippet_result",searchWords:u,autoEscape:!0,textToHighlight:a.props.dataOne.highlight[d][0]},Object(ze.a)(p,"highlightClassName",Ft.a.Highlight),Object(ze.a)(p,"highlightStyle",{backgroundColor:"yellow"}),p)))}return r.a.createElement("div",{key:Date.now(),className:l},r.a.createElement(Ae.a,{to:c,style:{display:"flex"}},r.a.createElement("span",{className:"panel panel-default",style:{display:"flex",flexFlow:"column",borderColor:"black",borderWidth:"thin",margin:"0px"}},r.a.createElement("div",{className:"panel-heading h4 search-heading"},e," ",t," - ",i),r.a.createElement("div",{className:"search-snippet",style:{display:"flex",overflowX:"hidden",wordWrap:"break-word"}},r.a.createElement("span",{className:"container-fluid",style:{textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",width:"600px"}},o)))))},a}return Object(d.a)(t,e),t}(r.a.Component);var Bt=a(13),Vt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).sendWallMessage=function(){if(""===a.state.wallMessage)alert("Please enter text"),a.setState({buttonStatus:"warning"});else{a.setState({buttonText:"Loading",buttonLoading:!0});var e={msg:a.state.wallMessage};X.a.ajax({type:"post",url:"scot/api/v2/wall",data:e,traditional:!0,success:function(){this.setState({buttonStatus:"success",buttonText:"Sent",buttonLoading:!1})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.setState({buttonStatus:"danger",buttonText:"Failed - Try Again?",buttonLoading:!1}),this.props.errorToggle("Failed to send message",e)}.bind(Object(p.a)(Object(p.a)(a)))})}},a.inputChange=function(e){a.setState({wallMessage:e.target.value})},a.render=function(){return r.a.createElement("div",{className:"allComponents",style:{"margin-left":"17px"}},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"main-header-info-child"},r.a.createElement("h2",{htmlFor:"message"},"Message to all SCOT users:"),r.a.createElement("input",{id:"message",style:{width:"700px"},placeholder:"Enter message to be displayed to everyone using SCOT",value:a.state.wallMessage,onChange:a.inputChange}),r.a.createElement(Bt,{onClick:a.sendWallMessage,bsStyle:a.state.buttonStatus,disabled:a.state.buttonLoading},a.state.buttonText)))))},a.state={wallMessage:"",buttonStatus:"primary",buttonText:"Send",buttonLoading:!1},a}return Object(d.a)(t,e),t}(r.a.Component),zt=a(477),qt=a.n(zt),Kt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={user:"",pass:""},a.SSO=a.SSO.bind(Object(p.a)(Object(p.a)(a))),a.NormalAuth=a.NormalAuth.bind(Object(p.a)(Object(p.a)(a))),a.isEnterPressed=a.isEnterPressed.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e="/sso?orig_url=/#"+this.props.origurl;return r.a.createElement(q.a,{dialogClassName:"login-modal",show:this.props.modalActive},r.a.createElement(q.a.Header,null,r.a.createElement(q.a.Title,{style:{textAlign:"center"}},"SCOT Login")),r.a.createElement(q.a.Body,{style:{textAlign:"center"}},r.a.createElement("img",{src:qt.a,alt:"SCOT Logo"}),r.a.createElement(W.a,{type:"submit",href:e},"Sign in using SSO"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("i",{className:"fa fa-user"})),r.a.createElement("input",{id:"user",type:"user",ref:"user",defaultValue:"",className:"form-control",placeholder:"Username or Email"})),r.a.createElement("div",{className:"input-group",style:{marginBottom:"25px",marginRight:"100px",marginLeft:"100px"}},r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("i",{className:"fa fa-lock"})),r.a.createElement("input",{id:"pass",type:"password",ref:"pass",defaultValue:"",placeholder:"Password",className:"form-control",onKeyPress:this.isEnterPressed})),r.a.createElement(W.a,{type:"submit",className:"btn btn-primary",onClick:this.NormalAuth,style:{marginBottom:"25px",width:"140px"}},"Submit"),r.a.createElement("br",null)))}},{key:"isEnterPressed",value:function(e){"Enter"===e.key&&this.NormalAuth()}},{key:"SSO",value:function(){var e={orig_url:"%2f"};X.a.ajax({type:"get",url:"sso",crossDomain:!0,data:e,success:function(e){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){this.props.errorToggle("Failed to log in using SSO")}.bind(this)})}},{key:"NormalAuth",value:function(){var e={};e.user=this.refs.user.value,e.pass=this.refs.pass.value,e.csrf_token=this.props.csrf,X.a.ajax({type:"post",url:"auth",data:e,success:function(){console.log("success logging in"),this.props.WhoAmIQuery(),this.props.GetHandler(),this.props.loginToggle(null,!0)}.bind(this),error:function(e){"Failed CSRF check"===e.responseText?this.props.errorToggle("Failed to log in due to bad CSRF token. Please reload the page and then log in. Error: "+e.responseText):this.props.errorToggle("Failed to log in using normal auth: "+e.responseText)}.bind(this)})}}]),t}(n.Component);Kt.defaultProps={modalActive:!0};var Gt=Kt,Jt=a(74),Yt=a(58),Qt=a(230),Xt=a(1116),$t=a(1104),Zt=a(1105),ea=a(478),ta=a.n(ea),aa=a(304),na=a.n(aa),ra=a(479),ia=a.n(ra),oa=function(e){function t(e){var a;Object(s.a)(this,t);var n=[];(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).props.value&&(n=a.props.value);var r=void 0;return a.props.maxTags&&(r=a.props.maxTags),a.state={suggestions:[],tags:n,maxTags:r,placeholder:""},a.handleDelete=a.handleDelete.bind(Object(p.a)(Object(p.a)(a))),a.handleAdd=a.handleAdd.bind(Object(p.a)(Object(p.a)(a))),a.handleInputChange=a.handleInputChange.bind(Object(p.a)(Object(p.a)(a))),a.showHideInput=a.showHideInput.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"handleDelete",value:function(e){var t=this.state.tags;if(t.splice(e,1),0===t.length)return this.props.onChange(""),void this.setState({tags:t,placeholder:""});this.props.onChange(t),this.setState({tags:t,placeholder:""})}},{key:"handleAdd",value:function(e){var t=this.state.tags;this.state.maxTags&&t.length>=this.state.maxTags?this.setState({placeholder:"Only "+this.state.maxTags+" allowed. Please delete a tag to add another one"}):(t.push(e),this.props.onChange(t),this.setState({tags:t,placeholder:""}))}},{key:"componentDidUpdate",value:function(){this.showHideInput()}},{key:"handleInputChange",value:function(e){if(e&&e.length>=2){var t=[];X.a.ajax({type:"get",url:"/scot/api/v2/ac/"+this.props.type+"/"+e,success:function(e){e=e.records;for(var a=0;a<e.length;a++){var n={};n.id=a+1,n.name=e[a],t.push(n)}this.setState({suggestions:t})}.bind(this),error:function(e){console.log("failed to get autocomplete data")}})}}},{key:"showHideInput",value:function(){"userdef"===this.props.type&&this.props.maxTags&&this.state.tags.length>=this.props.maxTags?X()(".react-tags__search").hide():X()(".react-tags__search").show()}},{key:"render",value:function(){return r.a.createElement("div",{className:"TagInput"},r.a.createElement(ia.a,{tags:this.state.tags,suggestions:this.state.suggestions,handleAddition:this.handleAdd,handleDelete:this.handleDelete,handleInputChange:this.handleInputChange,autoresize:!1,autofocus:!1,allowBackspace:!1,allowNew:!0,placeholder:this.state.placeholder,tagComponent:sa}))}}]),t}(n.Component),sa=function(e){var t=e.classNames,a=e.onDelete,n=e.tag;return r.a.createElement("div",{className:t.selectedTag},r.a.createElement("span",{className:t.selectedTagName},n.name),r.a.createElement("i",{className:"fa fa-remove","aria-hidden":"true",onClick:a}))},la=oa,ca=a(42),da=a.n(ca),pa=a(82),ua=a.n(pa),ha=a(174);function ma(e,t){return ga.apply(this,arguments)}function ga(){return(ga=Object(ha.a)(ua.a.mark(function e(t,a){return ua.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==a){e.next=6;break}return e.next=3,Le.a.get(t);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,Le.a.get(t,{params:a});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ya(){return(ya=Object(ha.a)(ua.a.mark(function e(t,a){return ua.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a){e.next=6;break}return e.next=3,Le.a.post(t,a);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,Le.a.post(t);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fa(e,t){return ba.apply(this,arguments)}function ba(){return(ba=Object(ha.a)(ua.a.mark(function e(t,a){return ua.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.a.put(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function va(){return(va=Object(ha.a)(ua.a.mark(function e(t){return ua.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.a.delete(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ea=a(168),ka=a.n(Ea),wa=a(480),Sa=a.n(wa),Ta={numberFilter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(na.a,{debounceTimeout:200,type:"number",minLength:1,min:0,value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%"}})},stringFilter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(na.a,{debounceTimeout:200,minLength:1,value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%"}})},dropdownFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["open","closed","promoted"],t=arguments.length>1?arguments[1]:void 0;return function(a){var n=a.filter,i=a.onChange;return r.a.createElement(Xt.a,{trigger:"focus",placement:"bottom",overlay:r.a.createElement($t.a,{id:"status_popover",style:{maxWidth:"400px"}},r.a.createElement(Zt.a,{vertical:!0,style:{maxHeight:"50vh",overflowY:"auto",position:"relative"}},e.map(function(e){return r.a.createElement(W.a,{key:e,onClick:function(){return i(e)},active:n&&n.value===e,style:{textTransform:"capitalize",textAlign:t||null}},e)})),n&&r.a.createElement(W.a,{block:!0,onClick:function(){return i("")},bsStyle:"primary",style:{marginTop:"3px"}},"Clear"))},r.a.createElement("input",{type:"text",value:n?n.value:"",readOnly:!0,style:{width:"100%",cursor:"pointer"}}))}},dateRange:function(e){var t,a=e.filter,n=e.onChange;return r.a.createElement(Xt.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:r.a.createElement($t.a,{id:"daterange_popover",style:{maxWidth:"350px"}},r.a.createElement(ta.a,{numberOfCalendars:2,selectionType:"range",showLegend:!1,singleDateRange:!0,onSelect:function(e,t){n(function(e){return{start:Math.round(e.start)/1e3,end:Math.round(e.end)/1e3}}(e))},value:a?(t=a.value,fe.range(1e3*t.start,1e3*t.end)):null}),a&&r.a.createElement(W.a,{block:!0,onClick:function(){n(""),document.dispatchEvent(new MouseEvent("click"))},bsStyle:"primary"},"Clear"))},r.a.createElement("input",{type:"text",value:a?we(a.value):"",readOnly:!0,style:{width:"100%",cursor:"pointer"}}))},tagFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tag";return function(t){var a=t.filter,n=t.onChange;return r.a.createElement(la,{type:e,onChange:n,value:a?a.value:[]})}}},ja={dateFormater:function(e){var t=new Date(1e3*e.value);return r.a.createElement("span",null,t.toLocaleString())},alertStatus:function(e){var t=e.value.split("/").map(function(e){return parseInt(e.trim(),10)}),a=Object(Qt.a)(t,3),n=a[0],i=a[1],o="open btn-danger";return a[2]?o="promoted btn-warning":i&&(n||(o="closed btn-success")),r.a.createElement("div",{className:"alertStatusCell ".concat(o)},e.value)},textStatus:function(e){var t="green";return"open"===e.value||"disabled"===e.value||"assigned"===e.value?t="red":"promoted"===e.value&&(t="orange"),r.a.createElement("span",{style:{color:t}},e.value)},alertStatusAlerts:function(e){return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(_a,{row:e}))},flairCell:function(e){return void 0!==e?r.a.createElement(Na,{value:e.value}):null}},Oa={Id:{Header:"ID",accessor:"id",width:80,Filter:Ta.numberFilter},AlertStatus:{Header:"Status",accessor:function(e){return e.open_count+" / "+e.closed_count+" / "+e.promoted_count},column:["open_count","closed_count","promoted_count"],id:"status",width:150,Filter:Ta.dropdownFilter(),Cell:ja.alertStatus,style:{padding:0}},EventStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:ja.textStatus,Filter:Ta.dropdownFilter()},IncidentStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:ja.textStatus,Filter:Ta.dropdownFilter(["open","closed"])},SigStatus:{Header:"Status",accessor:"status",maxWidth:100,Cell:ja.textStatus,Filter:Ta.dropdownFilter(["enabled","disabled"])},TaskStatus:{Header:"Task Status",accessor:function(e){return e.metadata.task.status},id:"metadata.task.status",column:"metadata",Cell:ja.textStatus,Filter:Ta.dropdownFilter(["open","assigned","closed"])},TaskSummary:{Header:"Task Summary",accessor:function(e){return e.body_plain.length>200?e.body_plain.substr(0,200)+"...":e.body_plain},id:"summary",minWidth:400,maxWidth:5e3,Filter:Ta.stringFilter},Subject:{Header:"Subject",accessor:"subject",minWidth:400,maxWidth:5e3,Filter:Ta.stringFilter},Location:{Header:"Location",accessor:"location",minWidth:80,maxWidth:180,Filter:Ta.stringFilter},Created:{Header:"Created",accessor:"created",minWidth:100,maxWidth:180,Filter:Ta.dateRange,Cell:ja.dateFormater},Updated:{Header:"Updated",accessor:"updated",minWidth:100,maxWidth:180,Filter:Ta.dateRange,Cell:ja.dateFormater},Occurred:{Header:"When",accessor:"when",minWidth:100,maxWidth:180,Filter:Ta.dateRange,Cell:ja.dateFormater},Sources:{Header:"Sources",accessor:"source",column:"source",id:"source",minWidth:120,Filter:Ta.tagFilter("source")},Tags:{Header:"Tags",accessor:"tag",column:"tag",id:"tag",minWidth:120,Filter:Ta.tagFilter("tag")},TaskOwner:{Header:"Task Owner",accessor:"owner",maxWidth:80,Filter:Ta.stringFilter},Owner:{Header:"Owner",accessor:"owner",maxWidth:80,Filter:Ta.stringFilter},Entries:{Header:"Entries",accessor:"entry_count",maxWidth:70,Filter:Ta.numberFilter},Views:{Header:"Views",accessor:"views",maxWidth:70,Filter:Ta.numberFilter},DOE:{Header:"DOE",accessor:"doe_report_id",maxWidth:100,Filter:Ta.stringFilter},IncidentType:{Header:"Type",accessor:"type",minWidth:200,maxWidth:250,Filter:Ta.dropdownFilter(["Type 1 : Root Compromise","Type 1 : User Compromise","Type 1 : Loss/Theft/Missing Desktop","Type 1 : Loss/Theft/Missing Laptop","Type 1 : Loss/Theft/Missing Media","Type 1 : Loss/Theft/Missing Other","Type 1 : Malicious Code Trojan","Type 1 : Malicious Code Virus","Type 1 : Malicious Code Worm","Type 1 : Malicious Code Other","Type 1 : Web Site Defacement","Type 1 : Denial of Service","Type 1 : Critical Infrastructure Protection","Type 1 : Unauthorized Use","Type 1 : Information Compromise","Type 2 : Attempted Intrusion","Type 2 : Reconnaissance Activity"],"left")},AppliesTo:{Header:"Applies To",accessor:"applies_to",Filter:Ta.tagFilter,minWidth:400,maxWidth:5e3},Value:{Header:"Value",accessor:"value",Filter:Ta.stringFilter,minWidth:400,maxWidth:5e3},Name:{Header:"Name",accessor:"name",Filter:Ta.stringFilter,minWidth:200,maxWidth:300},Group:{Header:"Group",accessor:function(e){return e.data.signature_group?e.data.signature_group.join(", "):""},column:"signature_group",id:"data.signature_group",Filter:Ta.stringFilter},Type:{Header:"Type",accessor:function(e){return e.data.type},id:"data.type",Filter:Ta.stringFilter,minWidth:100,maxWidth:150},EntityType:{Header:"Type",accessor:"type",Filter:Ta.stringFilter,minWidth:100,maxWidth:150},Description:{Header:"Description",accessor:function(e){return e.data.description},Filter:Ta.stringFilter,minWidth:400,id:"data.description",maxWidth:5e3},TargetType:{Header:"Type",accessor:function(e){return e.target.type},column:"target",id:"target_type",Filter:Ta.stringFilter},TargetId:{Header:"Target Id",accessor:function(e){return e.target.id},column:"target",id:"target_id",Filter:Ta.numberFilter},OpenTasks:{Header:"Open Tasks",accessor:"has_tasks",Filter:Ta.numberFilter,maxWidth:90,filterable:!1},Status:{accessor:"status",Header:"Status",width:100,Cell:ja.alertStatusAlerts},EntryCountColumn:{width:50,resizable:!0,expander:!0,filter:!1,accessor:"entry_count",Header:"Entries",Expander:function(e){var t=e.isExpanded,a=Object(w.a)(e,["isExpanded"]);return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},t?r.a.createElement(da.a,{variant:"contained",style:{backgroundColor:"orange",color:"white"}},"Close entries"):r.a.createElement("div",null,0==a.original.entry_count?r.a.createElement(ka.a,null):r.a.createElement(da.a,{variant:"contained",size:"small",style:{backgroundColor:"#5bc0de",color:"white"}},a.original.entry_count," entries")))},getProps:function(e,t,a){return{className:"show-pointer"}}}},xa={style:{padding:"5px 5px"}},Ca={alert:["Id","Status","EntryCountColumn"],alertgroup:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views","OpenTasks"],event:["Id","Location","EventStatus","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","OpenTasks"],incident:["Id","Location","DOE","IncidentStatus","Owner","Subject","Occurred","IncidentType",{title:"Tags",options:{minWidth:100,maxWidth:150}},{title:"Sources",options:{minWidth:100,maxWidth:150}}],intel:["Id","Location","Subject","Created","Updated","Sources",{title:"Tags",options:{minWidth:200,maxWidth:250}},"Owner","Entries","Views"],task:["Id","Location","Subject","TargetType","TargetId",{title:"TaskOwner",options:{minWidth:150,maxWidth:500}},"TaskStatus","TaskSummary",{title:"Updated",options:{minWidth:150,maxWidth:500}}],signature:["Id","Location","Name","Type","SigStatus","Group","Description","Owner","Tags","Sources","Updated"],guide:["Id","Location","Subject","AppliesTo"],entity:["Id","Location","Value","EntityType","Entries"],default:["Id","Location","AlertStatus","Subject","Created","Sources","Tags","Views"]},Da=function(e,t,a,n){function r(e){return e.reduce(function(e,t){return void 0!==e.width?e.width+t.width:e+t.width})}Ca.hasOwnProperty(e)||(e="default"),!1===n&&"alert"===e&&(e="alertgroup");var i=[],o=!0,s=!1,l=void 0;try{for(var c,d=Ca[e][Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var p=c.value,u={};"object"===typeof p?u=Object(S.a)({},Oa[p.title],p.options):"string"===typeof p&&(u=Oa[p]),i.push(Object(S.a)({},xa,u))}}catch(b){s=!0,l=b}finally{try{o||null==d.return||d.return()}finally{if(s)throw l}}if("alert"===e){a.length>0&&(a[0].data.columns&&a[0].data.columns.forEach(function(e,a){if("status"!==e){var n={accessor:e,Header:e,filter:!0,Cell:function(e){return ja.flairCell(e)},width:Aa(t,e,e)};i.push(n)}}.bind(void 0)),i.forEach(function(e,t){e.getProps=function(e,a){return{style:{backgroundColor:t%2===0?"#bababa45":""}}}}));var h=3;i.forEach(function(e){90===e.width&&h++,e.accessor.includes("time")&&h++});var m=window.innerWidth-32,g=r(i);if(g<m){var y=m-g,f=y/(i.length-h);i.forEach(function(e){(g=r(i))<m&&"id"!==e.accessor&&"entry_count"!==e.accessor&&"status"!==e.accessor&&90!==e.width&&!0!==e.accessor.includes("time")&&(e.width+f<y?(e.width=e.width+f,g=r(i)):e.width=e.width+y)}.bind(void 0))}}return i},Na=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.value;return r.a.createElement("div",{style:{wordBreak:"break-word"},className:"alertTableHorizontal",dangerouslySetInnerHTML:{__html:e}})}}]),t}(r.a.Component),Aa=function(e,t,a){("string"===typeof t||t instanceof String)&&(t=function(e){return e[t]});var n=Math.max.apply(Math,Object(T.a)(e.map(function(e){return function(e){try{return Sa()(e).length}catch(t){return e.length}}(e[a])})).concat([a.length]));return n<13&&"status"!==a?90:Math.min(400,9*n)},_a=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getPromotionInfo=function(e){return ma("/scot/api/v2/alert/".concat(e,"/event"),{})},a.state={element:null,loading:!0},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;e.row.value!==this.props.row.value&&this.getPromotionInfo(this.props.row.original.id).then(function(e){e&&t.setState({element:e})})}},{key:"componentDidMount",value:function(){var e=this;this.getPromotionInfo(this.props.row.original.id).then(function(t){t&&e.setState({element:t})})}},{key:"render",value:function(){var e=this;return"closed"===this.props.row.value?r.a.createElement("p",{style:{color:"green"}},this.props.row.value):"open"===this.props.row.value?r.a.createElement("p",{style:{color:"red"}},this.props.row.value):"promoted"===this.props.row.value?this.state.element?r.a.createElement(da.a,{variant:"contained",onMouseDown:function(){return t=e.state.element.data.records[0].id,void window.open("#/event/"+t);var t},style:{backgroundColor:"orange",color:"white"}},this.props.row.value):r.a.createElement("span",null,"Loading..."):void 0}}]),t}(r.a.Component),Ma={columnsDisplay:{alertgroup:["ID","Status","Subject","Created","Sources","Tags","Views","Open Tasks"],alert:["ID","Status","Subject","Created","Sources","Tags","Views"],event:["ID","Status","Subject","Created","Updated","Sources","Tags","Owner","Entries","Views","Open Tasks"],incident:["ID","DOE","Status","Owner","Subject","Occurred","Type","Tags","Sources"],task:["Entry Id","Body","Type","ID","Status","Owner","Updated"],guide:["ID","Subject","Applies To"],intel:["ID","Subject","Created","Updated","Source","Tags","Owner","Entries","Views"],signature:["ID","Name","Type","Status","Group","Description","Owner","Tag","Source","Updated"],entity:["ID","Value","Type","Entries"]},columns:{alertgroup:["id","status","subject","created","source","tag","views","has_tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has_tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target.type","target.id","metadata.status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]},columnsClassName:{alertgroup:["id","status","subject","created","source","tag","views","has-tasks"],alert:["id","status","subject","created","source","tag","views"],event:["id","status","subject","created","updated","source","tag","owner","entry_count","views","has-tasks"],incident:["id","doe_report_id","status","owner","subject","occurred","type","tag","source"],task:["id","body_plain","target_type","target_id","task_status","owner","updated"],guide:["id","subject","applies_to"],intel:["id","subject","created","updated","source","tag","owner","entry_count","views"],signature:["id","name","type","status","signature_group","description","owner","tag","source","updated"],entity:["id","value","type","entry_count"]}},La=a(692),Ia=a(252),Pa=a(35),Ra=a(99),Fa=a(384),Ua=a(56).Link,Ha=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){"alertgroup"===a.props.type&&X()("#list-view").keydown(function(e){X()("input").is(":focus")||"promoted"!==this.props.status&&(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey?this.statusAjax("open"):67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.statusAjax("closed"))}.bind(Object(p.a)(Object(p.a)(a))))},a.componentWillUnmount=function(){X()("#list-view").unbind("keydown")},a.trackAll=function(){a.statusAjax("tracked")},a.untrackAll=function(){a.statusAjax("untracked")},a.closeAll=function(){a.statusAjax("closed")},a.openAll=function(){a.statusAjax("open")},a.enableAll=function(){a.statusAjax("enabled")},a.disableAll=function(){a.statusAjax("disabled")},a.statusAjax=function(e){console.log(e);var t={status:e};X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success status change to: "+e)},error:function(e){this.props.errorToggle("Failed to change status",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){var e,t="",n="",i="";return"open"===a.props.status||"disabled"===a.props.status||"untracked"===a.props.status?(t="danger",i="alertgroup_open"):"closed"===a.props.status||"enabled"===a.props.status||"tracked"===a.props.status?(t="success",i="alertgroup_closed"):"promoted"===a.props.status&&(t="default",i="alertgroup_promoted"),"alertgroup"===a.props.type&&(n=a.props.data.open_count+" / "+a.props.data.closed_count+" / "+a.props.data.promoted_count),"event"===a.props.type?e="/incident/"+a.props.data.promotion_id:"intel"===a.props.type&&(e="/event/"+a.props.data.promotion_id),"guide"===a.props.type||"intel"===a.props.type?r.a.createElement("div",null):"alertgroup"===a.props.type?r.a.createElement(La,null,r.a.createElement(Ia,{placement:"top",overlay:r.a.createElement(Fa,{id:a.props.id},"open/closed/promoted alerts")},r.a.createElement(Ra,{bsSize:"xsmall",bsStyle:t,title:n,id:"dropdown",className:i},r.a.createElement(Pa,{eventKey:"1",onClick:a.openAll,bsSize:"xsmall"},r.a.createElement("b",null,"Open")," All Alerts"),r.a.createElement(Pa,{eventKey:"2",onClick:a.closeAll},r.a.createElement("b",null,"Close")," All Alerts")))):"incident"===a.props.type?r.a.createElement(Ra,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:i,style:{fontSize:"14px"},title:a.props.status},r.a.createElement(Pa,{eventKey:"1",onClick:a.openAll},"Open Incident"),r.a.createElement(Pa,{eventKey:"2",onClick:a.closeAll},"Close Incident")):"signature"===a.props.type?r.a.createElement(Ra,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:i,style:{fontSize:"14px"},title:a.props.status},r.a.createElement(Pa,{eventKey:"1",onClick:a.enableAll},"Enable Signature"),r.a.createElement(Pa,{eventKey:"2",onClick:a.disableAll},"Disable Signature")):"entity"===a.props.type?r.a.createElement(Ra,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:i,style:{fontSize:"14px"},title:a.props.status},r.a.createElement(Pa,{eventKey:"1",onClick:a.trackAll},"Track"),r.a.createElement(Pa,{eventKey:"2",onClick:a.untrackAll},"Untracked")):r.a.createElement("div",null,"promoted"===a.props.status?r.a.createElement(Ua,{to:e,role:"button",className:"btn btn-warning"},a.props.status):r.a.createElement(Ra,{bsSize:"xsmall",bsStyle:t,id:"event_status",className:i,style:{fontSize:"14px"},title:a.props.status},r.a.createElement(Pa,{eventKey:"1",onClick:a.openAll},"Open"),r.a.createElement(Pa,{eventKey:"2",onClick:a.closeAll},"Close")))},a}return Object(d.a)(t,e),t}(r.a.Component),Wa=a(80),Ba=a.n(Wa),Va=a(166),za=a.n(Va),qa=a(13),Ka=a.n(qa),Ga=a(13),Ja=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){"alert"===a.props.type?(a.setState({newType:"Event"}),a.setState({newURL:"event"})):"event"===a.props.type&&(a.setState({newType:"Incident"}),a.setState({newURL:"incident"}))},a.promote=function(){var e=JSON.stringify({promote:"new"});X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:e,contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully promoted"),window.location.assign("#/"+this.state.newURL+"/"+e.pid)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("error","Failed to promote",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){return r.a.createElement(Ga,{bsStyle:"warning",eventkey:"1",bsSize:"xsmall",onClick:a.promote},r.a.createElement("img",{src:"/images/megaphone.png",alt:""}),r.a.createElement("span",null,"Promote to ",a.state.newType))},a.state={newURL:null,newType:null},a}return Object(d.a)(t,e),t}(r.a.Component),Ya=a(1106),Qa=a(1107),Xa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={isMarked:!1},a.removeMarkedItemsHandler=a.removeMarkedItemsHandler.bind(Object(p.a)(Object(p.a)(a))),a.getMarkedItemsHandler=a.getMarkedItemsHandler.bind(Object(p.a)(Object(p.a)(a))),a.setMarkedItemsHandler=a.setMarkedItemsHandler.bind(Object(p.a)(Object(p.a)(a))),a.getSelectedAlerts=a.getSelectedAlerts.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.getMarkedItemsHandler()}},{key:"componentWillReceiveProps",value:function(e){this.getMarkedItemsHandler(),e.isAlert&&this.setState({isMarked:!1})}},{key:"render",value:function(){return"entry"===this.props.type?r.a.createElement(Ya.a,{onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},r.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.state.isMarked?r.a.createElement("span",null,"Marked"):r.a.createElement("span",null,"Mark")):r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:"mark_tooltip"},"Mark selected"," ",this.props.isAlert?r.a.createElement("span",null,"alerts"):this.props.type)},r.a.createElement(W.a,{bsSize:"xsmall",onClick:this.state.isMarked?this.removeMarkedItemsHandler:this.setMarkedItemsHandler},r.a.createElement("i",{style:{color:"".concat(this.state.isMarked?"green":""," ")},className:"fa fa".concat(this.state.isMarked?"-check":"","-square-o"),"aria-hidden":"true"}),this.props.isAlert?r.a.createElement("span",null,"Mark selected"):null))}},{key:"getMarkedItemsHandler",value:function(){var e=Za(),t=!1;if(e){var a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var s=i.value;if(s.id===this.props.id&&s.type===this.props.type){t=!0;break}}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}}this.setState({isMarked:t})}},{key:"removeMarkedItemsHandler",value:function(){if(this.props.isAlert)for(var e=this.getSelectedAlerts(),t=0;t<e.length;t++)$a("alert",e[t]);else $a(this.props.type,this.props.id);this.setState({isMarked:!1})}},{key:"setMarkedItemsHandler",value:function(){if(this.props.isAlert)for(var e=this.getSelectedAlerts(),t=0;t<e.length;t++)en("alert",e[t],this.props.string);else en(this.props.type,this.props.id,this.props.string);this.setState({isMarked:!0})}},{key:"getSelectedAlerts",value:function(){return this.props.alertsSelected.map(function(e){return e.id})}}]),t}(r.a.Component),$a=function(e,t){var a=Za();if(a){for(var n=0;n<a.length;n++)if(a[n].type===e&&a[n].id===t){a.splice(n,1);break}le("marked",JSON.stringify(a))}},Za=function(){var e=ce("marked");if(e)return e=JSON.parse(e)},en=function(e,t,a){var n=[],r=Za();if(r){var i=!0,o=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value;d.type===e&&d.id===t||n.push(d)}}catch(p){o=!0,s=p}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}}n.push({id:t,type:e,subject:a.substring(0,120)}),le("marked",JSON.stringify(n))};Xa.defaultProps={isMarked:!1};var tn,an,nn,rn,on=a(164),sn=a.n(on),ln=a(35),cn=a(255),dn=a(382),pn=a(252),un=a(719),hn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).selectColor=function(e){var t={tlp:e};a.serverRequest=X.a.ajax({type:"put",url:"/scot/api/v2/"+a.props.type+"/"+a.props.id+"/",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(){console.log("set tlp")},error:function(e){this.props.errorToggle("Failed to set TLP",e)}})},a.render=function(){return r.a.createElement("span",{style:{padding:"entry"===a.props.type?"3px 20px":null}},r.a.createElement(pn,{placement:"top",overlay:r.a.createElement(un,{id:"tlp-tooltip"},a.props.tlp)},r.a.createElement(sn.a,{bsSize:"xsmall",bsStyle:{padding:"entry"===a.props.type?"3px 20px":null}},r.a.createElement(cn,null,r.a.createElement("svg",{id:"trafficlight1",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle1",r:"5",cx:"6",cy:"6",style:{fill:"red"===a.props.tlp||"white"===a.props.tlp?a.props.tlp:"gray",stroke:"black",strokeWidth:"2"}})),r.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle2",r:"5",cx:"6",cy:"6",style:{fill:"amber"===a.props.tlp&&"white"!==a.props.tlp?"orange":"white"===a.props.tlp?"white":"gray",stroke:"black",strokeWidth:"2"}})),r.a.createElement("svg",{id:"trafficlight2",style:{width:"12px",height:"12px"}},r.a.createElement("circle",{id:"circle3",r:"5",cx:"6",cy:"6",style:{fill:"green"===a.props.tlp||"white"===a.props.tlp?a.props.tlp:"gray",stroke:"black",strokeWidth:"2"}}))),r.a.createElement(dn,null,r.a.createElement(ln,{header:!0},"Traffic Light Protocol (TLP) Color"),r.a.createElement(ln,{eventKey:"unset",onSelect:a.selectColor},"Unset"),r.a.createElement(ln,{eventKey:"red",onSelect:a.selectColor},"Red"),r.a.createElement(ln,{eventKey:"amber",onSelect:a.selectColor},"Amber"),r.a.createElement(ln,{eventKey:"green",onSelect:a.selectColor},"Green"),r.a.createElement(ln,{eventKey:"white",onSelect:a.selectColor},"White"),r.a.createElement(ln,{divider:!0}),r.a.createElement(ln,{href:"https://www.us-cert.gov/tlp"},"What is TLP?")))))},a}return Object(d.a)(t,e),t}(r.a.Component),mn=a(482),gn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).toggleFlair=function(){var e=!a.state.globalFlairState;a.props.toggleFlair(),X()("iframe").each(function(e,t){if(null!=t.contentDocument){var a=X()(t).contents(),n=a.find(".entity-off"),r=a.find(".entity");!1===this.state.globalFlairState?(a.find(".extras").show(),a.find(".flair-off").hide(),n.each(function(e,t){X()(t).addClass("entity"),X()(t).removeClass("entity-off")})):(a.find(".extras").hide(),a.find(".flair-off").show(),r.each(function(e,t){X()(t).addClass("entity-off"),X()(t).removeClass("entity")}))}}.bind(Object(p.a)(Object(p.a)(a)))),a.setState({globalFlairState:e})},a.alertOpenOrCloseSelected=function(e){var t=[];a.props.alertsSelected.length>0?t=a.props.alertsSelected:a.props.entryData.length>0&&(t=a.props.entryData);var n={alerts:t.map(function(t){var a={id:t.id,status:e};return"closed"===e&&(a.closed=Math.round((new Date).getTime()/1e3)),a})};a.props.ToggleProcessingMessage(!0),fa("/scot/api/v2/".concat(a.props.type,"/").concat(a.props.id),n).then(function(){console.log("success"),this.props.ToggleProcessingMessage(!1)}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(t){this.props.errorToggle("failed to ".concat(e," selected alerts"),t),this.props.ToggleProcessingMessage(!1)}.bind(Object(p.a)(Object(p.a)(a))))},a.alertPromoteSelected=function(){var e=JSON.stringify({promote:"new"}),t=a.props.alertsSelected.map(function(e){return e.id});a.props.ToggleProcessingMessage(!0),fa("/scot/api/v2/alert/".concat(t[0]),e).then(function(e){var a={promote:e.data.pid};1===t.length&&this.props.ToggleProcessingMessage(!1),t.forEach(function(e,n){0===n?console.log("promoting rest of alerts"):fa("/scot/api/v2/alert/".concat(e),a).then(function(){n+1===t.length&&this.props.ToggleProcessingMessage(!1)}.bind(this)).catch(function(e){this.props.errorToggle("failed to promoted selected alerts",e)}.bind(this))}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))))},a.alertSelectExisting=function(){var e=prompt("Please Enter Event ID to promote into");""!==e&&null!==e&&(a.props.alertsSelected.forEach(function(t){var a={promote:parseInt(e,10)};fa("/scot/api/v2/alert/".concat(t.id),a).then(function(){console.log("Successfully promoted to event ".concat(e))}).catch(function(){prompt("Please use numbers only"),this.selectExisting()}.bind(this))}.bind(Object(p.a)(Object(p.a)(a)))),window.open("#/event/"+e))},a.alertExportCSV=function(){var e=a.props.alertsSelected,t=[];e.forEach(function(e){Object.keys(e).forEach(function(t){if("string"===typeof e[t]){var a=e[t];e[t]=a.replace(/(<([^>]+)>)/gi,"")}}),t.push(e)}.bind(Object(p.a)(Object(p.a)(a)))),a.setState({dataToDownload:t},function(){a.csvLink.link.click()})},a.PrintPrepare=function(){X()("iframe").contents().each(function(e,t){X()(t).find("blockquote").each(function(e,t){X()(t).css({"max-height":"5000px"})}),X()(t).find("pre").each(function(e,t){X()(t).css({"max-height":"5000px","word-wrap":"break-word"})})}),setTimeout(function(){this.forceUpdate()}.bind(Object(p.a)(Object(p.a)(a))),500),setTimeout(function(){X()("#print-button").click()},1e3)},a.Print=function(){window.print()},a.componentDidMount=function(){"alertgroup"!==a.props.type&&"alert"!==a.props.type||X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||(79===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("open"),67===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.alertOpenOrCloseSelected("closed"))}.bind(Object(p.a)(Object(p.a)(a)))),X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||84===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleFlair()}.bind(Object(p.a)(Object(p.a)(a))))},a.componentWillUnmount=function(){X()("#main-detail-container").unbind("keydown")},a.guideToggle=function(){a.props.flairToolbarToggle(a.props.guideID,null,"guide",{top:0,left:0},null)},a.sourceToggle=function(){a.props.flairToolbarToggle(a.props.id,null,"source",{top:0,left:0},null)},a.createGuide=function(){var e=JSON.stringify({subject:"ENTER A GUIDE NAME",data:{applies_to:[a.props.subjectName]}});X.a.ajax({type:"POST",url:"/scot/api/v2/guide",data:e,contentType:"application/json; charset=UTF-8",success:function(e){window.open("/#/guide/"+e.id)},error:function(e){this.props.errorToggle("failed to create a new guide",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.reparseFlair=function(){X.a.ajax({type:"put",url:"/scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8",success:function(){console.log("reparsing started")},error:function(e){this.props.errorToggle("failed to reparse flair",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.createLinkSignature=function(){X.a.ajax({type:"POST",url:"/scot/api/v2/signature",data:JSON.stringify({target:{id:a.props.id,type:a.props.type},name:"Name your Signature",status:"disabled"}),contentType:"application/json; charset=UTF-8",success:function(e){var t="/#/signature/"+e.id;window.open(t,"_blank")},error:function(e){this.props.errorToggle("failed to create a signature",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.manualUpdate=function(){a.props.updated(null,null)},a.render=function(){var e=a.props.subjectType,t=a.props.type,n=a.props.id,i=a.props.status,o="";if(a.props.headerData.subject?o=a.props.headerData.subject:a.props.headerData.value?o=a.props.headerData.value:a.props.headerData.name?o=a.props.headerData.name:a.props.headerData.body&&(o=a.props.headerData.body),"alertgroup"!==t){var s=!0;return"promoted"!==i?"alert"===t?"Event":"event"===t?"Incident":"incident"!==t&&"guide"!==t&&"intel"!==t&&"signature"!==t&&"entity"!==t||(s=!1):s=!1,r.a.createElement("div",{className:"entry-header detail-buttons"},"entity"!==t?r.a.createElement(Ka.a,{eventkey:"1",bsStyle:"success",onClick:a.props.entryToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-plus-circle","aria-hidden":"true"})," Add Entry"):null,"entity"!==t?r.a.createElement(Ka.a,{eventkey:"2",onClick:a.props.fileUploadToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-upload","aria-hidden":"true"})," Upload File"):null,r.a.createElement(Ka.a,{eventkey:"3",onClick:a.toggleFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),"alertgroup"===t||"event"===t||"intel"===t?r.a.createElement(Ka.a,{eventkey:"4",onClick:a.props.viewedByHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,r.a.createElement(Ka.a,{eventkey:"5",onClick:a.props.changeHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),"entity"!==t?r.a.createElement(Ka.a,{eventkey:"6",onClick:a.props.permissionsToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-users","aria-hidden":"true"})," Permissions"):null,r.a.createElement(hn,{type:t,id:n,tlp:a.props.headerData.tlp}),r.a.createElement(Ka.a,{eventkey:"7",onClick:a.props.entitiesToggle,bsSize:"xsmall"},r.a.createElement("span",{className:"entity"},"__")," View Entities"),"guide"===t?r.a.createElement(Ka.a,{eventkey:"8",onClick:a.props.guideRedirectToAlertListWithFilter,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-table","aria-hidden":"true"})," View Related Alerts"):null,r.a.createElement(Ka.a,{onClick:a.props.linksModalToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),s?r.a.createElement(Ja,{type:t,id:n,updated:a.props.updated,errorToggle:a.props.errorToggle}):null,"signature"!==t?r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:a.createLinkSignature},r.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"):null,"signature"===t?r.a.createElement(Ka.a,{eventkey:"11",onClick:a.props.showSignatureOptionsToggle,bsSize:"xsmall",bsStyle:"warning"},"View Custom Options"):null,r.a.createElement(Ka.a,{onClick:a.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},r.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),r.a.createElement(Ka.a,{onClick:a.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ka.a,{onClick:a.props.exportToggle,bsSize:"xsmall",id:"export-button"},r.a.createElement("i",{className:"fa fa-share","aria-hidden":"true"})," Export"," ",e," "),r.a.createElement(Ka.a,{bsStyle:"danger",eventkey:"9",onClick:function(){return a.props.deleteToggle(t)},bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e),r.a.createElement(za.a,{style:{float:"right"}},r.a.createElement(Xa,{type:t,id:n,string:o}),r.a.createElement(Ka.a,{onClick:a.props.markModalToggle,bsSize:"xsmall"},"Marked Objects"),r.a.createElement(Ka.a,{id:"refresh-detail",bsStyle:"info",eventkey:"10",onClick:a.manualUpdate,bsSize:"xsmall",style:{float:"right"}},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))))}return r.a.createElement("div",{className:"entry-header second-menu detail-buttons"},r.a.createElement(za.a,{style:{float:"right"}},r.a.createElement(Xa,{type:t,id:n,string:o}),r.a.createElement(Ka.a,{onClick:a.props.markModalToggle,bsSize:"xsmall"},"Marked Actions"),r.a.createElement(Ka.a,{bsStyle:"info",eventkey:"16",onClick:a.manualUpdate,bsSize:"xsmall",style:{float:"right"}},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"}))),r.a.createElement("span",{className:"entry-header detail-buttons"},r.a.createElement(Ka.a,{eventkey:"1",onClick:a.toggleFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"})," Toggle Flair"),r.a.createElement(Ka.a,{eventkey:"2",onClick:a.reparseFlair,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-refresh","aria-hidden":"true"})," Reparse Flair"),r.a.createElement("span",null,null!==a.props.guideID?r.a.createElement(Ka.a,{eventkey:"3",onClick:a.guideToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/guide.png",alt:""})," Guide"):r.a.createElement(Ka.a,{eventkey:"3",onClick:a.createGuide,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/guide.png",alt:""})," Create Guide")),null==a.props.headerData?null:r.a.createElement(Ka.a,{eventkey:"4",onClick:a.sourceToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/code.png",alt:""})," View Source"),r.a.createElement(Ka.a,{eventkey:"5",onClick:a.props.entitiesToggle,bsSize:"xsmall"},r.a.createElement("span",{className:"entity"},"__")," View Entities"),"alertgroup"===t||"event"===t||"intel"===t?r.a.createElement(Ka.a,{eventkey:"6",onClick:a.props.viewedByHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," Viewed By History"):null,r.a.createElement(Ka.a,{eventkey:"7",onClick:a.props.changeHistoryToggle,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/clock.png",alt:""})," ",e," History"),r.a.createElement(hn,{type:t,id:n,tlp:a.props.headerData.tlp}),r.a.createElement(Ka.a,{onClick:a.props.linksModalToggle,bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-link","aria-hidden":"true"})," Links"),r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:a.createLinkSignature},r.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})," Create & Link Signature"),r.a.createElement(Ka.a,{onClick:a.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ka.a,{bsStyle:"danger",eventkey:"8",onClick:function(){return a.props.deleteToggle(t)},bsSize:"xsmall"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete"," ",e)),a.props.alertsSelected.length>0?r.a.createElement("span",null,r.a.createElement(Ka.a,{eventkey:"8",onClick:function(){return a.alertOpenOrCloseSelected("open")},bsSize:"xsmall",bsStyle:"danger"},r.a.createElement("img",{src:"/images/open.png",alt:""})," Open Selected"),r.a.createElement(Ka.a,{eventkey:"9",onClick:function(){return a.alertOpenOrCloseSelected("closed")},bsSize:"xsmall",bsStyle:"success"},r.a.createElement("i",{className:"fa fa-flag-checkered","aria-hidden":"true"})," Close Selected"),r.a.createElement(Ka.a,{eventkey:"10",onClick:a.alertPromoteSelected,bsSize:"xsmall",bsStyle:"warning"},r.a.createElement("img",{src:"/images/megaphone.png",alt:""})," Promote Selected"),r.a.createElement(Ka.a,{eventkey:"11",onClick:a.alertSelectExisting,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/megaphone_plus.png",alt:""})," Add Selected to"," ",r.a.createElement("b",null,"Existing Event")),r.a.createElement(mn.CSVLink,{data:a.state.dataToDownload,filename:"data.csv",className:"hidden",ref:function(e){return a.csvLink=e},target:"_blank"}),r.a.createElement(Ka.a,{eventkey:"14",onClick:a.alertExportCSV,bsSize:"xsmall"},r.a.createElement("img",{src:"/images/csv_text.png",alt:""})," Export to CSV"),r.a.createElement(Xa,{type:t,id:n,string:o,isAlert:!0,getSelectedAlerts:a.getSelectedAlerts,alertsSelected:a.props.alertsSelected}),r.a.createElement(Ka.a,{onClick:a.PrintPrepare,bsSize:"xsmall",bsStyle:"info"},r.a.createElement("i",{className:"fa fa-print","aria-hidden":"true"})," Print"),r.a.createElement(Ka.a,{onClick:a.Print,style:{display:"none"},id:"print-button"}),r.a.createElement(Ka.a,{eventkey:"15",onClick:function(){return a.props.deleteToggle("alert")},bsSize:"xsmall",bsStyle:"danger"},r.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})," Delete Selected")):null)},a.state={globalFlairState:!0,promoteRemaining:null,dataToDownload:[]},a}return Object(d.a)(t,e),t}(r.a.Component),yn=a(52),fn=a.n(yn),bn=a(63),vn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"},overlay:{zIndex:"1101"}},En={READY:{style:"danger"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"warning"}},kn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).deleteItems=function(){var e=a.props.deleteType,t=[];(t="alert"!==e?[parseInt(a.props.id,10)]:a.props.alertsSelected.map(function(e){return e.id})).forEach(function(a,n){var r=this.props.enqueueSnackbar,i=function(e){return va.apply(this,arguments)}("/scot/api/v2/".concat(e,"/").concat(a));this.props.removeCallback(parseInt(this.props.id,10)),i.then(function(){n===t.length-1&&"alert"===e&&this.props.updated(),"alert"!==e?(this.props.history.push("/"+e),r("Successfully deleted ".concat(this.props.id,"."),{variant:"success"})):"alert"===e&&r("Successfully deleted ".concat(a,"."),{variant:"success"})}.bind(this)).catch(function(e){r("Failed deleting exception.",{variant:"error"})})}.bind(Object(p.a)(Object(p.a)(a)))),a.props.deleteToggle(e)},a.state={key:e.id},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.deleteType,t="";if("alert"!==e)t=" ".concat(e,": ").concat(this.props.id);else if("alert"===e){var a=this.props.alertsSelected.map(function(e){return r.a.createElement("span",{style:{paddingRight:10}},e.id)});t=r.a.createElement("span",null,e,"(s) : ",a)}return r.a.createElement(fn.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:vn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(W.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),r.a.createElement(W.a,{bsStyle:"danger",id:"delete",onClick:this.deleteItems},"Delete")))}}]),t}(r.a.Component),wn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={key:e.id},a.toggle=a.toggle.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"toggle",value:function(){X.a.ajax({type:"delete",url:"scot/api/v2/entry/"+this.props.entryid,success:function(e){console.log("success: "+e);this.state.key}.bind(this),error:function(e){this.props.errorToggle("Failed to delete entry",e)}.bind(this)}),this.props.deleteToggle()}},{key:"render",value:function(){return r.a.createElement(fn.a,{isOpen:!0,onRequestClose:this.props.deleteToggle,style:vn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.deleteToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete Entry: ",this.props.entryid,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(W.a,{id:"cancel-delete",onClick:this.props.deleteToggle},"Cancel"),r.a.createElement(W.a,{bsStyle:"danger",id:"delete",onClick:this.toggle},"Delete")))}}]),t}(n.PureComponent),Sn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={deleteButton:En.READY},a.deleteAll=a.deleteAll.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"deleteAll",value:function(){var e=this;this.setState({deleteButton:En.LOADING});var t=!0,a=this.props.things;Array.isArray(a)||(a=[a]),X.a.when.apply(X.a,Object(T.a)(a.map(function(t){return e.deleteAjax(t)}))).then(function(){e.setState({deleteButton:En.SUCCESS})},function(a){console.error(a),e.setState({deleteButton:En.ERROR}),e.props.errorToggle("error deleting",a),t=!1}).always(function(){setTimeout(function(){e.setState({deleteButton:En.READY}),e.props.callback(t)},2e3)})}},{key:"deleteAjax",value:function(e){return X.a.ajax({type:"delete",url:"/scot/api/v2/"+e.type+"/"+e.id,contentType:"application/json; charset=UTF-8"})}},{key:"render",value:function(){var e=this.props.things,t="";t=Array.isArray(e)?e.map(function(e){return"".concat(e.type,": ").concat(e.id)}).join(", "):"".concat(e.type,": ").concat(e.id);var a=this.state.deleteButton;return r.a.createElement(fn.a,{isOpen:!0,onRequestClose:this.props.callback,style:vn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"images/close_toolbar.png",className:"close_toolbar",onClick:this.props.callback}),r.a.createElement("h3",{id:"myModalLabel"},"Are you sure you want to delete ",t,"?")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(W.a,{id:"cancel-delete",onClick:this.props.callback},"Cancel"),r.a.createElement(W.a,{bsStyle:a.style,id:"delete",onClick:this.deleteAll,disabled:a.disabled},a.text?a.text:"Delete")))}}]),t}(n.PureComponent),Tn=Object(bn.withSnackbar)(kn),jn=a(305),On=a.n(jn),xn=a(99),Cn=a.n(xn),Dn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Nn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){var e=ue("whoami");e&&a.setState({whoami:e})},a.componentWillReceiveProps=function(){a.setState({currentOwner:a.props.data})},a.toggle=function(){if(void 0!==a.state.whoami){var e={owner:a.state.whoami};X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){},error:function(e){this.props.errorToggle("Failed to change owner",e)}.bind(Object(p.a)(Object(p.a)(a)))})}else a.props.errorToggle("Failed to detect current user");a.ownerToggle()},a.ownerToggle=function(){!1===a.state.ownerToolbar?a.setState({ownerToolbar:!0}):a.setState({ownerToolbar:!1})},a.render=function(){return r.a.createElement("div",null,r.a.createElement(Cn.a,{bsSize:"xsmall",id:"event_owner",title:a.state.currentOwner},r.a.createElement(k.a,{eventKey:"1",onClick:a.ownerToggle},"Take Ownership")),a.state.ownerToolbar?r.a.createElement(fn.a,{isOpen:!0,onRequestClose:a.ownerToggle,style:Dn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:a.ownerToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Take Ownership")),r.a.createElement("div",{className:"modal-body"},"Are you sure you want to take ownership of this event?"),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(On.a,{id:"cancel-ownership",onClick:a.ownerToggle},"Cancel"),r.a.createElement(On.a,{bsStyle:"info",id:"take-ownership",onClick:a.toggle},"Take Ownership"))):null)},a.state={currentOwner:a.props.data,whoami:void 0,ownerToolbar:!1},a}return Object(d.a)(t,e),t}(r.a.Component),An=a(52),_n=a(13),Mn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Ln=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).render=function(){return r.a.createElement("div",null,r.a.createElement(An,{isOpen:!0,onRequestClose:a.props.entitiesToggle,style:Mn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:a.props.entitiesToggle}),r.a.createElement("h3",{id:"myModalLabel"},"List of Entities")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"50vh",overflowY:"auto"}},a.state.entitiesBody?r.a.createElement(In,{data:a.props.entityData,flairToolbarToggle:a.props.flairToolbarToggle}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(_n,{onClick:a.props.entitiesToggle},"Done"))))},a.state={entitiesBody:!0},a}return Object(d.a)(t,e),t}(r.a.Component),In=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=[],t=a.props.data,n={entities:{}},i=n.entities;for(var o in t){var s={},l=t[o].type,c=o;if(s[t[o].id]=c,i.hasOwnProperty(l))i[l].push(s);else{var d=[];d.push(s),i[l]=d}}for(var p in i){var u=p,h=i[p];e.push(r.a.createElement(Pn,{type:u,value:h,flairToolbarToggle:a.props.flairToolbarToggle}))}return r.a.createElement("div",null,e)},a}return Object(d.a)(t,e),t}(r.a.Component),Pn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){for(var e=[],t=a.props.type,n=a.props.value,i=0;i<n.length;i++){var o=n[i],s=null,l=null;for(var c in o)s=c,l=o[c];e.push(r.a.createElement(Rn,{entityValue:l,entityId:s,flairToolbarToggle:a.props.flairToolbarToggle}))}return r.a.createElement("div",{style:{border:"1px solid black",width:"500px"}},r.a.createElement("h3",null,t),r.a.createElement("div",{style:{fontWeight:"normal",maxHeight:"300px",overflowY:"auto"}},e))},a}return Object(d.a)(t,e),t}(r.a.Component),Rn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).toggle=function(){a.props.flairToolbarToggle(a.props.entityId,a.props.entityValue,"entity")},a.render=function(){var e=a.props.entityValue;return r.a.createElement("a",{href:"javascript: void(0)",onClick:a.toggle},e,r.a.createElement("br",null))},a}return Object(d.a)(t,e),t}(r.a.Component),Fn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Un=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){X.a.ajax({type:"get",url:"/scot/api/v2/"+a.props.type+"/"+a.props.id+"/history",success:function(e){this.setState({historyBody:!0,data:e.records})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to get change history",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){return r.a.createElement("div",null,r.a.createElement(fn.a,{isOpen:!0,onRequestClose:a.props.changeHistoryToggle,style:Fn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:a.props.changeHistoryToggle}),r.a.createElement("h3",{id:"myModalLabel"},a.props.subjectType," Change History")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",width:"700px",overflowY:"auto"}},a.state.historyBody?r.a.createElement(Hn,{data:a.state.data}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ka.a,{onClick:a.props.changeHistoryToggle},"Done"))))},a.state={historyBody:!1,data:""},a}return Object(d.a)(t,e),t}(r.a.Component),Hn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=[],t=a.props.data;for(var n in t)e.push(r.a.createElement(Wn,{data:t[n]}));return r.a.createElement("div",null,e)},a}return Object(d.a)(t,e),t}(r.a.Component),Wn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=a.props.data;return r.a.createElement("div",null,"ID: ",e.id," -"," ",r.a.createElement(Ba.a,{value:1e3*e.when,format:"MM/DD/YYYY hh:mm:ss a"})," -"," ",e.who," - ",e.what)},a}return Object(d.a)(t,e),t}(r.a.Component),Bn={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Vn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={historyBody:!1,data:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){this.setState({historyBody:!0,data:e})}.bind(this),error:function(e){this.props.errorToggle("failed to get user change history",e)}.bind(this)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(fn.a,{isOpen:!0,onRequestClose:this.props.viewedByHistoryToggle,style:Bn},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{alt:"",src:"/images/close_toolbar.png",className:"close_toolbar",onClick:this.props.viewedByHistoryToggle}),r.a.createElement("h3",{id:"myModalLabel"},this.props.subjectType," Viewed By")),r.a.createElement("div",{className:"modal-body",style:{maxHeight:"30vh",overflowY:"auto"}},this.state.historyBody?r.a.createElement(zn,{data:this.state.data}):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ka.a,{onClick:this.props.viewedByHistoryToggle},"Done"))))}}]),t}(r.a.Component),zn=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=[],t=this.props.data;for(var a in t.view_history)e.push(r.a.createElement(qn,{data:t.view_history[a],prop:a}));return r.a.createElement("div",null,e)}}]),t}(r.a.Component),qn=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.data,t=this.props.prop;return r.a.createElement("div",null,r.a.createElement("b",null,t)," at"," ",r.a.createElement(Ba.a,{value:1e3*e.when,format:"MM/DD/YYYY hh:mm:ss a"})," ","from IP: ",e.where)}}]),t}(r.a.Component),Kn=a(167).WithContext,Gn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).toggleNewReadPermission=function(){!1===a.state.readPermissionEntry?a.setState({readPermissionEntry:!0}):!0===a.state.readPermissionEntry&&a.setState({readPermissionEntry:!1})},a.toggleNewModifyPermission=function(){!1===a.state.modifyPermissionEntry?a.setState({modifyPermissionEntry:!0}):!0===a.state.modifyPermissionEntry&&a.setState({modifyPermissionEntry:!1})},a.permissionsfunc=function(e){console.log(e.groups);var t=[],a=[],n=[];for(var r in e.groups){e.groups[r];"read"===r?e.groups[r].forEach(function(e){a.push(e)}):"modify"===r&&e.groups[r].forEach(function(e){t.push(e)})}return n.push(a),n.push(t),n},a.render=function(){var e=[],t=[],n=a.props.permissionData,i=a.permissionsfunc(n),o=a.props.id,s=a.props.type;if(void 0!==i[0])for(var l=0;l<i[0].length;l++){t.push(r.a.createElement(Jn,{data:i[0][l],dataRead:i[0],dataModify:i[1],updateid:a.props.updateid,id:o,type:s,read_modify:"read",updated:a.props.updated}))}if(void 0!==i[1])for(var c=0;c<i[1].length;c++){e.push(r.a.createElement(Jn,{data:i[1][c],dataRead:i[0],dataModify:i[1],updateid:a.props.updateid,id:o,type:s,read_modify:"modify",updated:a.props.updated}))}return"entry"===s?r.a.createElement("div",{id:"",className:""},r.a.createElement("span",{style:{display:"inline-flex"}},"Read Groups: ",t,a.state.readPermissionEntry?r.a.createElement("span",{style:{display:"inherit",color:"white"}},r.a.createElement(Yn,{readUpdate:1,modifyUpdate:0,dataRead:i[0],dataModify:i[1],type:s,updateid:a.props.updateid,id:o,toggleNewReadPermission:a.toggleNewReadPermission,updated:a.props.updated,permissionsToggle:a.props.permissionsToggle})):null,a.state.readPermissionEntry?r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:a.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:a.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,a.state.modifyPermissionEntry?r.a.createElement("span",{style:{display:"inherit",color:"white"}},r.a.createElement(Yn,{readUpdate:0,modifyUpdate:1,dataRead:i[0],dataModify:i[1],type:s,updateid:a.props.updateid,id:o,toggleNewModifyPermission:a.toggleNewModifyPermission,updated:a.props.updated,permissionsToggle:a.props.permissionsToggle})):null,a.state.modifyPermissionEntry?r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:a.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:a.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})))):r.a.createElement("div",{id:"",className:"toolbar entry-header-info-null",style:{paddingTop:"0px"}},r.a.createElement("span",{style:{display:"inline-flex",paddingRight:"10px",paddingLeft:"5px"}},r.a.createElement("h4",null,"Permissions:")),"Read Groups: ",t,a.state.readPermissionEntry?r.a.createElement(Yn,{readUpdate:1,modifyUpdate:0,dataRead:i[0],dataModify:i[1],type:s,updateid:a.props.updateid,id:o,toggleNewReadPermission:a.toggleNewReadPermission,updated:a.props.updated,permissionsToggle:a.props.permissionsToggle}):null,a.state.readPermissionEntry?r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:a.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:a.toggleNewReadPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("span",{style:{paddingLeft:"5px"}},"Modify Groups: "),e,a.state.modifyPermissionEntry?r.a.createElement(Yn,{readUpdate:0,modifyUpdate:1,dataRead:i[0],dataModify:i[1],type:s,updateid:a.props.updateid,id:o,toggleNewModifyPermission:a.toggleNewModifyPermission,updated:a.props.updated,permissionsToggle:a.props.permissionsToggle}):null,a.state.modifyPermissionEntry?r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:a.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"})):r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:a.toggleNewModifyPermission},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"})),r.a.createElement("img",{src:"/images/close_toolbar.png",alt:"",className:"close_toolbar",onClick:a.props.permissionsToggle}))},a.state={readPermissionEntry:!1,modifyPermissionEntry:!1},a}return Object(d.a)(t,e),t}(r.a.Component),Jn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).permissionDelete=function(){var e={},t=[],n=a.props.data,r=a.props.dataRead,i=a.props.dataModify;if("read"===a.props.read_modify){for(var o=0;o<r.length;o++)r[o]!==n&&t.push(r[o]);e.read=t,e.modify=i}else if("modify"===a.props.read_modify){for(var s=0;s<i.length;s++)i[s]!==n&&t.push(i[s]);e.read=r,e.modify=t}X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify({groups:e}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success")},error:function(e){this.props.errorToggle("error Failed to delete group",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){var e=a.props.data;a.props.type;return r.a.createElement("span",{id:"permission_source",className:"permissionButton"},e,r.a.createElement("span",{className:"fa fa-times permissionButtonClose","aria-hidden":"true",onClick:a.permissionDelete}))},a}return Object(d.a)(t,e),t}(r.a.Component),Yn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleAddition=function(e){var t={},n=a.props.dataRead,r=a.props.dataModify,i=a.props.permissionsToggle;1===a.props.readUpdate?n.push(e.text):1===a.props.modifyUpdate&&r.push(e.text),void 0!==a.props.toggleNewModifyPermission?i=a.props.toggleNewModifyPermission:void 0!==a.props.toggleNewReadPermission&&(i=a.props.toggleNewReadPermission),t.read=n,t.modify=r,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: permission added"),i()},error:function(e){i(),this.props.errorToggle("error Failed to add group",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.handleInputChange=function(e){},a.handleDelete=function(){},a.handleDrag=function(){},a.state={suggestions:a.props.options,key:a.props.updateid},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.state.suggestions;return r.a.createElement("span",{className:"tag-new"},r.a.createElement(Kn,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,handleDelete:this.handleDelete,handleDrag:this.handleDrag,minQueryLength:1,customCSS:1}))}}]),t}(r.a.Component),Qn=a(483),Xn=a.n(Qn),$n=a(144),Zn=a.n($n),er=a(100),tr=a.n(er),ar=a(173),nr=a(46),rr=a.n(nr),ir=a(141),or=a.n(ir),sr=a(142),lr=a.n(sr),cr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handlePUT=function(){var e=a.props,t=e.enqueueSnackbar,n=e.id,r={body:a.state.editedtext,target_id:a.props.targetid,parent:a.props.parent,target_type:a.props.type,parsed:0},i="/scot/api/v2/entry/".concat(n);Le.a.put(i,r).then(function(){t("Successfully updated entry",{variant:"success"}),this.props.handleClose(),this.props.addedEntry()}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){console.log(e),t("Failed updated entry.",{variant:"error"}),this.props.handleClose()})},a.handleEditorChange=function(e){a.setState({editedtext:e}),console.log("State is now: ".concat(a.state.editedtext))},a.state={editedtext:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.setState({editedtext:this.props.localconflict})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement(or.a,{className:e.card},r.a.createElement(lr.a,null,r.a.createElement(rr.a,{variant:"h5",component:"h2"},"Uh-oh! It looks like there was a conflict between your ",this.props.type," and the one cached saved on server."),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("div",{id:"remote",className:"remote"},r.a.createElement("b",null,"Changes on server: "),r.a.createElement(ar.a,{className:"remote",initialValue:this.props.remoteconflict,disabled:!0})),r.a.createElement("br",null),r.a.createElement("div",{id:"local",className:"local"},r.a.createElement("b",null,"Your changes: "),r.a.createElement(ar.a,{initialValue:this.state.editedtext,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",onEditorChange:this.handleEditorChange,value:this.state.editedtext,init:{selector:"textarea",plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textcolor colorpicker textpattern imagetools",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen spellchecker | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote",theme:"modern",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.addButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",onclick:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}))),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(da.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:this.handlePUT,variant:"contained"},"Send Update to Server"),r.a.createElement(da.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}]),t}(r.a.Component),dr=Object(bn.withSnackbar)(Object(gt.withStyles)(function(e){return{card:{minWidth:700,marginBottom:20}}})(cr)),pr=a(169),ur=a.n(pr),hr=a(13),mr=a(56).Prompt,gr=a(56).Link,yr=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){var e=ue("whoami");e&&a.setState({whoami:e}),"Edit"===a.props.entryAction&&X.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+a.props.id,success:function(e){this.setState({content:e.body,asyncContentLoaded:!0,recentlyUpdated:e.updated}),this.forceUpdate()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Error getting original data from source. Copy/Paste original",e),this.setState({content:"Error getting original data from source. Copy/Paste original",asyncContentLoaded:!0}),this.forceUpdate()}.bind(Object(p.a)(Object(p.a)(a)))}),X()("#not_saved_entry_"+a.state.key).position()&&X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#not_saved_entry_"+a.state.key).position().top)},a.onCancel=function(){a.setState({leaveCatch:!1}),a.props.addedentry(),a.setState({change:!1})},a.submit=function(){if(""===X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").text()&&0===X()("#"+a.state.key+"_ifr").contents().find("#tinymce").find("img").length)alert("Please Add Some Text");else if("Reply"===a.props.entryAction){var e={};X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").each(function(e,t){X()(t).find("img").each(function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}})}),e=JSON.stringify({parent:Number(a.props.id),body:X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(a.props.targetid),target_type:a.props.type,tlp:"unset"}),X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(p.a)(Object(p.a)(a)))})}else"Edit"===a.props.entryAction?X.a.ajax({type:"GET",url:"/scot/api/v2/entry/"+a.props.id,success:function(e){this.state.recentlyUpdated!==e.updated?(this.forEdit(!1),this.setState({showConflict:!0,remoteconflict:e.body})):this.forEdit(!0)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get data for edit",e)}.bind(Object(p.a)(Object(p.a)(a)))}):"alert"===a.props.type?(X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").each(function(e,t){X()(t).find("img").each(function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}})}),e=JSON.stringify({body:X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(a.props.targetid),target_type:"alert",tlp:"unset",parent:0}),X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry(),this.props.toggleVisibility()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(p.a)(Object(p.a)(a)))})):(X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").each(function(e,t){X()(t).find("img").each(function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}})}),e={parent:0,body:X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(a.props.targetid),target_type:a.props.type,tlp:"unset"},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to add entry.",e)}.bind(Object(p.a)(Object(p.a)(a)))}))},a.exportContent=function(){if(a.props.recipients.length>0){var e;X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").each(function(e,t){X()(t).find("img").each(function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}})}),e=JSON.stringify({body:X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").html(),to:a.props.recipients,thing:a.props.type}),X.a.ajax({type:"post",url:"/scot/api/v2/sendexport",data:e,contentType:"application/json; charset=UTF-8",dataType:"json",success:function(){this.setState({leaveCatch:!1}),this.props.exportResponse("success")}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to export "+this.props.type,e),this.props.exportResponse("error")}.bind(Object(p.a)(Object(p.a)(a)))})}else a.props.errorToggle("Please enter a valid email address")},a.handleClose=function(){a.setState({showConflict:!1})},a.forEdit=function(e){if(e){X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").each(function(e,t){X()(t).find("img").each(function(e,t){if(X()(t)[0].src.startsWith("blob")){var a=document.createElement("canvas"),n=new Image;n=X()(t),a.width=n[0].width,a.height=n[0].height,a.getContext("2d").drawImage(n[0],0,0);var r=a.toDataURL("image/png");X()(t).attr("src",r)}})});var t={parent:Number(a.props.parent),body:X()("#tiny_"+a.state.key+"_ifr").contents().find("#tinymce").html(),target_id:Number(a.props.targetid),target_type:a.props.type,parsed:0};X.a.ajax({type:"put",url:"/scot/api/v2/entry/"+a.props.id,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){this.setState({leaveCatch:!1}),this.props.addedentry()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to edit entry.",e)}.bind(Object(p.a)(Object(p.a)(a)))})}},a.handleEditorChange=function(e){a.setState({localcontent:e})},a.render=function(){var e="not_saved_entry_"+a.state.key;return r.a.createElement("div",{id:e,className:"not_saved_entry"},a.state.showConflict?r.a.createElement(ur.a,{fullWidth:!0,maxWidth:"md",open:a.state.showConflict,onClose:a.handleClose,"aria-labelledby":"simple-dialog-title"},r.a.createElement(dr,{targetid:a.props.targetid,type:a.props.type,parent:a.props.parent,addedEntry:a.props.addedentry,id:a.props.id,localconflict:a.state.localcontent,handleClose:a.handleClose,remoteconflict:a.state.remoteconflict})):null,r.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},r.a.createElement("div",{className:"row-fluid entry-header"},r.a.createElement("div",{className:"entry-header-inner"},"[",r.a.createElement(gr,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",a.state.whoami,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Export"===a.props.entryAction?r.a.createElement(hr,{bsSize:"xsmall",onClick:a.exportContent,bsStyle:"success"},"Export"):r.a.createElement(hr,{bsSize:"xsmall",onClick:a.submit,bsStyle:"success"},"Submit"),r.a.createElement(hr,{bsSize:"xsmall",onClick:a.onCancel},"Cancel")))),a.state.asyncContentLoaded?r.a.createElement(ar.a,{id:a.state.tinyID,className:"inputtext",initialValue:a.state.content,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools",onEditorChange:a.handleEditorChange,init:{table_default_attributes:{border:"5",borderStyle:"solid",borderColor:"blue"},auto_focus:a.state.tinyID,selector:"textarea",browser_spellcheck:!0,contextmenu:!1,plugins:"advlist lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking save table directionality emoticons template paste textpattern imagetools",table_clone_elements:"strong em b i font h1 h2 h3 h4 h5 h6 p div",paste_retain_style_properties:"all",paste_data_images:!0,paste_preprocess:function(e,t){t.content=t.content.replace(/<(\/)?a([^>]*)>/g,"<$1span$2>")+" "},paste_postprocess:function(e,t){t.node.querySelectorAll("table").forEach(function(e){e.setAttribute("border","1"),e.setAttribute("cellpadding","1"),e.setAttribute("cellspacing","0")})},relative_urls:!1,remove_script_host:!1,link_assume_external_targets:!0,toolbar1:"full screen  | undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | forecolor backcolor fontsizeselect fontselect formatselect | blockquote code link image insertdatetime | customBlockquote",content_css:"/css/entryeditor.css",height:250,verify_html:!1,setup:function(e){e.ui.registry.addMenuButton("customBlockquote",{text:"500px max-height blockquote",tooltip:"Insert a 500px max-height div (blockquote)",fetch:function(){e.insertContent("<blockquote><p><br></p></blockquote>")}})}}}):r.a.createElement("div",null,"Loading Editor...")),r.a.createElement(mr,{when:a.state.leaveCatch,message:"Unsubmitted entry detected. You may want to submit or copy the contents of the entry before navigating elsewhere. Click CANCEL to prevent navigation elsewhere."}))};var n,i,o=new Date,d="tiny_"+(o=o.getTime());switch(a.props.entryAction){case"Add":case"Reply":n="",i=!0;break;case"Copy To Entry":n=a.props.content,i=!0;break;case"Edit":n="",i=!1;break;case"Export":n=a.props.content,i=!0;break;default:n="",i=!0}return a.state={tinyID:d,key:o,content:n,asyncContentLoaded:i,leaveCatch:!0,whoami:void 0,recentlyUpdated:0,showConflict:!1,localcontent:""},a}return Object(d.a)(t,e),t}(r.a.Component),fr=a(484),br=a.n(fr),vr=a(170),Er=a.n(vr),kr=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentWillMount=function(){},a.onLoad=function(){if(void 0!==document.getElementById("iframe_"+a.props.id)&&null!==document.getElementById("iframe_"+a.props.id))if("complete"===document.getElementById("iframe_"+a.props.id).contentDocument.readyState){var e=X()("#iframe_"+a.props.id),t=X()(e).contents(),n=X()(t).find("head");n&&(X()(n).find("link")||n.append(X()("<link/>",{rel:"stylesheet",href:"css/sandbox.css",type:"text/css"}))),setTimeout(function(){void 0!==document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){var e;e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight,e+="px",this.state.height!==e&&this.setState({height:e})}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))),250)}else setTimeout(a.onLoad,0)},a.componentDidMount=function(){a.setState({isMounted:!0});var e=a.state.tabs,t=a.props.entityvalue;if("source"!==a.props.entitytype)if(void 0===a.state.entityid||isNaN(a.state.entityid))X.a.ajax({type:"GET",url:"scot/api/v2/"+a.props.entitytype+"/byname",data:{name:t},success:function(t){var a=t.id;this.state.isMounted&&(this.setState({entityid:a}),X.a.ajax({type:"GET",url:"scot/api/v2/"+this.props.entitytype+"/"+a,success:function(t){var n={data:t,entityid:a,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(n),this.state.isMounted){var r=[];r.push(a),this.setState({tabs:e,currentKey:a,initialLoad:!0,processedIds:r}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity detail id information ",e)}.bind(Object(p.a)(Object(p.a)(a)))});else{var n=a.state.entityid;Array.isArray(n)||(n=[parseInt(n,10)]);for(var r=0;r<n.length;r++)X.a.ajax({type:"GET",url:"scot/api/v2/"+a.props.entitytype+"/"+n[r],success:function(t){var a={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e.push(a),this.state.isMounted){var n=[];n.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:n}),this.props.createCallback(this.props.entityid,this.updated)}}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(Object(p.a)(Object(p.a)(a)))})}else{var i={data:a.props.data,entityid:a.props.entityid,entitytype:a.props.entitytype,valueClicked:a.props.entitytype};e.push(i);var o=[];o.push(a.props.entityid),a.setState({tabs:e,currentKey:parseInt(a.props.entityid,10),initialLoad:!0,processedIds:o}),a.props.createCallback(a.props.entityid,a.updated)}X()(document).keydown(function(e){X()("input").is(":focus")||void 0===X()("#main-search-results")[0]&&27===e.keyCode&&(this.props.flairToolbarOff(),e.preventDefault())}.bind(Object(p.a)(Object(p.a)(a)))),a.containerHeightAdjust(),window.addEventListener("resize",a.containerHeightAdjust),a.onLoad(),X()("iframe").each(function(e,t){t.contentWindow.requestAnimationFrame(function(){if(null!=t.contentDocument){var e=X()(t).contents();X()(t.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each(function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)})}})})},a.componentWillUnmount=function(){a.setState({isMounted:!1}),X()(document).off("keydown")},a.componentWillReceiveProps=function(e){a.onLoad();var t={checkForInitialLoadComplete:function(){var a={addNewEntity:function(){var t=this.state.tabs;if("source"!==e.entitytype)void 0===e.entityid||isNaN(e.entityid)?X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/byname",data:{name:e.entityvalue},success:function(a){var n=a.id;this.state.isMounted&&(this.setState({entityid:n}),X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+n,success:function(a){var r={data:a,entityid:n,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(r),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)}))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity id detail information",e)}.bind(this)}):X.a.ajax({type:"GET",url:"scot/api/v2/"+e.entitytype+"/"+e.entityid,success:function(a){var n={data:a,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entityvalue};t.push(n),this.state.isMounted&&(this.setState({tabs:t,currentKey:e.entityid}),this.props.createCallback(e.entityid,this.updated))}.bind(this),error:function(e){this.props.errorToggle("failed to get entity detail information",e)}.bind(this)});else{var a={data:e.data,entityid:e.entityid,entitytype:e.entitytype,valueClicked:e.entitytype};t.push(a);var n=[];n.push(e.entityid),this.setState({tabs:t,currentKey:parseInt(e.entityid,10),initialLoad:!0,processedIds:n}),this.props.createCallback(e.entityid,this.updated),this.props.watcher()}}.bind(this)};if(!1===this.state.initialLoad)setTimeout(t.checkForInitialLoadComplete,50);else if(void 0!==e&&null!=e.entitytype&&void 0!==e.entityid)for(var n=parseInt(e.entityid,10),r=0;r<this.state.tabs.length;r++){if(n===this.state.tabs[r].entityid||"guide"===this.state.tabs[r].entitytype&&"guide"===e.entitytype)return void(this.state.isMounted&&this.setState({currentKey:n}));for(var i=this.state.processedIds,o=!0,s=0;s<i.length;s++)i[s]===n&&(o=!1);o&&(a.addNewEntity(),i.push(n),this.setState({processedIds:i}))}}.bind(Object(p.a)(Object(p.a)(a)))};t.checkForInitialLoadComplete(),a.containerHeightAdjust()},a.updated=function(){for(var e=a.state.tabs,t=(a.props.entityvalue,function(t){var n=t;X.a.ajax({type:"GET",url:"scot/api/v2/"+a.props.entitytype+"/"+e[t].entityid,success:function(t){var a={data:t,entityid:t.id,entitytype:this.props.entitytype,valueClicked:t.value};if(e[n]=a,this.state.isMounted){var r=[];r.push(t.id),this.setState({tabs:e,currentKey:t.id,initialLoad:!0,processedIds:r})}}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get updated entity detail information",e)}.bind(Object(p.a)(Object(p.a)(a)))})}),n=0;n<e.length;n++)t(n)},a.checkFlairHover=function(e){null!=e.contentDocument&&X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"===X()(t).css("color"))X()(t).data("state","down");else if("down"===X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.props.linkWarningToggle(a)}}.bind(Object(p.a)(Object(p.a)(a))))},a.initDrag=function(e){if(X()("#dragme").hasClass("entityPopUpMaxSizeDefault")){var t=X()("#dragme").height()+"px";X()("#dragme").css("height",t),X()("#dragme").removeClass("entityPopUpMaxSizeDefault")}var n=document.getElementById("dragme");tn=e.clientX,an=e.clientY,nn=parseInt(document.defaultView.getComputedStyle(n).width,10),rn=parseInt(document.defaultView.getComputedStyle(n).height,10),document.documentElement.addEventListener("mousemove",a.doDrag,!1),document.documentElement.addEventListener("mouseup",a.stopDrag,!1),a.blockiFrameMouseEvent()},a.doDrag=function(e){var t=document.getElementById("dragme");console.log("elem.style.width before: ".concat(t.style.width)),console.log("e.clientX before: ".concat(e.clientX)),console.log("startX before: ".concat(tn)),console.log("startwidth before: ".concat(nn)),nn+e.clientX-tn>586&&(t.style.width=nn+e.clientX-tn+"px"),rn+e.clientY-an>386&&(t.style.height=rn+e.clientY-an+"px")},a.stopDrag=function(e){document.documentElement.removeEventListener("mousemove",a.doDrag,!1),document.documentElement.removeEventListener("mouseup",a.stopDrag,!1),a.allowiFrameMouseEvent()},a.moveDivInit=function(e){document.documentElement.addEventListener("mouseup",a.moveDivStop,!1),a.blockiFrameMouseEvent()},a.moveDivStop=function(e){document.documentElement.removeEventListener("mouseup",a.moveDivStop,!1),a.allowiFrameMouseEvent()},a.blockiFrameMouseEvent=function(){X()("iframe").each(function(e,t){X()(t).addClass("pointerEventsOff")})},a.allowiFrameMouseEvent=function(){X()("iframe").each(function(e,t){X()(t).removeClass("pointerEventsOff")})},a.handleSelectTab=function(e){a.setState({currentKey:e})},a.positionRightBoundsCheck=function(e){return e?X()(document).width()-(a.state.defaultEntityOffset.left+e)-a.state.entityWidthint:X()(document).width()-a.state.defaultEntityOffset.left-a.state.entityWidthint},a.containerHeightAdjust=function(){var e;!0===a.props.fullScreen&&(X()("#list-view-container")[0]?(e=X()(window).height()-X()("#list-view-container").height()-X()("#header").height()-70,e+="px"):(e=X()(window).height()-X()("#header").height()-70,e+="px"),a.state.isMounted&&a.setState({height:e}))},a.render=function(){var e,t=[],n="box react-draggable entityPopUp entityPopUpMaxSizeDefault";(!0===a.props.fullScreen||X()("react-draggable-dragged"))&&(n="box react-draggable entityPopUp"),!0===a.props.fullScreen&&(n+=" height100percent");for(var i=0;i<a.state.tabs.length;i++){var o=i+1,s="tab";s="guide"===a.state.tabs[i].entitytype?"guide":"source"===a.state.tabs[i].entitytype?"source":void 0!==a.state.tabs[i].valueClicked?a.state.tabs[i].valueClicked.slice(0,15):"",t.push(r.a.createElement(tr.a,{className:"tab-content",eventKey:a.state.tabs[i].entityid,title:s},r.a.createElement(wr,{addFlair:a.props.addFlair,data:a.state.tabs[i].data,form:a.props.form,type:a.props.type,id:a.props.id,entityid:a.state.tabs[i].entityid,entitytype:a.state.tabs[i].entitytype,valueClicked:a.state.tabs[i].valueClicked,i:o,key:o,errorToggle:a.props.errorToggle,linkWarningToggle:a.props.linkWarningToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback})))}if(a.state.defaultEntityOffset&&a.state.entityobj){a.positionRightBoundsCheck();e=a.positionRightBoundsCheck(X()(a.state.entityobj).width())<0?a.state.defaultEntityOffset.left-a.state.entityWidthint:a.state.defaultEntityOffset.left+X()(a.state.entityobj).width()}else 50,e=0;return!0===a.props.fullScreen?r.a.createElement("div",{id:"popup-flex-container",style:{height:a.state.height},className:"entity-full-screen"},r.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},r.a.createElement(Zn.a,{className:"tab-content",defaultActiveKey:a.props.entityid,activeKey:a.state.currentKey,onSelect:a.handleSelectTab,bsStyle:"pills",animation:!1},t))):r.a.createElement(br.a,{handle:"#handle",onMouseDown:a.moveDivInit},r.a.createElement("div",{id:"dragme",className:n,style:{width:a.state.entityWidth,left:e,maxHeight:"90vh"}},r.a.createElement("div",{id:"popup-flex-container",style:{height:"100%",display:"flex",flexFlow:"row"}},r.a.createElement("div",{id:"entity_detail_container",style:{flexFlow:"column",display:"flex",width:"100%"}},r.a.createElement("div",{id:"handle",style:{width:"100%",background:"#292929",color:"white",fontWeight:"900",fontSize:"large",textAlign:"center",cursor:"move",flex:"0 1 auto"}},r.a.createElement("div",null,r.a.createElement("span",{className:"pull-left",style:{paddingLeft:"5px"}},r.a.createElement("i",{className:"fa fa-arrows","aria-hidden":"true"})),r.a.createElement("span",{className:"pull-right",style:{cursor:"pointer",paddingRight:"5px"}},r.a.createElement("i",{className:"fa fa-times",style:{color:"red"},onClick:a.props.flairToolbarOff})))),r.a.createElement(Zn.a,{className:"tab-content",defaultActiveKey:a.props.entityid,activeKey:a.state.currentKey,onSelect:a.handleSelectTab,bsStyle:"pills",animation:!1},t)),r.a.createElement("div",{id:"sidebar",onMouseDown:a.initDrag,style:{flex:"0 1 auto",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden",width:"5px"}})),r.a.createElement("div",{id:"footer",onMouseDown:a.initDrag,style:{display:"block",height:"5px",backgroundColor:"black",borderTop:"2px solid black",borderBottom:"2px solid black",cursor:"nwse-resize",overflow:"hidden"}})))};var n="100%",i="700px",o="70vh";return!0===a.props.fullScreen&&(n="95vh",i="95%",o="95vh"),a.state={entityData:null,entityid:a.props.entityid,entityHeight:n,entityWidth:i,entityWidthint:700,entityMaxHeight:o,tabs:[],initialLoad:!1,processedIds:[],valueClicked:"",defaultEntityOffset:a.props.entityoffset,entityobj:a.props.entityobj,height:null,isMounted:!1},a}return Object(d.a)(t,e),t}(r.a.Component),wr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){if("entity"===a.props.entitytype)return r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},r.a.createElement("h4",{id:"myModalLabel"},null!=a.props.data?r.a.createElement(Sr,{value:a.props.valueClicked,data:a.props.data,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair}):r.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading..."))),r.a.createElement("div",{style:{height:"100%",display:"flex",flex:"1 1 auto",marginLeft:"10px",flexFlow:"inherit",minHeight:"1px"}},null!=a.props.data?r.a.createElement(Tr,{data:a.props.data,entityid:a.props.entityid,type:a.props.type,id:a.props.id,errorToggle:a.props.errorToggle,linkWarningToggle:a.props.linkWarningToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair}):r.a.createElement("div",null,"Loading...")));if("guide"===a.props.entitytype){var e="/guide/"+a.props.entityid;return r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}},r.a.createElement(Ae.a,{to:e,target:"_blank"},r.a.createElement("h4",{id:"myModalLabel"},null!=a.props.data?r.a.createElement("span",null,r.a.createElement("span",null,r.a.createElement(Sr,{value:a.props.entityid,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair})),r.a.createElement("div",null,r.a.createElement(Sr,{value:a.props.data.applies_to,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair}))):r.a.createElement("div",{style:{display:"inline-flex",position:"relative"}},"Loading...")))),r.a.createElement("div",{style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=a.props.data?r.a.createElement(Dr,{entityid:a.props.entityid,form:a.props.form,data:a.props.data,entitytype:a.props.entitytype,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair}):r.a.createElement("div",null,"Loading...")))}return"source"===a.props.entitytype?r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),r.a.createElement("div",{id:"source-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=a.props.entitytype?r.a.createElement(Nr,{data:a.props.data,entityid:a.props.entityid,entitytype:a.props.entitytype,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback}):r.a.createElement("div",null,"Loading..."))):"entry"===a.props.entitytype?r.a.createElement("div",{className:"tab-content"},r.a.createElement("div",{style:{flex:"0 1 auto",marginLeft:"10px"}}),r.a.createElement("div",{id:"entry-popup",style:{overflow:"auto",flex:"1 1 auto",marginLeft:"10px"}},null!=a.props.entitytype?r.a.createElement("div",null,r.a.createElement(yr,{entryAction:"Add",type:"alert",targetid:a.props.entityid,id:"add_entry",addedentry:a.entryToggle,errorToggle:a.props.errorToggle}),r.a.createElement(ci,{type:"alert",id:a.props.entityid,isPopUp:1,headerData:a.props.data,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair})):r.a.createElement("div",null,"Loading..."))):void 0},a}return Object(d.a)(t,e),t}(r.a.Component),Sr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){if(void 0!==a.props.data){var e="/entity/"+a.props.data.id;return r.a.createElement("div",{className:"flair_header"},r.a.createElement("div",null,r.a.createElement(Ae.a,{to:e,target:"_blank"},"Entity ",a.props.data.id),r.a.createElement("span",null,"\xa0"),r.a.createElement(Ha,{status:a.props.data.status,id:a.props.data.id,type:"entity",errorToggle:a.props.errorToggle}),r.a.createElement("span",null,"\xa0"),r.a.createElement(Xa,{type:"entity",id:a.props.data.id,string:a.props.value})),r.a.createElement("div",null,r.a.createElement("span",null,a.props.data.type,":"),"\xa0",r.a.createElement("span",null,a.props.value)))}return r.a.createElement("div",{className:"flair_header"},a.props.value)},a}return Object(d.a)(t,e),t}(r.a.Component),Tr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updateAppearances=function(e){if(null!==e&&0!==e){var t=a.state.appearances+e;a.state.isMounted&&a.setState({appearances:t})}},a.entryToggle=function(){!1===a.state.entryToolbar?a.setState({entryToolbar:!0}):a.setState({entryToolbar:!1})},a.showFullEntityButton=function(){"entity"!==a.props.type&&a.setState({showFullEntityButton:!0})},a.linkOnClickIntercept=function(e){a.props.linkWarningToggle(e.target.id)},a.render=function(){var e=[],t=[],n=[],i=4;if(void 0!==a.props.data){var o=a.props.data.data;for(var s in o)void 0!==o[s]&&("geoip"===s?(n.push(r.a.createElement(tr.a,{eventKey:i,className:"entityPopUpButtons",style:{overflow:"auto"},title:s},r.a.createElement(jr,{data:o[s].data,type:a.props.type,id:a.props.id,entityData:a.props.data,errorToggle:a.props.errorToggle}))),i++):"data"===o[s].type?(e.push(r.a.createElement(tr.a,{eventKey:i,className:"entityPopUpButtons",style:{overflow:"auto"},title:s},r.a.createElement(Or,{dataSource:o[s],type:a.props.type,id:a.props.id,errorToggle:a.props.errorToggle}))),i++):"link"===o[s].type&&"Lookup in Likaboss"!==o[s].data.tile&&(t.push(r.a.createElement(Ka.a,{bsSize:"xsmall",target:"_blank",id:o[s].data.url,onMouseDown:a.linkOnClickIntercept},o[s].data.title)),i++))}var l="/entity/"+a.props.entityid;return r.a.createElement(Zn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},r.a.createElement(tr.a,{eventKey:1,className:"entityPopUpButtons",title:a.state.appearances,style:{height:"100%"}},r.a.createElement("div",null,t),r.a.createElement("div",{style:{maxHeight:"30vh",overflowY:"auto"}},r.a.createElement("span",null,r.a.createElement("b",null,"Appears: ",a.state.appearances," times")),!0===a.state.showFullEntityButton?r.a.createElement("span",{style:{paddingLeft:"5px"}},r.a.createElement(Ae.a,{to:l,style:{color:"#c400ff"},target:"_blank"},"List truncated due to large amount of references. Click to view the whole entity")):null,r.a.createElement("br",null),r.a.createElement(xr,{entityid:a.props.entityid,updateAppearances:a.updateAppearances,type:a.props.type,showFullEntityButton:a.showFullEntityButton,errorToggle:a.props.errorToggle}),r.a.createElement("br",null)),r.a.createElement("hr",{style:{marginTop:".5em",marginBottom:".5em"}}),r.a.createElement("div",{style:{maxHeight:"50vh",overflowY:"auto"}},r.a.createElement("div",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:a.entryToggle},"Add Entry"),r.a.createElement("br",null)),a.state.entryToolbar?r.a.createElement(yr,{entryAction:"Add",type:"entity",targetid:a.props.entityid,id:"add_entry",addedentry:a.entryToggle,errorToggle:a.props.errorToggle}):null,r.a.createElement(ci,{type:"entity",addFlair:a.props.addFlair,id:a.props.entityid,isPopUp:1,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback}))),n,e)},a.state={loading:"Loading Entries",entryToolbar:!1,appearances:0,showFullEntityButton:!1,isMounted:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}}]),t}(r.a.Component),jr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).copyToEntry=function(){!1===a.state.copyToEntryToolbar?a.setState({copyToEntryToolbar:!0}):a.setState({copyToEntryToolbar:!1})},a.copyToEntity=function(){!1===a.state.copyToEntityToolbar?a.setState({copyToEntityToolbar:!0}):a.setState({copyToEntityToolbar:!1})},a.state={copyToEntryToolbar:!1,copyToEntityToolbar:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=[],t=[];for(var a in t.push("<table>"),this.props.data){var n=this.props.data[a];e.push(r.a.createElement("tr",null,r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},r.a.createElement("b",null,a)),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px"}},this.props.data[a]))),t.push('<tr><td style={{paddingRight:"4px", paddingLeft:"4px"}}><b>'+a+'</b></td><td style={{paddingRight:"4px", paddingLeft:"4px"}}>'+n+"</td></tr>")}t.push("</table>");var i=t.join("");return r.a.createElement("div",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.copyToEntity},"Copy to ",r.a.createElement("b",null,"entity")," entry"),"alertgroup"!==this.props.type?r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.copyToEntry},"Copy to"," ",r.a.createElement("b",null,this.props.type," ",this.props.id)," ","entry"):null,this.state.copyToEntryToolbar?r.a.createElement(yr,{entryAction:"Copy To Entry",type:this.props.type,targetid:this.props.id,id:this.props.id,addedentry:this.copyToEntry,content:i,errorToggle:this.props.errorToggle}):null,this.state.copyToEntityToolbar?r.a.createElement(yr,{entryAction:"Copy To Entry",type:"entity",targetid:this.props.entityData.id,id:this.props.entityData.id,addedentry:this.copyToEntity,content:i,errorToggle:this.props.errorToggle}):null,r.a.createElement("div",{className:"entityTableWrapper"},r.a.createElement("table",{className:"tablesorter entityTableHorizontal",id:"sortableentitytable",width:"100%"},e)))}}]),t}(r.a.Component),Or=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.dataSource;return r.a.createElement("div",{style:{overflowY:"auto",maxHeight:"70vh"}},r.a.createElement("div",null,r.a.createElement(Xn.a,{data:e,expandLevel:4})))}}]),t}(r.a.Component),xr=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){a.setState({isMounted:!0}),a.alertRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/alert",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"alert",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"alert",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"alert",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataAlertGroup:a,loadingAlerts:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&!1===this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity references for alerts",e)}.bind(Object(p.a)(Object(p.a)(a)))}),a.eventRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/event",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"event",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"event",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"event",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataEvent:a,loadingEvents:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity reference for events",e)}.bind(Object(p.a)(Object(p.a)(a)))}),a.guidesRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/guide",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"guide",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"guide",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"guide",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataIncident:a,loadingIncidents:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&!1===this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity references for guides",e)}.bind(Object(p.a)(Object(p.a)(a)))}),a.incidentRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/incident",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"incident",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"incident",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"incident",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataIncident:a,loadingIncidents:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&!1===this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity references for incidents",e)}.bind(Object(p.a)(Object(p.a)(a)))}),a.intelRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/intel",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"intel",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"intel",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"intel",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataIntel:a,loadingIntel:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&!1===this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity references for intel")}.bind(Object(p.a)(Object(p.a)(a)))}),a.signatureRequest=X.a.ajax({type:"get",url:"scot/api/v2/entity/"+a.props.entityid+"/signature",data:{sort:JSON.stringify({id:-1})},traditional:!0,success:function(e){var t=(e=e.records).length,a=[],n=[],i=[],o=[];this.state.maxRecords&&(t=this.state.maxRecords);for(var s=0;s<t;s++)null!=e[s]&&("promoted"===e[s].status?n.push(r.a.createElement(Cr,{type:"signature",data:e[s],index:s,errorToggle:this.props.errorToggle})):"closed"===e[s].status?i.push(r.a.createElement(Cr,{type:"signature",data:e[s],index:s,errorToggle:this.props.errorToggle})):o.push(r.a.createElement(Cr,{type:"signature",data:e[s],index:s,errorToggle:this.props.errorToggle})));a.push(n),a.push(i),a.push(o),this.state.isMounted&&(e.length>=100&&this.props.showFullEntityButton(),this.props.updateAppearances(e.length),this.setState({entityDataSignature:a,loadingSignature:!1}),!1===this.state.loadingAlerts&&!1===this.state.loadingEvents&&!1===this.state.loadingIncidents&&!1===this.state.loadingIntel&&!1===this.state.loadingSignature&&this.setState({loading:!1}))}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entity references for signature")}.bind(Object(p.a)(Object(p.a)(a)))})},a.componentDidUpdate=function(){},a.componentWillUnmount=function(){a.setState({isMounted:!1})},a.render=function(){var e="sortableentitytable"+a.props.entityid;return r.a.createElement("div",{className:"entityTableWrapper"},a.state.loading?r.a.createElement("span",null,"Loading: ",a.state.loadingAlerts?r.a.createElement("span",null,"Alerts "):null,a.state.loadingEvents?r.a.createElement("span",null,"Events "):null,a.state.loadingIncidents?r.a.createElement("span",null,"Incidents "):null,a.state.loadingIntel?r.a.createElement("span",null,"Intel "):null,a.state.loadingSignature?r.a.createElement("span",null,"Signature "):null):null,r.a.createElement("table",{className:"tablesorter entityTableHorizontal",id:e,width:"100%"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"peek"),r.a.createElement("th",null,"status"),r.a.createElement("th",null,"id"),r.a.createElement("th",null,"type"),r.a.createElement("th",null,"entries"),r.a.createElement("th",null,"subject"),r.a.createElement("th",null,"last updated"))),r.a.createElement("tbody",null,a.state.entityDataSignature,a.state.entityDataIntel,a.state.entityDataIncident,a.state.entityDataEvent,a.state.entityDataAlertGroup)))};var n=100;return"entity"===a.props.type&&(n=void 0),a.state={entityDataAlertGroup:null,entityDataEvent:null,entityDataIncident:null,entityDataIntel:null,entityDataSignature:null,maxRecords:n,loadingAlerts:!0,loadingEvents:!0,loadingIncidents:!0,loadingIntel:!0,loadingSignature:!0,loading:!0,isMounted:!1},a}return Object(d.a)(t,e),t}(r.a.Component),Cr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onClick=function(){X.a.ajax({type:"GET",url:"scot/api/v2/"+a.props.type+"/"+a.props.data.id+"/entry",success:function(e){for(var t=e.records,a=!1,n=0;n<t.length;n++)if("summary"===t[n].class&&(a=!0,this.isMounted)){this.setState({showSummary:!0,summaryData:t[n].body_plain}),X()("#entityTable"+this.props.data.id).qtip({content:{text:t[n].body_plain},style:{classes:"qtip-scot"},hide:"unfocus",position:{my:"top left",at:"right",target:X()("#entitySummaryRow"+this.props.data.id)},show:{ready:!0,event:"click"}});break}!1===a&&X()("#entityTable"+this.props.data.id).qtip({content:{text:"No Summary Found"},style:{classes:"qtip-scot"},hide:"unfocus",position:{my:"top left",at:"right",target:X()("#entitySummaryRow"+this.props.data.id)},show:{ready:!0,event:"click"}})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Summary Query failed for: "+this.props.type+":"+this.props.data.id,e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.state={showSummary:!1,summaryExists:!0},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){this.props.data.id;var e="entityTable"+this.props.data.id,t="entitySummaryRow"+this.props.data.id,a=null,n=null,i=null,o=null,s=this.props.data.subject,l=this.props.data.updated,c="";return i="promoted"===this.props.data.status?"orange":"closed"===this.props.data.status?"green":"open"===this.props.data.status?"red":"black","alert"===this.props.type?(a="/"+this.props.type+"/"+this.props.data.id,n="/#/event/"+this.props.data.promotion_id):"event"===this.props.type?(n="/#/incident/"+this.props.data.promotion_id,a="/"+this.props.type+"/"+this.props.data.id):a="/"+this.props.type+"/"+this.props.data.id,void 0===s&&(s=void 0!==this.props.data.data&&void 0!==this.props.data.data.alert_name?this.props.data.data.alert_name:""),void 0!==l&&(o=Math.floor((Math.round((new Date).getTime()/1e3)-l)/86400),c=new Date(1e3*l).toLocaleString()),r.a.createElement("tr",{id:e},r.a.createElement("td",{style:{textAlign:"center",cursor:"pointer",verticalAlign:"top"},onClick:this.onClick,id:t},r.a.createElement("i",{className:"fa fa-eye fa-1","aria-hidden":"true"})),"promoted"===this.props.data.status?r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"}},r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"warning",id:this.props.data.id,href:n,target:"_blank",style:{lineHeight:"12pt",fontSize:"10pt",marginLeft:"auto"}},this.props.data.status)):r.a.createElement("td",{style:{color:i,paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"}},this.props.data.status),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"}},r.a.createElement(Ae.a,{to:a,target:"_blank"},this.props.data.id)),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"}},this.props.type),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",textAlign:"center",verticalAlign:"top"}},this.props.data.entry_count),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"}},s),r.a.createElement("td",{style:{paddingRight:"4px",paddingLeft:"4px",verticalAlign:"top"},title:c},o," days ago"))}}]),t}(r.a.Component),Dr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).entryToggle=function(){!1===a.state.entryToolbar?a.setState({entryToolbar:!0}):a.setState({entryToolbar:!1})},a.state={entryToolbar:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement(Zn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"pills"},r.a.createElement(tr.a,{eventKey:1,style:{overflow:"auto",maxHeight:"70vh"}},r.a.createElement("div",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.entryToggle},"Add Entry"),r.a.createElement("br",null)),this.state.entryToolbar?r.a.createElement(yr,{entryAction:"Add",type:"guide",targetid:this.props.entityid,id:"add_entry",addedentry:this.entryToggle,errorToggle:this.props.errorToggle}):null,r.a.createElement(ci,{addFlair:this.props.addFlair,type:"guide",form:this.props.form,id:this.props.entityid,isPopUp:1,headerData:this.props.data,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback})))}}]),t}(r.a.Component),Nr=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Source"),r.a.createElement(Zn.a,{className:"tab-content",defaultActiveKey:1,bsStyle:"tabs"},r.a.createElement(tr.a,{eventKey:1,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Rendered"},r.a.createElement(Er.a,{style:{width:"100%"},head:r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",height:"500px"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body}}))),r.a.createElement(tr.a,{eventKey:2,className:"entityPopUpButtons",style:{overflow:"auto",maxHeight:"70vh"},title:"Raw Text"},r.a.createElement(Er.a,{head:r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),style:{width:"100%"},frameBorder:"0",id:"iframe_"+this.props.entityid,sandbox:"allow-same-origin",styleSheets:["/css/sandbox.css"],height:"500px"},">",r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data.body_plain}})))))}}]),t}(r.a.Component),Ar=a(489),_r=a.n(Ar),Mr=a(495),Lr=a(13),Ir=a(56).Link,Pr=[],Rr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){var e=ue("whoami");e&&a.setState({whoami:e}),X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#not_saved_entry_"+a.props.id).position().top)},a.render=function(){var e="not_saved_entry_"+a.props.id;return r.a.createElement("div",{id:e},r.a.createElement("div",{className:"row-fluid entry-outer",style:{border:"3px solid blue",marginLeft:"auto",marginRight:"auto",width:"99.3%"}},r.a.createElement("div",{className:"row-fluid entry-header"},r.a.createElement("div",{className:"entry-header-inner"},"[",r.a.createElement(Ir,{style:{color:"black"},to:"not_saved_0"},"Not_Saved_0"),"]by ",a.state.whoami,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},r.a.createElement(Lr,{bsSize:"xsmall",onClick:a.submit},"Submit"),r.a.createElement(Lr,{bsSize:"xsmall",onClick:a.onCancel},"Cancel")))),r.a.createElement(Mr.a,{onDrop:a.onDrop,style:{"border-width":"2px","border-color":"#000","border-radius":"4px","border-style":"dashed","text-align":"center","background-color":"azure"}},r.a.createElement("div",{style:{fontSize:"16px",color:"black",margin:"5px"}},"Click or Drop files here to upload")),a.state.files?r.a.createElement("div",null," ",a.state.files.map(function(e){return r.a.createElement("ul",{style:{"list-style-type":"none",margin:"0",padding:"0"}},r.a.createElement("li",null,r.a.createElement("p",{style:{display:"inline"}},e.name),r.a.createElement("button",{style:{"line-height":"1px"},className:"btn btn-info",id:e.name,onClick:this.Close},"x")))}.bind(Object(p.a)(Object(p.a)(a))))):null))},a.onCancel=function(){Pr=[],a.props.fileUploadToggle()},a.Close=function(e){for(var t=0;t<Pr.length;t++)e.target.id===Pr[t].name&&Pr.splice(t,1);a.setState({files:Pr})},a.onDrop=function(e){for(var t=0;t<e.length;t++)Pr.push(e[t]);a.setState({files:Pr})},a.submit=function(){if(Pr.length>0)for(var e=0;e<Pr.length;e++){var t=new FormData;t.append("upload",Pr[e]),t.append("target_type",a.props.type),t.append("target_id",Number(a.props.targetid)),null!=a.props.entryid&&t.append("entry_id",a.props.entryid);var n=new XMLHttpRequest;n.addEventListener("progress",a.uploadProgress),n.addEventListener("load",a.uploadComplete),n.addEventListener("error",a.uploadFailed),n.addEventListener("abord",a.uploadCancelled),n.open("POST","/scot/api/v2/file"),n.send(t)}else alert("Select a file to upload before submitting.")},a.uploadComplete=function(){a.onCancel()},a.uploadFailed=function(){a.props.errorToggle("An error occured. Upload failed.")},a.uploadProgress=function(){},a.uploadCancelled=function(){},a.state={files:[],edit:!1,stagecolor:"#000",enable:!0,addentry:!0,saved:!0,enablesave:!0,whoami:void 0},a}return Object(d.a)(t,e),t}(r.a.Component),Fr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).toggle=function(){var e;1===a.props.summary?e="entry":0===a.props.summary&&(e="summary");var t={class:e};X.a.ajax({type:"put",url:"scot/api/v2/entry/"+a.props.entryid,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make summary",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){var e,t="Summary Loading...";return 0===a.props.summary?(t="Make Summary",e=a.toggle):1===a.props.summary&&(t="Remove Summary",e=a.toggle),r.a.createElement("span",{style:{display:"block"},onClick:e},t)},a.state={key:a.props.id},a}return Object(d.a)(t,e),t}(r.a.Component),Ur=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){var e=ue("whoami");a.setState({whoami:e})},a.makeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+a.props.entryid,data:JSON.stringify({make_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.closeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+a.props.entryid,data:JSON.stringify({close_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to close task",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.takeTask=function(){X.a.ajax({type:"put",url:"scot/api/v2/entry/"+a.props.entryid,data:JSON.stringify({take_task:1}),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e)},error:function(e){this.props.errorToggle("Failed to make Task owner",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){var e,t="Task Loading...";return"task"===a.props.taskData.class?void 0===a.props.taskData.metadata.task.status||null===a.props.taskData.metadata.task.status||"task"!==a.props.taskData.class?(t="Make Task",e=a.makeTask):a.state.whoami!==a.props.taskData.metadata.task.who&&"open"===a.props.taskData.metadata.task.status?(t="Assign task to me",e=a.takeTask):a.state.whoami===a.props.taskData.metadata.task.who&&"open"===a.props.taskData.metadata.task.status?(t="Close Task",e=a.closeTask):"closed"===a.props.taskData.metadata.task.status||"completed"===a.props.taskData.metadata.task.status?(t="Reopen Task",e=a.makeTask):a.state.whoami===a.props.taskData.metadata.task.who&&"assigned"===a.props.taskData.metadata.task.status?(t="Close Task",e=a.closeTask):a.state.whoami!==a.props.taskData.metadata.task.who&&"assigned"===a.props.taskData.metadata.task.status&&(t="Assign task to me",e=a.takeTask):(t="Make Task",e=a.makeTask),r.a.createElement("span",{style:{display:"block"},onClick:e},t)},a.state={whoami:void 0},a}return Object(d.a)(t,e),t}(r.a.Component),Hr={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Wr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).proceed=function(){window.open(a.props.link,"_blank").opener=null,a.props.linkWarningToggle()},a.componentWillMount=function(){var e=window.location.href,t=new RegExp(/((https?|ftp):\/\/[a-zA-Z0-9\-_\.]+\.)?([a-zA-Z0-9\-_\.]+\.([a-zA-Z]{1,63}))/,"i"),n=a.props.link.match(t),r=e.match(t);void 0!=n&&void 0!=r?n[3]===r[3]&&a.proceed():void 0==n&&a.proceed()},a.render=function(){return r.a.createElement("div",null,r.a.createElement(fn.a,{isOpen:!0,onRequestClose:a.props.linkWarningToggle,style:Hr},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"/images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:a.props.linkWarningToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Browse to site?")),r.a.createElement("div",{className:"modal-body"},"The link you clicked may take you to a site outside SCOT. If this is a link an attacker controls you may be tipping your hand.",r.a.createElement("br",null),r.a.createElement("b",null,a.props.link)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(Ka.a,{id:"cancel-delete",onClick:a.props.linkWarningToggle},"Cancel"),r.a.createElement(Ka.a,{bsStyle:"info",id:"proceed",onClick:a.proceed},"Proceed"))))},a}return Object(d.a)(t,e),t}(r.a.Component),Br=(a(289),a(306)),Vr=a.n(Br),zr=(a(977),a(978),a(979),a(980),a(981),a(982),a(983),a(984),a(985),a(986),a(988),a(989),a(990),a(991),a(992),a(993),a(994),a(995),a(996),a(997),a(998),a(999),a(1e3),a(1001),a(1002),a(1003),a(1004),a(1005),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onChange=function(e){a.setState({value:e})},a.submitSigBody=function(e){var t="scot/api/v2/sigbody/";a.state.viewVersionid;"put"==a.state.ajaxType&&(t="scot/api/v2/sigbody/"+a.state.viewSigBodyid),X.a.ajax({type:a.state.ajaxType,url:t,data:JSON.stringify({signature_id:parseInt(a.props.id),body:a.state.value}),contentType:"application/json; charset=UTF-8",success:function(e){var t;console.log("successfully changed signature data"),t=void 0==e.revision?this.state.viewVersionid:e.revision,this.setState({readOnly:!0,cursorEnabledDisabled:"cursorDisabled",ajaxType:null,viewVersionid:t,viewSigBodyid:e.id})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to create/update sigbody",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.componentWillReceiveProps=function(e){a.setState({signatureData:e.headerData})},a.editSigBody=function(e){a.setState({readOnly:!1,lastViewVersionid:a.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"put"})},a.createNewSigBody=function(){a.setState({readOnly:!1,viewVersionid:null,lastViewVersionid:a.state.viewVersionid,value:"",cursorEnabledDisabled:"cursorEnabled",ajaxType:"post"})},a.createNewSigBodyFromSig=function(){a.setState({readOnly:!1,lastViewVersionid:a.state.viewVersionid,cursorEnabledDisabled:"cursorEnabled",ajaxType:"post",viewVersionid:null})},a.Cancel=function(){var e="";0!==Object.keys(a.state.signatureData.version).length&&void 0!=a.state.signatureData.version[a.state.signatureData.prod_sigbody_id]&&(e=a.state.signatureData.version[a.state.lastViewVersionid].body),a.setState({readOnly:!0,value:e,viewVersionid:a.state.lastViewVersionid,cursorEnabledDisabled:"cursorDisabled",ajaxType:null})},a.viewSigBody=function(e){!0===a.state.readOnly&&a.setState({value:a.state.signatureData.version[e.target.id].body,viewVersionid:e.target.id,viewSigBodyid:e.target.viewSigBodyid})},a.keyboardHandlerUpdate=function(e){Lt("signatureKeyboardHandler",e.target.text,1e3),a.setState({currentKeyboardHandler:e.target.text})},a.languageModeUpdate=function(e){Lt("signatureLanguageMode",e.target.text,1e3),a.setState({currentLanguageMode:e.target.text})},a.editorThemeUpdate=function(e){Lt("signatureEditorTheme",e.target.text,1e3),a.setState({currentEditorTheme:e.target.text})};var n=new Date;n=n.getTime();var r,i="",o="none",d="java",u="github",h=a.props.headerData.prod_sigbody_id;if(void 0!=At("signatureKeyboardHandler")&&(o=At("signatureKeyboardHandler")),void 0!=At("signatureLanguageMode")&&(d=At("signatureLanguageMode")),void 0!=At("signatureEditorTheme")&&(u=At("signatureEditorTheme")),0!==Object.keys(a.props.headerData.version).length)if(void 0!=a.props.headerData.version[a.props.headerData.prod_sigbody_id]||0==a.props.headerData.version[a.props.headerData.prod_sigbody_id])i=a.props.headerData.version[a.props.headerData.prod_sigbody_id].body,r=a.props.headerData.version[a.props.headerData.prod_sigbody_id].id;else for(var m in a.props.headerData.version)m<h||(h=m,i=a.props.headerData.version[m].body,r=a.props.headerData.version[m].id);return a.state={readOnly:!0,value:i,signatureData:a.props.headerData,loaded:!0,viewSigBodyid:r,viewVersionid:h,lastViewVersionid:null,key:n,cursorEnabledDisabled:"cursorDisabled",keyboardHandlers:["none","vim","emacs"],currentKeyboardHandler:o,languageModes:["bro","csharp","c_cpp","html","javascript","java","json","markdown","mysql","perl","powershell","python","ruby","sass","xml","yaml"],currentLanguageMode:d,editorThemes:["github","monokai","kuroir","solarized_dark","solarized_light","terminal","textmate","tomorrow","twilight","xcode"],currentEditorTheme:u,ajaxType:null},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=[],t=[],a=[],n=[],i="not_saved_signature_entry_"+this.state.key,o=this.state.currentKeyboardHandler,s=[],l=0;if(0!==Object.keys(this.state.signatureData).length&&0!==Object.keys(this.state.signatureData.version).length)for(var c in this.state.signatureData.version){var d=this.state.signatureData.version[c].revision,p=this.state.signatureData.version[c].revision,u=this.state.signatureData.version[c].id;this.state.signatureData.prod_sigbody_id==d?p=d+" - Production":this.state.signatureData.qual_sigbody_id==d&&(p=d+" - Quality");var h=void 0;h=1!=this.state.readOnly,e.push(r.a.createElement(k.a,{id:d,key:d,onClick:this.viewSigBody,eventKey:d,viewSigBodyid:u,bsSize:"xsmall",disabled:h},p)),d>l&&(l=d)}if(void 0!=this.state.keyboardHandlers)for(var m=0;m<this.state.keyboardHandlers.length;m++)t.push(r.a.createElement(k.a,{id:m,key:m,onClick:this.keyboardHandlerUpdate,eventKey:m,bsSize:"xsmall"},this.state.keyboardHandlers[m]));if("none"==this.state.currentKeyboardHandler&&(o=null),void 0!=this.state.languageModes)for(var g=0;g<this.state.languageModes.length;g++)a.push(r.a.createElement(k.a,{id:g,key:g,onClick:this.languageModeUpdate,eventKey:g,bsSize:"xsmall"},this.state.languageModes[g]));if(void 0!=this.state.editorThemes)for(var y=0;y<this.state.editorThemes.length;y++)n.push(r.a.createElement(k.a,{id:y,key:y,onClick:this.editorThemeUpdate,eventKey:y,bsSize:"xsmall"},this.state.editorThemes[y]));return this.state.signatureData.prod_sigbody_id==this.state.viewVersionid?s.push(r.a.createElement("span",{className:"signature_production_color"},this.state.viewVersionid," - Production")):this.state.signatureData.qual_sigbody_id==this.state.viewVersionid?s.push(r.a.createElement("span",{className:"signature_quality_color"},this.state.viewVersionid," - Quality")):s.push(r.a.createElement("span",null,this.state.viewVersionid)),r.a.createElement("div",{id:"signatureDetail",className:"signatureDetail"},this.state.loaded?r.a.createElement("div",null,r.a.createElement(qr,{signatureData:this.state.signatureData,type:this.props.type,id:this.props.id,currentLanguageMode:this.state.currentLanguageMode,currentEditorTheme:this.state.currentEditorTheme,currentKeyboardHandlerApplied:o,errorToggle:this.props.errorToggle,showSignatureOptions:this.props.showSignatureOptions}),r.a.createElement("div",{id:i,className:"not_saved_signature_entry"},r.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",{className:"row-fluid signature-entry-header"},r.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Body: ",s,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},"Editor Theme:",r.a.createElement(Cn.a,{bsSize:"xsmall",title:this.state.currentEditorTheme,id:"bg-nested-dropdown",style:{marginRight:"10px"}},n),"Language Handler:",r.a.createElement(Cn.a,{bsSize:"xsmall",title:this.state.currentLanguageMode,id:"bg-nested-dropdown",style:{marginRight:"10px"}},a),"Keyboard Handler:",r.a.createElement(Cn.a,{bsSize:"xsmall",title:this.state.currentKeyboardHandler,id:"bg-nested-dropdown",style:{marginRight:"10px"}},t),"Signature Body Version:",r.a.createElement(Cn.a,{bsSize:"xsmall",title:s,id:"bg-nested-dropdown",style:{marginRight:"10px"}},e),this.state.readOnly?r.a.createElement("span",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.createNewSigBody,bsStyle:"success"},"Create new version"),0!=this.state.viewVersionid?r.a.createElement("span",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.createNewSigBodyFromSig},"Create new version using this base"),r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.editSigBody},"Update displayed version")):null):r.a.createElement("span",null,r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.submitSigBody},"Submit"),r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:this.Cancel},"Cancel"))))),r.a.createElement(Vr.a,{mode:this.state.currentLanguageMode,theme:this.state.currentEditorTheme,onChange:this.onChange,name:"signatureEditor",editorProps:{$blockScrolling:!0},keyboardHandler:o,value:this.state.value,width:"100%",maxLines:50,minLines:10,readOnly:this.state.readOnly,className:this.state.cursorEnabledDisabled,showPrintMargin:!1})))):r.a.createElement("div",null,"Loading Signature Data..."))}}]),t}(r.a.Component)),qr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).submitMetaData=function(e){var t=e.target.id,n=e.target.value;if("options"==t||"target"==t){try{n=JSON.parse(n)}catch(o){return void a.props.errorToggle("Failed to convert string to object. Try adding quotation marks around the key and values")}var r=typeof n;if("object"!==r)return void a.props.errorToggle("options need to be an object but were detected as: "+r)}var i={};i[t]=n,X.a.ajax({type:"put",url:"scot/api/v2/signature/"+a.props.id,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(e){console.log("successfully changed signature data")}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to update signature metadata",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.onOptionsChange=function(e){a.setState({optionsValue:e})},a.state={optionsValue:JSON.stringify(a.props.signatureData.options)},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.showSignatureOptions?r.a.createElement("div",{id:"signatureTable2",className:"signatureTableOptions"},r.a.createElement("div",{className:"row-fluid signature-entry-outer",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",{className:"row-fluid signature-entry-header"},r.a.createElement("div",{className:"signature-entry-header-inner"},"Signature Options",r.a.createElement(Ka.a,{type:"submit",bsSize:"xsmall",bsStyle:"success",onClick:this.submitMetaData,id:"options",value:this.state.optionsValue},"Apply"))),r.a.createElement(Vr.a,{mode:"json",theme:this.props.currentEditorTheme,onChange:this.onOptionsChange,name:"signatureEditorOptions",editorProps:{$blockScrolling:!0},keyboardHandler:this.props.currentKeyboardHandlerApplied,value:this.state.optionsValue,minLines:10,maxLines:25,width:"100%",readOnly:!1,showPrintMargin:!1}))):null)}}]),t}(r.a.Component),Kr=(r.a.Component,a(486)),Gr=a.n(Kr),Jr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={suggestions:[],value:""},a.HandleAdd=a.HandleAdd.bind(Object(p.a)(Object(p.a)(a))),a.HandleInputChange=a.HandleInputChange.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.value&&this.setState({value:this.props.value})}},{key:"HandleAdd",value:function(e){this.setState({value:e}),this.props.OnChange(e)}},{key:"HandleInputChange",value:function(e){if(this.props.OnChange(e.target.value),this.setState({value:e.target.value}),e.target&&e.target.value.length>=1){var t=[];X.a.ajax({type:"get",url:"/scot/api/v2/ac/"+this.props.type+"/"+e.target.value,success:function(e){e=e.records;for(var a=0;a<e.length;a++)if("string"===typeof e[a]){var n={};n.label=e[a],t.push(n)}this.setState({suggestions:t})}.bind(this),error:function(){console.log("failed to get autocomplete data")}})}}},{key:"render",value:function(){return r.a.createElement("div",{className:"AutoCompleteInput"},r.a.createElement(Gr.a,{getItemValue:function(e){return e.label},items:this.state.suggestions,renderItem:function(e,t){return r.a.createElement("div",{style:{background:t?"lightgray":"white"}},e.label)},value:this.state.value,onChange:this.HandleInputChange,onSelect:this.HandleAdd,menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",overflow:"auto",maxHeight:"200px",top:"unset",left:"unset",position:"absolute"},inputProps:{style:{width:"100%"}},wrapperProps:{style:{width:"300px"}}}))}}]),t}(n.Component),Yr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).HasSpacesCheck=function(e){!0===/\s/g.test(e)?a.setState({multiword:"yes"}):a.setState({multiword:"no"})},a.GetCount=function(){a.setState({countLoading:!0});var e=encodeURIComponent(a.state.match);X.a.ajax({type:"get",url:"/scot/api/v2/hitsearch?match="+e,success:function(e){this.setState({count:e.count,countLoading:!1})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.setState({count:"unable to get count",countLoading:!1})}.bind(Object(p.a)(Object(p.a)(a)))})},a.Confirmation=function(){!1===a.state.confirmation?(a.GetCount(),a.setState({confirmation:!0})):a.setState({confirmation:!1,value:""})},a.Submit=function(){var e={value:a.state.value,match:a.state.match,status:"active",options:{multiword:a.state.multiword}};X.a.ajax({type:"POST",url:"/scot/api/v2/entitytype",data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.props.ToggleCreateEntity()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){e.responseJSON.error_msg?this.props.errorToggle("failed to create user defined entity: error_message: "+e.responseJSON.error_msg,e):this.props.errorToggle("failed to create user defined entity",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.OnChangeMatch=function(e){a.setState({match:e.target.value}),a.HasSpacesCheck(e.target.value)},a.OnChangeValue=function(e){a.setState({value:e})},a.state={value:"",match:"",userdef:!0,status:"tracked",multiword:"yes",confirmation:!1,countLoading:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.match&&this.setState({match:this.props.match}),this.mounted=!0}},{key:"componentDidMount",value:function(){this.HasSpacesCheck(this.props.match)}},{key:"componentWillUnmount",value:function(){X()(document).unbind("keypress"),this.mounted=!1}},{key:"render",value:function(){return r.a.createElement(q.a,{dialogClassName:"entity-create-modal",show:this.props.modalActive,onHide:this.props.ToggleCreateEntity},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,this.state.confirmation?r.a.createElement("span",null,"Confirm and submit user defined entity"):r.a.createElement("span",null,"Create a user defined entity"))),r.a.createElement(q.a.Body,null,this.state.confirmation?r.a.createElement("span",null,r.a.createElement("div",null,"Entity Name: ",r.a.createElement("b",null,this.state.match)),r.a.createElement("div",null,"Entity Type: ",r.a.createElement("b",null,this.state.value)),r.a.createElement("div",null,"Multiword: ",r.a.createElement("b",null,this.state.multiword))):r.a.createElement("span",null,r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("span",{style:{width:"150px"}},r.a.createElement("b",null,"New Entity Name:")),r.a.createElement("span",{style:{width:"300px"}},r.a.createElement("input",{type:"tag",onChange:this.OnChangeMatch,value:this.state.match,style:{width:"100%"}}))),r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("span",{style:{width:"150px"}},r.a.createElement("b",null,"Entity Type:")),r.a.createElement("span",null,r.a.createElement(Jr,{type:"entitytype",OnChange:this.OnChangeValue,value:this.state.value}))))),r.a.createElement(q.a.Footer,null,this.state.confirmation?r.a.createElement("span",null,r.a.createElement("span",{style:{color:"red",float:"left"}},this.state.countLoading?r.a.createElement("span",null,"Count: is loading..."):r.a.createElement("span",null,"Count: ",this.state.count)),r.a.createElement("span",null,r.a.createElement(W.a,{onClick:this.Submit,bsStyle:"success"},"Submit"),r.a.createElement(W.a,{onClick:this.Confirmation},"Go Back"))):r.a.createElement("span",null,this.state.value.length>=1&&this.state.match.length>=1?r.a.createElement(W.a,{onClick:this.Confirmation,bsStyle:"primary",type:"submit",active:!0},"Continue"):null,r.a.createElement(W.a,{onClick:this.props.ToggleCreateEntity},"Cancel"))))}}]),t}(n.Component),Qr=a(487),Xr=a.n(Qr),$r=a(1114),Zr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){var t=e.target.id,n=e.target.value,r={};r["data."+t]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data"),this.forceUpdate()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.headerData!==e.headerData}},{key:"render",value:function(){var e=[],t=[],a=[],n=[],i=[],o=[],s=[],l=this.props.form[this.props.headerData.data_fmt_ver];if(l)for(var c=0;c<l.length;c++){var d=l[c].value,p=l[c].value_type.url;switch(p&&(p=p.replace("%s",this.props.id)),l[c].value_type.key.split(".").reduce(function(e,t){return e[t]},this.props.headerData.data)&&(d=l[c].value_type.key.split(".").reduce(function(e,t){return e[t]},this.props.headerData.data)),l[c].type){case"dropdown":"static"==l[c].value_type.type?t.push(r.a.createElement(ei,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,value:d,dropdownValues:l[c].value,help:l[c].help})):t.push(r.a.createElement(ei,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help}));break;case"input":"static"==l[c].value_type.type?n.push(r.a.createElement(ti,{onBlur:this.onChange,value:d,id:l[c].key,label:l[c].label,help:l[c].help})):n.push(r.a.createElement(ti,{onBlur:this.onChange,id:l[c].key,label:l[c].label,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help}));break;case"calendar":if("static"==l[c].value_type.type){var u=1e3*d;a.push(r.a.createElement(ai,{typeTitle:l[c].label,value:u,typeLower:l[c].key,type:this.props.type,id:this.props.id,help:l[c].help}))}else a.push(r.a.createElement(ai,{typeTitle:l[c].label,typeLower:l[c].key,type:this.props.type,id:this.props.id,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"textarea":"static"==l[c].value_type.type?i.push(r.a.createElement(ni,{id:l[c].key,value:d,onBlur:this.onChange,label:l[c].label,help:l[c].help})):i.push(r.a.createElement(ni,{id:l[c].key,onBlur:this.onChange,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"input_multi":"static"==l[c].value_type.type?o.push(r.a.createElement(ri,{id:l[c].key,value:d,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:l[c].label,help:l[c].help})):o.push(r.a.createElement(ri,{id:l[c].key,errorToggle:this.props.errorToggle,mainType:this.props.type,mainId:this.props.id,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"boolean":"static"==l[c].value_type.type?s.push(r.a.createElement(ii,{id:l[c].key,value:d,onChange:this.onChange,label:l[c].label,help:l[c].help})):s.push(r.a.createElement(ii,{id:l[c].key,onChange:this.onChange,label:l[c].label,fetchURL:p,dynamic:!0,referenceKey:l[c].value_type.key,help:l[c].help}));break;case"multi_select":"static"==l[c].value_type.type?e.push(r.a.createElement(oi,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,value:d,dropdownValues:l[c].value,help:l[c].help,mainType:this.props.type,mainId:this.props.id})):e.push(r.a.createElement(oi,{onChange:this.onChange,label:l[c].label,id:l[c].key,referenceKey:l[c].value_type.key,fetchURL:p,dynamic:!0,help:l[c].help,mainType:this.props.type,mainId:this.props.id}))}}return r.a.createElement("div",null,l?r.a.createElement("div",{className:"custom-metadata-table container"},r.a.createElement("div",{className:"row"},t,a,n,i,o,s,e)):null)}}]),t}(r.a.Component),ei=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t=[],a="",n=this.props.referenceKey;if("qual_sigbody_id"==n||"prod_sigbody_id"==n)for(var i in t.push(r.a.createElement("option",null,"0")),e.version)e.version[i].revision==e.data[n]&&(a=e.data[n]),t.push(r.a.createElement("option",null,e.version[i].revision));else for(var o=0;o<e[this.props.referenceKey].length;o++)1==e[this.props.referenceKey][o].selected&&(a=e[this.props.referenceKey][o].value),t.push(r.a.createElement("option",null,e[this.props.referenceKey][o].value));this.setState({selected:a,options:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.onChange=function(e){a.props.onChange(e),a.setState({selected:e.target.value})},a.state={selected:null,options:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){if(this.props.dynamic)this.getDynamic();else{for(var e=[],t="",a=0;a<this.props.dropdownValues.length;a++)this.props.value==this.props.dropdownValues[a].value&&(t=this.props.value),e.push(r.a.createElement("option",null,this.props.dropdownValues[a].value));this.setState({selected:t,options:e})}}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({selected:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("select",{id:this.props.id,value:this.state.selected,onChange:this.onChange},this.state.options)),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),ti=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t;t=e[this.props.referenceKey],this.setState({value:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.inputOnChange=function(e){a.setState({value:e.target.value})},a.state={value:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value})),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),ai=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t=1e3*e[this.props.referenceKey];this.setState({value:t,loading:!1})}.bind(Object(p.a)(Object(p.a)(a)))})},a.onChange=function(e){var t="data."+a.props.typeLower,n=e._d.getTime()/1e3,r={};r[t]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("successfully changed custom table data")}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to updated custom table data",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.showCalendar=function(){0==a.state.showCalendar?a.setState({showCalendar:!0}):a.setState({showCalendar:!1})};var n=!1;return a.props.dynamic&&(n=!0),a.state={showCalendar:!1,loading:n,value:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div",style:{display:"flex",flexFlow:"row"}},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.typeTitle),this.state.loading?r.a.createElement("span",null,"Loading..."):r.a.createElement(Xr.a,{className:"custom-metadata-input-width",value:this.state.value,onChange:this.onChange}),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.help},bsClass:"popover helpPopup"}))},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),ni=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.inputOnChange=function(e){a.setState({value:e.target.value})},a.state={value:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))),r.a.createElement("span",null,r.a.createElement("textarea",{id:this.props.id,onBlur:this.props.onBlur,onChange:this.inputOnChange,value:this.state.value,className:"custom-metadata-textarea-width"})))}}]),t}(r.a.Component),ri=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.handleAddition=function(e){if(void 0!==a.state.value){for(var t=[],n=a.state.value,r=0;r<n.length;r++)void 0!=n[r]&&("string"==typeof n[r]?t.push(n[r]):t.push(n[r].value));t.push(e.target.value);var i={},o="data."+a.props.id;i[o]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.mainType+"/"+a.props.mainId,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: group added"),this.setState({inputValue:"",value:i[this.props.id]})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to add group",e)}.bind(Object(p.a)(Object(p.a)(a)))})}},a.InputChange=function(e){a.setState({inputValue:e.target.value})},a.handleDelete=function(e){for(var t=a.state.value,n=e.target.id,r=[],i=0;i<t.length;i++)void 0!=t[i]&&("string"==typeof t[i]?t[i]!=n&&r.push(t[i]):t[i].value!=n&&r.push(t[i].value));var o={data:Object(ze.a)({},a.props.id,r)};X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.mainType+"/"+a.props.mainId,data:JSON.stringify(o),contentType:"application/json; charset=UTF-8",success:function(e){this.setState({value:o[this.props.id]}),console.log("deleted group success: "+e)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to delete group",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.state={inputValue:"",value:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.dynamic?this.getDynamic():this.setState({value:e.value})}},{key:"render",value:function(){var e,t=this.state.value,a=[];if(void 0!==t)for(var n=0;n<t.length;n++)"string"==typeof t[n]?e=t[n]:"object"==typeof t[n]&&void 0!=t[n]&&(e=t[n].value),a.push(r.a.createElement("span",{id:"event_signature",className:"tagButton"},e," ",r.a.createElement("i",{id:e,onClick:this.handleDelete,className:"fa fa-times tagButtonClose"})));return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{className:"custom-metadata-input-width",id:this.props.id,onChange:this.InputChange,value:this.state.inputValue}),""!=this.state.inputValue?r.a.createElement(W.a,{bsSize:"xsmall",bsStyle:"success",onClick:this.handleAddition,value:this.state.inputValue},"Submit"):r.a.createElement(W.a,{bsSize:"xsmall",bsType:"submit",disabled:!0},"Submit")),r.a.createElement("span",{className:"custom-metadata-multi-input-tags"},a),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),ii=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){var t=e[this.props.referenceKey];this.setState({value:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.componentWillReceiveProps=function(e){e.dynamic?a.getDynamic():a.setState({value:e.value})},a.onChange=function(e){var t;t="true"==e.target.value?1:0;var n={target:{}};n.target.id=a.props.id,n.target.value=t,a.props.onChange(n)},a.state={value:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.setState({value:this.props.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement("input",{type:"checkbox",className:"custom-metadata-input-width",id:this.props.id,name:this.props.id,value:this.state.value,onClick:this.onChange})),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),oi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).makeForm=function(e){var t=a.props;e&&(t=e);for(var n=[],i=0;i<t.dropdownValues.length;i++)t.value.includes(t.dropdownValues[i].value)?n.push(r.a.createElement("option",{selected:!0},t.dropdownValues[i].value)):n.push(r.a.createElement("option",null,t.dropdownValues[i].value));a.setState({options:n})},a.getDynamic=function(){X.a.ajax({type:"get",url:a.props.fetchURL,success:function(e){for(var t=[],a=0;a<e[this.props.referenceKey].length;a++)1==e[this.props.referenceKey][a].selected?t.push(r.a.createElement("option",{selected:!0},e[this.props.referenceKey][a].value)):t.push(r.a.createElement("option",null,e[this.props.referenceKey][a].value));this.setState({options:t})}.bind(Object(p.a)(Object(p.a)(a)))})},a.componentWillReceiveProps=function(e){e.dynamic?a.getDynamic():a.makeForm(e)},a.onChange=function(e){for(var t=[],n=0;n<e.target.options.length;n++)if(void 0!=e.target.options[n]){if(1!=e.target.options[n].selected)continue;t.push(e.target.options[n].value)}var r={};r["data."+a.props.id]=t,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.mainType+"/"+a.props.mainId,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",success:function(){console.log("success: multi select added")}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to add multi select",e)}.bind(Object(p.a)(Object(p.a)(a)))}),a.setState({selected:e.target.value})},a.state={options:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.props.dynamic?this.getDynamic():this.makeForm()}},{key:"render",value:function(){return r.a.createElement("div",{className:"custom-metadata-table-component-div"},r.a.createElement("span",{className:"custom-metadata-tableWidth"},this.props.label),r.a.createElement("span",null,r.a.createElement($r.a,{id:this.props.id,componentClass:"select",placeholder:"select",bsClass:"custom-metadata-multi-select-width",multiple:!0,onChange:this.onChange,size:this.state.options.length},this.state.options)),r.a.createElement("span",null,r.a.createElement(Xt.a,{placement:"top",overlay:r.a.createElement(Qa.a,{id:this.props.id}," ",this.props.help)},r.a.createElement("i",{className:"fa fa-question-circle-o","aria-hidden":"true",style:{paddingLeft:"5px"}}))))}}]),t}(r.a.Component),si=a(488);var li=function(e){var t=Object(si.a)({},e),a=Object(n.useState)(!0),i=Object(Qt.a)(a,2),o=i[0],s=i[1];function l(){s(!o),t.updated()}return r.a.createElement("div",null,o?null:r.a.createElement("div",{style:{justifyContent:"center",padding:5,display:"flex"}},r.a.createElement("br",null),r.a.createElement(da.a,{style:{backgroundColor:"#5bc0de",color:"white"},onClick:l,variant:"contained"},"Add Entry"),r.a.createElement("br",null)),o?r.a.createElement(yr,{entryAction:"Add",type:"alert",targetid:t.row.id,id:"add_entry",addedentry:s,errorToggle:t.errorToggle,toggleVisibility:l}):null,t.entryData.length>0?r.a.createElement(ci,{entryData:t.entryData,type:"alert",id:t.row.id,showEntryData:t.showEntryData,errorToggle:t.errorToggle,createCallback:t.createCallback,removeCallback:t.removeCallback,entityData:t.entityData,addFlair:t.addFlair}):null)},ci=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).getEntryData=function(){var e=a.props,t=e.type,n=e.id;(a.setState({isMounted:!0}),"alert"===t||"entity"===t||1===a.props.isPopUp)&&ma("scot/api/v2/".concat(t,"/").concat(n,"/entry"),null).then(function(e){this.state.isMounted&&(this.setState({showEntryData:!0,entryData:e.data.records}),e.data.records.forEach(function(t,a){this.props.createCallback(e.data.records[a].id,this.updatedCB)}.bind(this)),this.Watcher())}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){this.state.isMounted&&(this.setState({showEntryData:!0}),this.props.errorToggle("Failed to load entry data.",e))}.bind(Object(p.a)(Object(p.a)(a))))},a.getEntityData=function(){var e=a.props,t=e.addFlair,n=e.type,r=e.id;"alert"!==n&&"entity"!==n&&"incident"!==n&&"alertgroup"!==n&&1!==a.props.isPopUp||ma("scot/api/v2/".concat(n,"/").concat(r,"/entity"),null).then(function(e){var a=e.data.records;if(this.state.isMounted){this.setState({showEntityData:!0,entityData:a});var i={waitEntry:function(){!1===this.state.showEntryData?setTimeout(i.waitEntry,50):setTimeout(function(){t(a,null,n,null,r)}.bind(this))}.bind(this)};i.waitEntry()}}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){this.state.isMounted&&(this.setState({showEntityData:!0}),this.props.errorToggle("Failed to load entity data.",e))}.bind(Object(p.a)(Object(p.a)(a))))},a.updatedCB=function(){a.getEntityData(),a.getEntryData()},a.flairToolbarToggle=function(e,t,n,r,i){a.state.isMounted&&a.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:n,entityoffset:r,entityobj:i})},a.flairToolbarOff=function(){if(a.state.isMounted){var e=a.state.entityDetailKey+1;a.setState({flairToolbar:!1,entityDetailKey:e})}},a.linkWarningToggle=function(e){a.state.isMounted&&(!1===a.state.linkWarningToolbar?a.setState({linkWarningToolbar:!0,link:e}):a.setState({linkWarningToolbar:!1}))},a.Watcher=function(){var e=a.props.type+"-detail-container";if("alertgroup"!=a.props.type){document.querySelectorAll("iframe").forEach(function(e,t){e.contentWindow.requestAnimationFrame(function(){if(null!=e.contentDocument){[].push(this.checkFlairHover),e.addEventListener("mouseenter",function(t,a){var n=setInterval(this[0],50,e);console.log("Now watching iframe "+n)}),e.addEventListener("mouseleave",function(){var t=X()(e).data("intervalID");window.clearInterval(t),console.log("No longer watching iframe "+t)})}}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))))}else X()(e).find("a, .entity").not(".not_selectable").each(function(e,t){X()(t).off("mousedown"),X()(t).on("mousedown",function(e){var t=e.target;if("extras"==X()(t)[0].className&&(t=X()(t)[0].parentNode),X()(t).attr("url")){var a=X()(t).attr("url");this.linkWarningToggle(a)}else{var n=X()(t).attr("data-entity-id"),r=X()(t).attr("data-entity-value"),i=X()(t).offset(),o=X()(t);this.flairToolbarToggle(n,r,"entity",i,o)}}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))))},a.checkFlairHover=function(e){"alertgroup"!=a.props.type&&(null!=e.contentDocument&&X()(e).contents().find(".entity").each(function(t,a){if("rgb(255, 0, 0)"==X()(a).css("background-color"))X()(a).data("state","down");else if("down"==X()(a).data("state")){X()(a).data("state","up");var n=X()(a).attr("data-entity-id"),r=X()(a).attr("data-entity-value"),i=X()(a),o=e,s={top:X()(a).offset().top+X()(o).offset().top,left:X()(a).offset().left+X()(o).offset().left};this.flairToolbarToggle(n,r,"entity",s,i)}}.bind(Object(p.a)(Object(p.a)(a)))),null!=e.contentDocument&&X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==X()(t).css("color"))X()(t).data("state","down");else if("down"==X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.linkWarningToggle(a)}}.bind(Object(p.a)(Object(p.a)(a)))))},a.containerHeightAdjust=function(){setTimeout(function(){var e,t=document.getElementsByClassName("ReactTable")[0].clientHeight;void 0!==t&&(0!==t?(e=X()(window).height()-t-X()("#header").height()-78,e+="px"):(e=X()(window).height()-X()("#header").height()-78,e+="px"),this.state.isMounted&&this.setState({height:e}))}.bind(Object(p.a)(Object(p.a)(a))),500)},a.render=function(){var e="detail-container",t=a.state.height,n=a.props.entryData,i=a.props.type,o=a.props.id,s=a.props.showEntryData,l="row-fluid entry-wrapper entry-wrapper-main";return"alert"===i?(l="row-fluid entry-wrapper entry-wrapper-main-nh",n=a.state.entryData,s=a.state.showEntryData):"alertgroup"===i?l="row-fluid alert-wrapper entry-wrapper-main":"entity"!==i&&1!==a.props.isPopUp||(l="row-fluid entry-wrapper-entity",n=a.state.entryData,s=a.state.showEntryData),"alert"!==i&&1!==a.props.isPopUp||(e=a.props.type+"-detail-container",t=null),r.a.createElement("div",{id:e,key:o,className:l,style:{height:t}},"entity"!==i&&"alert"!==i?r.a.createElement(Zr,{type:i,id:o,errorToggle:a.props.errorToggle,form:a.props.form,headerData:a.props.headerData}):null,"signature"===i&&null!==a.props.headerData?r.a.createElement(zr,{type:i,id:o,headerData:a.props.headerData,errorToggle:a.props.errorToggle,showSignatureOptions:a.props.showSignatureOptions}):null,s?r.a.createElement(di,Object.assign({updated:a.updatedCB,removeCallback:a.props.removeCallback,createCallback:a.props.createCallback,data:n,type:i,id:o,entityData:a.state.entityData,entryToggle:a.props.entryToggle,subcomponent:a.props.subcomponent,setAlertColumns:a.props.setAlertColumns},a.props)):r.a.createElement("span",null,"Loading..."),a.props.entryToolbar?r.a.createElement("div",null,r.a.createElement(yr,{entryAction:"Add",type:a.props.type,targetid:a.props.id,id:null,addedentry:a.props.entryToggle,updated:a.updatedCB,errorToggle:a.props.errorToggle})):null,a.props.fileUploadToolbar?r.a.createElement("div",null,r.a.createElement(Rr,{type:a.props.type,targetid:a.props.id,id:"file_upload",fileUploadToggle:a.props.fileUploadToggle,updated:a.updatedCB,errorToggle:a.props.errorToggle})):null,a.state.flairToolbar?r.a.createElement(kr,{key:a.state.entityDetailKey,flairToolbarToggle:a.flairToolbarToggle,flairToolbarOff:a.flairToolbarOff,entityid:a.state.entityid,entityvalue:a.state.entityvalue,entitytype:a.state.entitytype,type:a.props.type,id:a.props.id,entityoffset:a.state.entityoffset,entityobj:a.state.entityobj,linkWarningToggle:a.linkWarningToggle,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair}):null,a.state.linkWarningToolbar?r.a.createElement(Wr,{linkWarningToggle:a.linkWarningToggle,link:a.state.link}):null)};var n=Math.floor(1e3*Math.random());return a.state={showEntryData:a.props.showEntryData,showEntityData:a.props.showEntityData,entryData:a.props.entryData,entityData:a.props.entityData,entityid:null,entitytype:null,entityoffset:null,entityobj:null,key:a.props.id,flairToolbar:!1,notificationType:null,notificationMessage:"",height:null,entityDetailKey:n,isMounted:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.getEntryData(),this.getEntityData(),this.props.createCallback(this.props.id,this.updatedCB),this.containerHeightAdjust(),window.addEventListener("resize",this.containerHeightAdjust),document.querySelector(".ReactTable").onresize=function(){this.containerHeightAdjust()}.bind(this)}},{key:"componentWillReceiveProps",value:function(){this.containerHeightAdjust()}},{key:"componentDidUpdate",value:function(){1==this.state.runWatcher&&this.Watcher()}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1})}}]),t}(r.a.Component),di=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=[],t=a.props.data,n=a.props.type,i=a.props.items,o=[],s=a.props.id,l=a.props.entityData;if(void 0!==a.props.items){void 0===a.props.items[0].data_with_flair||a.props.flairOff?i[0].data.search:i[0].data_with_flair.search;for(var c=0;c<a.props.headerData.ahrefs.length;c++)o.push(r.a.createElement("a",{href:a.props.headerData.ahrefs[c].link},a.props.headerData.ahrefs[c].subject)),o.push(r.a.createElement("br",null))}if(void 0===t||void 0===t[0])return"alertgroup"!==n?r.a.createElement("div",null,r.a.createElement("div",{style:{color:"blue"}},"No entries found. Click the green Add Entry button if you would like to create one")):r.a.createElement("div",null,r.a.createElement("div",{style:{color:"blue"}},"No alerts found or they are unable to be rendered. Please check the source and correct the formatting of the alert if necessary"));if("alertgroup"!==n){var d=0;return t.forEach(function(t){e.push(r.a.createElement(hi,{subcomponent:this.props.subcomponent,key:d,items:t,type:n,id:s,isPopUp:this.props.isPopUp,errorToggle:this.props.errorToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,entityData:l,entryToggle:this.props.entryToggle})),d+=1}.bind(Object(p.a)(Object(p.a)(a)))),r.a.createElement("div",null,e)}return r.a.createElement("div",null,r.a.createElement(pi,Object.assign({subcomponent:a.props.subcomponent},a.props,{key:s,type:n,id:s,items:t,entityData:l,entryToggle:a.props.entryToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,addFlair:a.props.addFlair,setAlertColumns:a.props.setAlertColumns,updated:a.props.updated})))},a}return Object(d.a)(t,e),t}(r.a.Component),pi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).createData=function(){var e=[];return a.props.items.forEach(function(t){var a={};(a=this.state.flairOff||0===Object.entries(t.data_with_flair).length?t.data:t.data_with_flair).id=t.id,a.status=t.status,a.entry_count=t.entry_count,e.push(a)}.bind(Object(p.a)(Object(p.a)(a)))),e},a.state={columns:[],data:[],entityData:[],type:"",addFlair:null,promotionId:null,selected:[],flairOff:!1,expanded:{}},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){if(this.props.items.length>0){var e=this.createData(),t=Da("alert",e,this.props.items,!0);this.setState({data:e,columns:t})}this.props.type&&this.setState({type:this.props.type,entityData:this.props.entityData}),this.props.addFlair&&this.setState({addFlair:this.props.addFlair}),this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected}),X()("#main-detail-container").keydown(function(e){X()("input").is(":focus")||65!==e.keyCode||!0!==e.ctrlKey&&!0!==e.metaKey||(this.handleSelectAll(),e.preventDefault())}.bind(this))}},{key:"componentDidUpdate",value:function(e,t){if(e.entityData!==this.props.entityData&&this.setState({entityData:this.props.entityData,columns:Da("alert",this.state.data,this.props.items,!0,this.props.entityData)}),t.flairOff!==this.state.flairOff){var a=this.createData();this.setState({data:a})}if(e.items!==this.props.items){var n=this.createData();this.setState({data:n})}this.props.alertsSelected!==t.selected&&void 0!==this.props.alertsSelected&&this.setState({selected:this.props.alertsSelected})}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.columns,i=this.props,o=i.addFlair,s=i.type,l=(i.headerData,i.entityData);i.updated;return r.a.createElement("div",null,r.a.createElement(Yt.a,{styleName:"styles.ReactTable",ref:function(t){return e.reactTable=t},key:2,data:a,columns:n,filterable:!0,expanded:this.state.expanded,onExpandedChange:function(t,a,n){e.setState({expanded:t}),o(l,null,"entry",null,null)},defaultFilterMethod:function(e,t){if(t[e.id].includes(e.value))return t},SubComponent:function(t){var a,n=t.row;return r.a.createElement(li,(a={flag:e.props.subcomponent,row:n,entryToggle:e.props.entryToggle,errorToggle:e.props.errorToggle,entryData:e.props.entryData,showEntryData:e.props.showEntryData},Object(ze.a)(a,"errorToggle",e.props.errorToggle),Object(ze.a)(a,"createCallback",e.props.createCallback),Object(ze.a)(a,"removeCallback",e.props.removeCallback),Object(ze.a)(a,"entityData",e.props.entityData),Object(ze.a)(a,"addFlair",e.props.addFlair),Object(ze.a)(a,"updated",e.props.updated),a))},onFilteredChange:function(e,t){o(l,null,s,null,null)},onSortedChange:function(e,t,a){o(l,null,s,null,null)},showPagination:!1,pageSize:a.length,getTdProps:function(e,t){return{style:{maxWidth:"fit-content"}}},getTrProps:function(t,a){return a&&a.row&&void 0!==e.props.alertsSelected?{onClick:function(n){(n.ctrlKey||n.metaKey&&83===n.keyCode)&&e.props.handleSelectAll(t.sortedData),n.ctrlKey||n.metaKey?(n.preventDefault(),e.props.handleMultiSelection(a.original)):n.shiftKey?(document.getSelection().removeAllRanges(),e.props.handleShiftSelect(e.state.selected[0].id,a.original.id,t.sortedData)):e.props.handleSelection(a.original)},style:{background:e.state.selected.some(function(e){return a.original.id===e.id})?"#a7c6a5":"",borderBottom:"1px solid black",maxHeight:200,overflowY:"auto"}}:{style:{maxHeight:200,overflowY:"auto"}}}}),r.a.createElement(ui,{items:this.props.items,flairOff:this.props.flairOff,headerData:this.props.headerData}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.flairOff!==t.flairOff?{flairOff:e.flairOff}:e.alertsSelected!==t.selected?{selected:e.alertsSelected}:null}}]),t}(r.a.Component),ui=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).call(this,e))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=null,a=this.props.items;t=void 0===a[0].data_with_flair||this.props.flairOff?a[0].data.search:a[0].data_with_flair.search;var n=this.props.headerData.ahrefs.map(function(t,a){return r.a.createElement("div",{key:a},r.a.createElement("a",{href:e.props.headerData.ahrefs[a].link},e.props.headerData.ahrefs[a].subject),r.a.createElement("br",null))});return r.a.createElement("div",null,void 0!==t?r.a.createElement("div",{className:"alertTableHorizontal",style:{outline:"1px solid black",borderRadius:5,padding:3,margin:"10px 0 15px"}},n,r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})):null)}}]),t}(r.a.Component),hi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentDidMount=function(){a.props.createCallback(a.props.items.id,a.refreshButton)},a.refreshButton=function(){X()("#refresh-detail")&&X()("#refresh-detail").click()},a.editEntryToggle=function(){!1===a.state.editEntryToolbar?a.setState({editEntryToolbar:!0}):a.setState({editEntryToolbar:!1})},a.replyEntryToggle=function(){!1===a.state.replyEntryToolbar?a.setState({replyEntryToolbar:!0}):a.setState({replyEntryToolbar:!1})},a.deleteToggle=function(){!1===a.state.deleteToolbar?a.setState({deleteToolbar:!0}):a.setState({deleteToolbar:!1})},a.permissionsToggle=function(){!1===a.state.permissionsToolbar?a.setState({permissionsToolbar:!0}):a.setState({permissionsToolbar:!1})},a.reparseFlair=function(){fa("/scot/api/v2/entry/".concat(a.props.items.id)).then(function(e){console.log("reparsing started")}).catch(function(e){this.props.errorToggle("failed to start reparsing of data",e)}.bind(Object(p.a)(Object(p.a)(a))))},a.fileUploadToggle=function(){!1===a.state.fileUploadToolbar?a.setState({fileUploadToolbar:!0}):a.setState({fileUploadToolbar:!1})},a.render=function(){var e=[],n=[],i=a.props.items,o=a.props.type,s=a.props.id,l=a.props.isPopUp,c=a.props.items.class,d=0,u=a.state.editEntryToolbar,h=a.editEntryToggle,m=a.props.errorToggle,g="row-fluid entry-outer",y="row-fluid entry-header",f="";for(var b in"summary"===c&&(g+=" summary_entry",d=1),"task"===c&&("open"===i.metadata.task.status||"assigned"===i.metadata.task.status?(f="-- Task Owner "+i.metadata.task.who+" ",g+=" todo_open_outer",y+=" todo_open"):"closed"!==i.metadata.task.status&&"completed"!==i.metadata.task.status||null==i.metadata.task.who?"closed"!==i.metadata.task.status&&"completed"!==i.metadata.task.status||(g+=" todo_undefined_outer",y+=" todo_undefined"):(f="-- Task Owner "+i.metadata.task.who+" ",g+=" todo_completed_outer",y+=" todo_completed")),"alert"===c&&(g+=" event_entry_container_alert"),e.push(r.a.createElement(gi,{id:i.id,key:i.id,subitem:i,type:o,targetid:s,editEntryToolbar:u,editEntryToggle:h,isPopUp:l,errorToggle:a.props.errorToggle})),i){!function(e){"children"===e&&(i[e],i[e].forEach(function(e){n.push(new Array(r.a.createElement(t,{items:e,id:s,type:o,editEntryToolbar:u,editEntryToggle:h,isPopUp:l,errorToggle:m,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback})))}.bind(Object(p.a)(Object(p.a)(a)))))}(b)}e.push(n);var v=[];if(a.props.items&&a.props.items.actions)for(var E=0;E<a.props.items.actions.length;E++)a.props.items.actions[E].send_to_name&&a.props.items.actions[E].send_to_url&&v.push(r.a.createElement(mi,{id:a.props.items.actions[E].send_to_name,datahref:a.props.items.actions[E].send_to_url,errorToggle:a.props.errorToggle}));var w,S,T="["+i.id+"] ",j=" by "+i.owner+" "+f+"(updated on ",O=i.created,x=i.updated,C="entry-header-inner-"+a.props.id+" entry-header-inner";return"unset"!==i.tlp&&(w="3px solid "+(S="amber"!==i.tlp?i.tlp:"orange")),r.a.createElement("div",null,a.state.showEntityCreateModal?r.a.createElement(Yr,{match:a.state.highlightedText,modalActive:a.state.showEntityCreateModal,ToggleCreateEntity:a.ToggleCreateEntity,errorToggle:a.props.errorToggle,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback}):null,r.a.createElement("div",{className:g,style:{marginLeft:"auto",marginRight:"auto",width:"99.3%",border:w}},r.a.createElement("span",{className:"anchor",id:"/"+o+"/"+s+"/"+i.id}),r.a.createElement("div",{className:y},r.a.createElement("div",{id:C,className:C},"[",r.a.createElement(Ae.a,{style:{color:"black"},to:"/"+o+"/"+s+"/"+i.id},i.id),"]"," ",r.a.createElement(Ba.a,{value:1e3*i.created,format:"MM/DD/YYYY hh:mm:ss a"})," ","by ",i.owner," ",f,"(updated on"," ",r.a.createElement(Ba.a,{value:1e3*i.updated,format:"MM/DD/YYYY hh:mm:ss a"}),")",""!==a.state.highlightedText&&null!=a.state.highlightedText?r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:a.ToggleCreateEntity},"Create Entity"):null,""!==a.props.items.body_flair&&0===a.props.items.parsed?r.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ","Entry awaiting flair engine. Content may be inaccurate."):null,r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",paddingRight:"3px"}},a.state.permissionsToolbar?r.a.createElement(Gn,{updateid:s,id:i.id,type:"entry",permissionData:i,permissionsToggle:a.permissionsToggle}):null,"unset"!==i.tlp&&void 0!==i.tlp?r.a.createElement("span",null,"TLP:"," ",r.a.createElement("span",{style:{color:S}},i.tlp," ")):null,r.a.createElement(_r.a,{bsSize:"xsmall",title:"Reply",key:i.id,id:"Reply "+i.id,onClick:a.replyEntryToggle,pullRight:!0},"entity"!==o?r.a.createElement(k.a,{eventKey:"1",onClick:a.fileUploadToggle},"Upload File"):null,v,r.a.createElement(k.a,{eventKey:"3"},r.a.createElement(Fr,{type:o,id:s,entryid:i.id,summary:d,errorToggle:a.props.errorToggle})),r.a.createElement(k.a,{eventKey:"4"},r.a.createElement(Ur,{type:o,id:s,entryid:i.id,taskData:i,errorToggle:a.props.errorToggle})),r.a.createElement(Xa,{type:"entry",id:i.id,string:i.body_plain}),r.a.createElement(k.a,{onClick:a.permissionsToggle},"Permissions"),r.a.createElement(k.a,{onClick:a.reparseFlair},"Reparse Flair"),r.a.createElement(hn,{type:"entry",id:i.id,tlp:i.tlp,errorToggle:a.props.errorToggle}),r.a.createElement(k.a,{divider:!0}),r.a.createElement(k.a,{eventKey:"2",onClick:a.deleteToggle},"Delete")),r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:a.editEntryToggle},"Edit")))),e,a.state.replyEntryToolbar?r.a.createElement(yr,{entryAction:"Reply",type:o,header1:T,header2:j,header3:")",createdTime:O,updatedTime:x,targetid:s,id:i.id,addedentry:a.replyEntryToggle,errorToggle:a.props.errorToggle}):null,a.state.fileUploadToolbar?r.a.createElement(Rr,{type:a.props.type,targetid:a.props.id,entryid:a.props.items.id,fileUploadToggle:a.fileUploadToggle,errorToggle:a.props.errorToggle}):null),a.state.deleteToolbar?r.a.createElement(wn,{type:o,id:s,deleteToggle:a.deleteToggle,entryid:i.id,errorToggle:a.props.errorToggle}):null)},a.componentWillReceiveProps=function(){a.checkHighlight()},a.checkHighlight=function(){var e,t=document.getElementById("iframe_"+a.props.items.id);if(t){if(null===t.contentWindow.getSelection())return;if(e=t.contentWindow.getSelection().toString(),a.state.highlightedText===e)return;console.log(t+" has highlighted text: "+e),a.setState({highlightedText:e})}},a.ToggleCreateEntity=function(){a.setState({showEntityCreateModal:!a.state.showEntityCreateModal})},a.state={editEntryToolbar:!1,replyEntryToolbar:!1,deleteToolbar:!1,permissionsToolbar:!1,fileUploadToolbar:!1,showEntityCreateModal:!1,highlightedText:null,items:{}},a}return Object(d.a)(t,e),t}(r.a.Component),mi=function(e){function t(e){var a,n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).submit=function(){var e=n.props.datahref,t=n.props.id;(function(e,t){return ya.apply(this,arguments)})(e,null).then(function(e){var a;this.setState((a={},Object(ze.a)(a,t,!0),Object(ze.a)(a,"disabled",!1),a))}.bind(Object(p.a)(Object(p.a)(n)))).catch(function(e){this.props.errorToggle("failed to submit the entry action",e),this.setState({disabled:!1})}.bind(Object(p.a)(Object(p.a)(n))))},n.render=function(){return r.a.createElement(k.a,{disabled:n.state.disabled},r.a.createElement("span",{id:n.props.id,"data-href":n.props.datahref,onClick:n.submit,style:{display:"block"}},n.props.id," ",n.state[n.props.id]?r.a.createElement("span",{style:{color:"green"}},"success"):null))},n.state=(a={},Object(ze.a)(a,n.props.id,!1),Object(ze.a)(a,"disabled",!1),a),n}return Object(d.a)(t,e),t}(r.a.Component),gi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).setHeight=function(){setTimeout(function(){void 0!=document.getElementById("iframe_"+this.props.id)&&document.getElementById("iframe_"+this.props.id).contentWindow.requestAnimationFrame(function(){var e;e=(e=document.getElementById("iframe_"+this.props.id).contentWindow.document.body.scrollHeight)+35+"px",this.state.height!=e&&this.setState({height:e})}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))),250)},a.state={height:"1px"},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillReceiveProps",value:function(){this.setHeight()}},{key:"componentDidMount",value:function(){this.setHeight()}},{key:"render",value:function(){var e=this.props.subitem.body_flair;""==this.props.subitem.body_flair&&(e=this.props.subitem.body);var t=this.props.id,a="entry-body-"+this.props.id,n="entry-body-inner-"+this.props.id;return r.a.createElement("div",{id:a,key:this.props.id,className:"row-fluid entry-body"},r.a.createElement("div",{id:n,className:"row-fluid entry-body-inner",style:{marginLeft:"auto",marginRight:"auto",width:"99.3%"}},this.props.editEntryToolbar?r.a.createElement(yr,{entryAction:"Edit",type:this.props.type,targetid:this.props.targetid,id:t,addedentry:this.props.editEntryToggle,parent:this.props.subitem.parent,errorToggle:this.props.errorToggle}):r.a.createElement(Er.a,{key:t,contentDidMount:this.setHeight,head:r.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"/css/sandbox.css"}),frameBorder:"0",id:"iframe_"+t,sandbox:"allow-same-origin",style:{width:"100%",height:this.state.height}},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))))}}]),t}(r.a.Component),yi=a(167),fi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).toggleBadgeEntry=function(e){0==a.state[e]?a.setState(Object(ze.a)({},e,!0)):1==a.state[e]&&a.setState(Object(ze.a)({},e,!1))},a.state={source:!1,tag:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=[],a=this.props.id,n=this.props.type,i=this.props.data,o="";if("tag"===this.props.badgeType?o="Tags":"source"===this.props.badgeType&&(o="Sources"),"guide"==this.props.type)return r.a.createElement("th",null);if(void 0!=i)for(var s=0;s<i.length;s++)t.push(r.a.createElement(bi,{data:i,badgeType:this.props.badgeType,dataOne:i[s],id:a,type:n,updated:this.props.updated,key:s,errorToggle:this.props.errorToggle}));return r.a.createElement("th",null,r.a.createElement("th",null,o,":"),r.a.createElement("td",null,t,this.state.source?r.a.createElement(vi,{data:i,type:n,id:a,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,this.state.tag?r.a.createElement(vi,{data:i,type:n,id:a,badgeType:this.props.badgeType,toggleBadgeEntry:this.toggleBadgeEntry,updated:this.props.updated,errorToggle:this.props.errorToggle}):null,"tag"===this.props.badgeType?this.state.tag?r.a.createElement("span",{className:"add-tag-button"},r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):r.a.createElement("span",{className:"remove-tag-button"},r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):"source"===this.props.badgeType?this.state.source?r.a.createElement("span",{className:"add-source-button"},r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"danger",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-minus","aria-hidden":"true"}))):r.a.createElement("span",{className:"remove-source-button"},r.a.createElement(Ka.a,{bsSize:"xsmall",bsStyle:"success",onClick:function(){e.toggleBadgeEntry(e.props.badgeType)}},r.a.createElement("span",{className:"glyphicon glyphicon-plus","aria-hidden":"true"}))):null))}}]),t}(r.a.Component),bi=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).badgeDelete=function(){for(var e=a.props.badgeType,t=a.props.data,n=[],r=0;r<t.length;r++)void 0!=t[r]&&("string"==typeof t[r]?t[r]!=a.props.dataOne&&n.push(t[r]):t[r].value!=a.props.dataOne.value&&n.push(t[r].value));var i={};i[e]=n,X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",success:function(e){console.log("deleted"+this.props.badgeType+" data")}.bind(Object(p.a)(Object(p.a)(a))),error:function(t){this.props.errorToggle("Failed to delete"+e+", data ")}.bind(Object(p.a)(Object(p.a)(a)))})},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e,t=this.props.dataOne;return"string"==typeof t?e=t:"object"==typeof t&&void 0!=t&&(e=t.value),"tag"===this.props.badgeType?r.a.createElement("span",{id:"event_tag",className:"tagButton"},e," ",r.a.createElement("span",{className:"tagButtonClose"},r.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):"source"===this.props.badgeType?r.a.createElement("span",{id:"event_source",className:"sourceButton"},e," ",r.a.createElement("span",{className:"sourceButtonClose"},r.a.createElement("i",{onClick:this.badgeDelete,className:"fa fa-times"}))):null}}]),t}(r.a.Component),vi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleAddition=function(e){var t=a.props.badgeType,n=a.props.data.map(function(e){return"string"===typeof e?e:e.value});if(n.includes(e.text))a.props.errorToggle(a.props.badgeType+" already exists");else{n.push(e.text);var r={};r[t]=n,fa("scot/api/v2/".concat(a.props.type,"/").concat(a.props.id),r).then(function(e){this.props.toggleBadgeEntry()}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){this.props.errorToggle("Failed to add "+this.props.badgeType+" data "),this.props.toggleBadgeEntry()}.bind(Object(p.a)(Object(p.a)(a))))}},a.handleSuggestionOrTagConversion=function(e){return e.map(function(e){var t={};return t.id=e,t.text=e,t})},a.handleInputChange=function(e){if(e.length>0){var t=[],n=a.props.badgeType;ma("/scot/api/v2/ac/".concat(n,"/").concat(e),null).then(function(e){t=e.data.records.map(function(e){return e}),this.setState({suggestions:t})}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){this.props.errorToggle("Failed to get autocomplete data for tag",e)}.bind(Object(p.a)(Object(p.a)(a))))}},a.state={suggestions:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.state.suggestions;return e=this.handleSuggestionOrTagConversion(e),r.a.createElement("span",{className:"tag-new"},r.a.createElement(yi.WithContext,{suggestions:e,handleAddition:this.handleAddition,handleInputChange:this.handleInputChange,tags:[]}))}}]),t}(r.a.Component),Ei=a(143),ki=a.n(Ei);function wi(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;var a=e.toPrecision(2).split("e"),n=1===a.length?0:Math.floor(Math.min(a[1].slice(1),14)/3),r=n<1?e.toFixed(0+t):(e/Math.pow(10,3*n)).toFixed(1+t);return(r<0?r:Math.abs(r))+["","K","M","B","T"][n]}var Si={entityUpdate:function(e,t,a,n,r,i){setTimeout(function(){var t={};for(var n in e)t[X()("<span />",{html:n}).html()]=e[n];"alertgroup"!==a?X()("iframe").each(function(e,a){a.contentWindow.requestAnimationFrame(function(){if(null!=a.contentDocument){var e=X()(a).contents();X()(a.contentDocument.body).find("a").attr("target","_blank"),e.find("a").each(function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)}),e.find(".entity").each(function(e,a){if(null==X()(a).find(".extras")[0]){var n=X()("<span />",{html:X()(a).attr("data-entity-value")}).html();if(void 0!==n&&void 0!==t){var r=t;if(void 0!==(r=void 0!==r[n.toLowerCase()]?r[n.toLowerCase()]:r[n])){var i=r.id,o=wi(parseInt(r.count,10),0),s=r.data,l=r.entry,c=X()('<span class="noselect">');if(c.addClass("circleNumber"),c.addClass("extras"),c.text(o),X()(a).append(c),X()(a).attr("data-entity-id",i),X()(a).unbind("click"),void 0!==s){if(void 0!==s.geoip&&void 0!==s.geoip.data.isocode){var d;d="Sandia National Laboratories"===s.geoip.data.isp?"sandia":s.geoip.data.isocode;var p=X()('<img title="'+d.toLowerCase()+'">').attr("src","/images/flags/"+d.toLowerCase()+".png");p.addClass("extras"),X()(a).append(p)}void 0!==s.sidd&&void 0!==s.sidd.data.blocklist&&void 0!==s.sidd.data.blocklist.action&&(!1!==s.sidd.data.blocklist.action.firewall&&X()(a).append(X()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),!1!==s.sidd.data.blocklist.action.watch&&X()(a).append(X()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),!1!==s.sidd.data.blocklist.action.whitelist&&X()(a).append(X()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),!1!==s.sidd.data.blocklist.action.blackhole&&X()(a).append(X()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),!1!==s.sidd.data.blocklist.action.proxy_block&&X()(a).append(X()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png")))}if(void 0!==l&&0!==l){var u=r.entries[0].body_plain;X()(a).append(X()('<img class="extras" title="'+u+'">').attr("src","/images/flair/note.png"))}}}}})}})}.bind(this)):"alertgroup"===a&&X()(document.body).find(".alertTableHorizontal").find(".entity").each(function(e,a){if(null==X()(a).find(".extras")[0]){var n=X()(document.body).find(".alertTableHorizontal");n.find("a").attr("target","_blank"),n.find("a").find(".entity").wrap("<a href='about:blank' target='targ'></a>"),n.find("a").each(function(e,t){var a=X()(t).attr("href");X()(t).attr("url",a)});var r=X()("<span />",{html:X()(a).attr("data-entity-value")}).html();if(void 0!==r&&void 0!==t){var i=t;if(void 0!==(i=void 0!==i[r.toLowerCase()]?i[r.toLowerCase()]:i[r])){var o=i.id,s=wi(i.count),l=i.data,c=i.entry,d=X()('<span class="noselect">');if(d.addClass("circleNumber"),d.addClass("extras"),d.text(s),X()(a).append(d),X()(a).attr("data-entity-id",o),X()(a).unbind("click"),void 0!==l){if(void 0!==l.geoip&&void 0!==l.geoip.data.isocode){var p;p="Sandia National Laboratories"===l.geoip.data.isp?"sandia":l.geoip.data.isocode;var u=X()('<img title="'+p.toLowerCase()+'">').attr("src","/images/flags/"+p.toLowerCase()+".png");u.addClass("extras"),X()(a).append(u)}void 0!==l.sidd&&void 0!==l.sidd.data.blocklist&&void 0!==l.sidd.data.blocklist.action&&(!1!==l.sidd.data.blocklist.action.firewall&&X()(a).append(X()('<img class="extras" title="firewall block">').attr("src","/images/flair/firewalled.png")),!1!==l.sidd.data.blocklist.action.watch&&X()(a).append(X()('<img class="extras" title="watch list">').attr("src","/images/flair/watch.png")),!1!==l.sidd.data.blocklist.action.whitelist&&X()(a).append(X()('<img class="extras" title="white list">').attr("src","/images/flair/white_list.jpg")),!1!==l.sidd.data.blocklist.action.blackhole&&X()(a).append(X()('<img class="extras" title="dns black hole">').attr("src","/images/flair/blackholed.png")),!1!==l.sidd.data.blocklist.action.proxy_block&&X()(a).append(X()('<img class="extras" title="proxy block">').attr("src","/images/flair/blocked.png")))}if(void 0!==c&&0!==c){var h=i.entries[0].body_plain;X()(a).append(X()('<img class="extras" title="'+h+'">').attr("src","/images/flair/note.png"))}}}}}),void 0!==i&&null!==i&&i()}.bind(this),1e3)}},Ti=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={data:[],allSelected:!1,loading:!1},a.getLinks=a.getLinks.bind(Object(p.a)(Object(p.a)(a))),a.handleTHeadCheckboxSelection=a.handleTHeadCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleRowSelection=a.handleRowSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleCheckboxSelection=a.handleCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.getLinks(),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"links-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"links-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Context",accessor:"context",minWidth:100,maxWidth:800,sortable:!0},{Header:"Memo",accessor:"memo",minWidth:100,maxWidth:800,sortable:!0},{Header:"Link ID",accessor:"linkid",maxWidth:100,sortable:!0}];return r.a.createElement(q.a,{dialogClassName:"links-modal",show:this.props.modalActive,onHide:this.props.linksModalToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,this.state.data.length," items linked to ",this.props.type," ",this.props.id)),r.a.createElement(q.a.Body,null,r.a.createElement(Yt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items Linked.",loading:this.state.loading,style:{maxHeight:"60vh"},filterable:!0})),r.a.createElement(q.a.Footer,null,r.a.createElement(ji,{data:this.state.data,id:this.props.id,type:this.props.type,getLinks:this.getLinks,errorToggle:this.props.errorToggle})))}},{key:"getLinks",value:function(){this.setState({loading:!0}),X.a.ajax({type:"get",url:"/scot/api/v2/"+this.props.type+"/"+this.props.id+"/link",success:function(e){for(var t=[],a=0;a<e.records.length;a++){var n={};n.linkid=e.records[a].id,n.context=e.records[a].context;for(var r=0;r<e.records[a].vertices.length;r++)if(e.records[a].vertices[r].id===this.props.id){if(e.records[a].vertices[r].type===this.props.type)continue;n.id=e.records[a].vertices[r].id,n.type=e.records[a].vertices[r].type,n.memo=e.records[a].memo[r],t.push(n)}else n.id=e.records[a].vertices[r].id,n.type=e.records[a].vertices[r].type,n.memo=e.records[a].memo[r],t.push(n)}this.setState({data:t,loading:!1})}.bind(this),error:function(e){this.setState({loading:!1}),this.props.errorToggle("failed to get links",e)}.bind(this)})}},{key:"handleRowSelection",value:function(e,t,a){var n=this;return{onClick:function(e){var a=n.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;t.row.id===c.id&&t.row.type===c.type?c.selected=!0:c.selected=!1}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}n.setState({data:a,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}}},{key:"handleCheckboxSelection",value:function(e,t,a){var n=this;return"selected"===a.id?{onClick:function(e){var a=n.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;if(t.row.id===c.id&&t.row.type===c.type){c.selected=!c.selected;break}}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}n.setState({data:a,allSelected:n.checkAllSelected(a)}),e.stopPropagation()}}:{}}},{key:"handleTHeadCheckboxSelection",value:function(e,t,a,n){var r=this;return"selected"===a.id?{onClick:function(t){var a=r.state.data,n=!r.state.allSelected,i=!0,o=!1,s=void 0;try{for(var l,c=a[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value,p=!0,u=!1,h=void 0;try{for(var m,g=e.pageRows[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var y=m.value;if(d.id===y.id&&d.type===y.type){d.selected=n;break}}}catch(f){u=!0,h=f}finally{try{p||null==g.return||g.return()}finally{if(u)throw h}}}}catch(f){o=!0,s=f}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}r.setState({data:a,allSelected:n})}}:{}}},{key:"checkAllSelected",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(!r.value.selected)return!1}}catch(o){a=!0,n=o}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}return!0}}]),t}(n.Component),ji=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={entry:!1,thing:!1,actionSuccess:!1},a.RemoveLink=a.RemoveLink.bind(Object(p.a)(Object(p.a)(a))),a.RemoveLinkAjax=a.RemoveLinkAjax.bind(Object(p.a)(Object(p.a)(a))),a.ToggleActionSuccess=a.ToggleActionSuccess.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=!1,t=!1,a=!0,n=!1,i=void 0;try{for(var o,s=this.props.data[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;l.type&&l.selected&&("entry"===l.type?e=!0:t=!0)}}catch(c){n=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return r.a.createElement("div",null,this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement("span",{bsStyle:{color:"green"}},"Action Successful!")):null,r.a.createElement("div",null,t||e?r.a.createElement("h4",{style:{float:"left"}},"Actions"):r.a.createElement("div",null," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a link for options"):null," "),r.a.createElement(Zt.a,{style:{float:"right"}},t||e?r.a.createElement(W.a,{onClick:this.RemoveLink},"Remove Link"):null)))}},{key:"RemoveLink",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;i.selected&&this.RemoveLinkAjax(parseInt(i.linkid))}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}},{key:"RemoveLinkAjax",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/link/"+e,success:function(e){console.log("successfully removed link"),this.ToggleActionSuccess()}.bind(this),error:function(e){this.props.errorToggle("failed to remove link",e)}.bind(this)})}},{key:"ToggleActionSuccess",value:function(){var e=!this.state.actionSuccess;this.props.getLinks(),this.setState({actionSuccess:e})}}]),t}(n.Component),Oi=a(1108),xi={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}},Ci=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleRowSelection=function(e,t,n){return{onClick:function(e){var n=a.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;t.row.id===c.id&&t.row.type===c.type?c.selected=!0:c.selected=!1}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}a.setState({data:n,allSelected:!1})},style:{background:void 0!==t&&t.row.selected?"rgb(174, 218, 255)":null}}},a.handleCheckboxSelection=function(e,t,n){return"selected"===n.id?{onClick:function(e){var n=a.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;if(t.row.id===c.id&&t.row.type===c.type){c.selected=!c.selected;break}}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}a.setState({data:n,allSelected:a.checkAllSelected(n)}),e.stopPropagation()}}:{}},a.handleTHeadCheckboxSelection=function(e,t,n,r){return"selected"===n.id?{onClick:function(t){var n=a.state.data,r=!a.state.allSelected,i=!0,o=!1,s=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value,p=!0,u=!1,h=void 0;try{for(var m,g=e.pageRows[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var y=m.value;if(d.id===y.id&&d.type===y.type){d.selected=r;break}}}catch(f){u=!0,h=f}finally{try{p||null==g.return||g.return()}finally{if(u)throw h}}}}catch(f){o=!0,s=f}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}a.setState({data:n,allSelected:r})}}:{}},a.checkAllSelected=function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(!r.value.selected)return!1}}catch(o){a=!0,n=o}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}return!0},a.getMarkedItems=function(){var e=ce("marked"),t={id:a.props.id,type:a.props.type,subject:a.props.string};e&&((e=JSON.parse(e)).unshift(t),a.setState({data:e}))},a.state={data:[],allSelected:!1},a.handleTHeadCheckboxSelection=a.handleTHeadCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleRowSelection=a.handleRowSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleCheckboxSelection=a.handleCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a.getMarkedItems=a.getMarkedItems.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0,this.getMarkedItems()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"subject",maxWidth:"100%",sortable:!0}];return r.a.createElement(q.a,{dialogClassName:"mark-modal",show:this.props.modalActive,onHide:this.props.markModalToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Marked Objects")),r.a.createElement(q.a.Body,null,this.state.data.length>0?r.a.createElement(Yt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No items marked.",style:{maxHeight:"60vh"},filterable:!0}):r.a.createElement("h3",null,"No marked items detected.")),r.a.createElement(q.a.Footer,null,r.a.createElement(Di,{data:this.state.data,id:this.props.id,type:this.props.type,getMarkedItems:this.getMarkedItems,errorToggle:this.props.errorToggle})))}}]),t}(n.Component),Di=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).deleteCallback=function(e){!0===e&&a.RemoveSelected(),a.setState({pendingDelete:!1})},a.LinkContextChange=function(e){a.setState({linkContextString:e.target.value})},a.ExpandLinkToggle=function(e){if(!0===e||!1===e)a.setState({linkPanel:e,linkContextString:""});else{var t=!a.state.linkPanel;a.setState({linkPanel:t,linkContextString:""})}},a.RemoveSelected=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a.props.data[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.selected&&$a(o.type,o.id)}}catch(s){t=!0,n=s}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}a.props.getMarkedItems(),a.state.actionSuccess&&a.setState({actionSuccess:!1})},a.StartDelete=function(){a.setState({pendingDelete:!0})},a.MoveEntry=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a.props.data[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.selected&&"entry"===o.type&&a.EntryAjax(o.id,!0)}}catch(s){t=!0,n=s}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},a.CopyEntry=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a.props.data[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.selected&&"entry"===o.type&&a.EntryAjax(o.id,!1)}}catch(s){t=!0,n=s}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},a.Link=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a.props.data[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;if(o.selected){var s=[],l={},c={};l.id=parseInt(o.id),l.type=o.type,c.id=parseInt(a.props.id),c.type=a.props.type,s.push(l),s.push(c),a.LinkAjax(s)}}}catch(d){t=!0,n=d}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},a.Reparse=function(){a.setState({reparseButton:xi.LOADING}),X.a.when.apply(X.a,Object(T.a)(a.props.data.filter(function(e){return e.selected}).map(function(e){return a.ReparseAjax(e)}))).then(function(){a.setState({reparseButton:xi.SUCCESS})},function(e){console.error(e),a.setState({reparseButton:xi.ERROR}),a.props.errorToggle("error reparsing",e)}).always(function(){setTimeout(function(){a.setState({reparseButton:xi.READY})},2e3)})},a.ReparseAjax=function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"})},a.Promote=function(){a.setState({promoteButton:xi.LOADING});var e=!0;X.a.when.apply(X.a,Object(T.a)(a.props.data.filter(function(e){return e.selected}).map(function(e){return a.PromoteAjax(e)}))).then(function(){a.setState({promoteButton:xi.SUCCESS})},function(t){e=!1,console.error(t),a.setState({promoteButton:xi.ERROR}),a.props.errorToggle("error adding alerts to event",t)}).always(function(){setTimeout(function(){a.setState({promoteButton:xi.READY}),e&&window.location.reload()},2e3)})},a.PromoteAjax=function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(a.props.id)}),contentType:"application/json; charset=UTF-8"})},a.LinkAjax=function(e){var t={weight:1};t.vertices=e,a.state.linkContextString&&(t.context=a.state.linkContextString),X.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to link",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.EntryAjax=function(e,t){X.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){var n;n={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.RemoveEntryAfterMove=function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")},error:function(e){this.props.errorToggle("Failed to remove original entry",e)}})},a.ToggleActionSuccess=function(e){if(!0===e||!1===e)a.setState({actionSuccess:e});else{var t=!a.state.actionSuccess;a.setState({actionSuccess:t})}},a.state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:xi.READY,deleteButton:xi.READY,promoteButton:xi.READY},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=!1,t=!1,a=!0,n=0,i=!0,o=!1,s=void 0;try{for(var l,c=this.props.data[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value;d.type&&d.selected&&(n++,"entry"===d.type?e=!0:t=!0,"alert"!==d.type&&(a=!1))}}catch(b){o=!0,s=b}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}var p=0!==n&&a&&"event"===this.props.type,u=this.state,h=u.reparseButton,m=u.deleteButton,g=u.promoteButton,y=u.pendingDelete,f=null;return y&&(f=this.props.data.filter(function(e){return e.selected}).map(function(e){return{type:e.type,id:e.id}})),r.a.createElement("div",null,this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement(W.a,{bsStyle:"success",onClick:this.RemoveSelected},"Action Successful! Remove Mark?"),r.a.createElement(W.a,{onClick:this.ToggleActionSuccess},"Keep Marked")):r.a.createElement("div",{style:{display:"grid"}},r.a.createElement("div",null,t||e?r.a.createElement("h4",{style:{float:"left"}},"Actions"):r.a.createElement("div",null," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a Marked Object"):null," "),r.a.createElement(Zt.a,{style:{float:"right"}},e&&!t&&"alertgroup"!==this.props.type?r.a.createElement(W.a,{onClick:this.MoveEntry},"Move to ",this.props.type," ",this.props.id):null,e&&!t&&"alertgroup"!==this.props.type?r.a.createElement(W.a,{onClick:this.CopyEntry},"Copy to ",this.props.type," ",this.props.id):null,t||e?r.a.createElement(W.a,{onClick:this.ExpandLinkToggle},"Link to ",this.props.type," ",this.props.id):null,p&&r.a.createElement(W.a,{bsStyle:g.style,onClick:this.Promote,disabled:g.disabled},g.text?g.text:"Add to ".concat(this.props.type," ").concat(this.props.id)),(t||e)&&r.a.createElement(W.a,{bsStyle:h.style,onClick:this.Reparse,disabled:h.disabled},h.text?h.text:"Reparse Flair"),(t||e)&&r.a.createElement(W.a,{bsStyle:"warning",onClick:this.RemoveSelected},"Unmark"),(t||e)&&r.a.createElement(W.a,{bsStyle:"danger",onClick:this.StartDelete,disabled:m.disabled},m.text?m.text:"Delete"))),this.state.linkPanel&&(t||e)?r.a.createElement(B.a,{collapsible:!0,expanded:this.state.linkPanel},r.a.createElement(Oi.a,{horizontal:!0},r.a.createElement(D.a,{sm:2},"Provide context to this link:"),r.a.createElement(D.a,{sm:9},r.a.createElement($r.a,{type:"text",value:this.state.linkContextString,placeholder:"optional",onChange:this.LinkContextChange})),r.a.createElement(D.a,{sm:1},r.a.createElement(W.a,{onClick:this.Link,bsStyle:"success"},"Submit")))):null,y&&r.a.createElement(Sn,{things:f,errorToggle:this.props.errorToggle,callback:this.deleteCallback})))}}]),t}(n.Component);Di.defaultProps={data:{}},Ci.defaultProps={modalActive:!0};var Ni,Ai,_i,Mi,Li,Ii=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onBlur=function(e){var t=e.target.value;if(""!==t){var n=t.split(/[ ,]+/);a.setState({emailField:n})}},a.getData=function(){X.a.ajax({type:"get",url:"/scot/api/v2/prepexport/"+a.props.type+"/"+a.props.id,success:function(e){this.setState({data:e}),this.setState({leaveCatch:!1,showEditor:!0})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to get export data from server!",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.exportResponse=function(e){"success"===e&&a.setState({showEditor:!1,responseSuccess:!0})},a.state={showEditor:!1,data:null,responseSuccess:!1,emailField:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.getData()}},{key:"render",value:function(){var e=!1;return this.state.responseSuccess&&(e=!0),r.a.createElement("div",null,r.a.createElement(q.a,{dialogClassName:"links-modal",show:!0,onHide:this.props.exportToggle},r.a.createElement(q.a.Header,{closeButton:!0},r.a.createElement(q.a.Title,null,"Export ",this.props.type," ",this.props.id)),r.a.createElement(q.a.Body,null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email addresses"),r.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",onBlur:this.onBlur,placeholder:"Enter emails (comma-separated)",disabled:e})),r.a.createElement("br",null),this.state.showEditor?r.a.createElement(yr,{entryAction:"Export",exportResponse:this.exportResponse,type:this.props.type,targetid:this.props.id,id:"add_entry",recipients:this.state.emailField,addedentry:this.props.exportToggle,content:this.state.data,errorToggle:this.props.errorToggle}):null,!this.state.showEditor&&this.state.responseSuccess?r.a.createElement(Pi,null):null,this.state.showEditor||this.state.responseSuccess?null:r.a.createElement("i",{className:"fa fa-spinner fa-spin fa-2x","aria-hidden":"true"}))))}}]),t}(r.a.Component),Pi=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("i",{className:"fa fa-check","aria-hidden":"true",style:{color:"green"}})," ","Export Successful!")}}]),t}(n.Component),Ri={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},Fi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={showAllPromotedDataToolbar:!1},a.showAllPromotedDataToggle=a.showAllPromotedDataToggle.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"showAllPromotedDataToggle",value:function(){!1===this.state.showAllPromotedDataToolbar?this.setState({showAllPromotedDataToolbar:!0}):this.setState({showAllPromotedDataToolbar:!1})}},{key:"render",value:function(){var e=null,t=[],a=[],n=3;"event"===this.props.type?e="alert":"incident"===this.props.type&&(e="event");for(var i=0;i<this.props.data.length;i++){i>0&&t.push(r.a.createElement("span",null," , "));var o="/"+e+"/"+this.props.data[i];t.push(r.a.createElement("span",{key:this.props.data[i]},r.a.createElement(Ae.a,{to:o},this.props.data[i])))}this.props.data.length<3&&(n=this.props.data.length);for(var s=0;s<n;s++){s>0&&a.push(r.a.createElement("div",null," , "));var l="/"+e+"/"+this.props.data[s];a.push(r.a.createElement("div",{key:this.props.data[s]},r.a.createElement(Ae.a,{to:l},this.props.data[s])))}return this.props.data.length>3&&a.push(r.a.createElement("div",{onClick:this.showAllPromotedDataToggle},",",r.a.createElement("a",{href:"javascript:;"},"...more"))),r.a.createElement("td",null,r.a.createElement("span",{id:"promoted_from",style:{display:"flex"}},a),this.state.showAllPromotedDataToolbar?r.a.createElement(fn.a,{isOpen:!0,onRequestClose:this.showAllPromotedDataToggle,style:Ri},r.a.createElement("div",{className:"modal-header"},r.a.createElement("img",{src:"images/close_toolbar.png",className:"close_toolbar",alt:"",onClick:this.showAllPromotedDataToggle}),r.a.createElement("h3",{id:"myModalLabel"},"Promoted From")),r.a.createElement("div",{className:"modal-body promoted-from-full"},t),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(W.a,{id:"cancel-modal",onClick:this.showAllPromotedDataToggle},"Close"))):null)}}]),t}(n.Component),Ui=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).updated=function(e,t){a.setState({refreshing:!0,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1});var n="entry";"alertgroup"==a.props.type&&(n="alert"),X.a.ajax({type:"get",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,success:function(e){if(this.state.isMounted){var t=e;this.setState({headerData:t,showEventData:!0,eventLoaded:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),"alertgroup"==this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.setState({showEventData:!0,eventLoaded:!0,isNotFound:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload detail data. Error message: "+e.responseText,e)}.bind(Object(p.a)(Object(p.a)(a)))}),X.a.ajax({type:"get",url:"scot/api/v2/"+a.props.type+"/"+a.props.id+"/"+n,success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntryData:!0,entryLoaded:!0,entryData:t,runWatcher:!0}),this.Watcher(),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1})}}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.setState({showEntryData:!0,entryLoaded:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entry data. Error message: "+e.responseText,e)}}),X.a.ajax({type:"get",url:"scot/api/v2/"+a.props.type+"/"+a.props.id+"/entity",success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntityData:!0,entityLoaded:!0,entityData:t});var a={waitEntry:function(){0==this.state.entryLoaded?setTimeout(a.waitEntry,50):(setTimeout(function(){Si.entityUpdate(t,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(this)),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}))}.bind(this)};a.waitEntry()}}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.setState({showEntityData:!0}),1==this.state.eventLoaded&&1==this.state.entryLoaded&&1==this.state.entityLoaded&&this.setState({refreshing:!1}),this.props.errorToggle("Error: Failed to reload entity data.",e)}.bind(Object(p.a)(Object(p.a)(a)))}),void 0!=e&&void 0!=t&&a.props.errorToggle(t)},a.flairToolbarToggle=function(e,t,n,r,i){a.setState({flairToolbar:!0,entityid:e,entityvalue:t,entitytype:n,entityoffset:r,entityobj:i})},a.flairToolbarOff=function(){if(a.state.isMounted){var e=a.state.entityDetailKey+1;a.setState({flairToolbar:!1,entityDetailKey:e})}},a.linkWarningToggle=function(e){!1===a.state.linkWarningToolbar?a.setState({linkWarningToolbar:!0,link:e}):a.setState({linkWarningToolbar:!1})},a.exportToggle=function(){!1===a.state.exportModal?a.setState({exportModal:!0}):a.setState({exportModal:!1})},a.viewedbyfunc=function(e){var t=[];if(null!==e)for(var a in e.view_history)t.push(a);return t},a.entryToggle=function(){!1===a.state.entryToolbar?a.setState({entryToolbar:!0}):a.setState({entryToolbar:!1})},a.deleteToggle=function(e,t){!1===a.state.deleteToolbar?a.setState({deleteToolbar:!0,deleteType:e}):a.setState({deleteToolbar:!1,deleteType:e}),t&&a.setState({isDeleted:!0})},a.changeHistoryToggle=function(){!1===a.state.changeHistoryToolbar?a.setState({changeHistoryToolbar:!0}):a.setState({changeHistoryToolbar:!1})},a.viewedByHistoryToggle=function(){!1===a.state.viewedByHistoryToolbar?a.setState({viewedByHistoryToolbar:!0}):a.setState({viewedByHistoryToolbar:!1})},a.permissionsToggle=function(){!1===a.state.permissionsToolbar?a.setState({permissionsToolbar:!0}):a.setState({permissionsToolbar:!1})},a.entitiesToggle=function(){!1===a.state.entitiesToolbar?a.setState({entitiesToolbar:!0}):a.setState({entitiesToolbar:!1})},a.promoteToggle=function(){!1===a.state.promoteToolbar?a.setState({promoteToolbar:!0}):a.setState({promoteToolbar:!1})},a.fileUploadToggle=function(){!1===a.state.fileUploadToolbar?a.setState({fileUploadToolbar:!0}):a.setState({fileUploadToolbar:!1})},a.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a.Watcher=function(){X()("iframe").each(function(e,t){t.contentWindow.requestAnimationFrame(function(){if(null!==t.contentDocument){var e=[];e.push(this.checkFlairHover),e.push(this.checkHighlight),X()(t).off("mouseenter"),X()(t).off("mouseleave"),X()(t).on("mouseenter",function(e,a){var n=setInterval(this[0],50,t),r=setInterval(this[1],50,t);X()(t).data("intervalID",n),X()(t).data("intervalID1",r),console.log("Now watching iframe "+n)}.bind(e)),X()(t).on("mouseleave",function(){var e=X()(t).data("intervalID"),a=X()(t).data("intervalID1");window.clearInterval(e),window.clearInterval(a),console.log("No longer watching iframe "+e)})}}.bind(this))}.bind(Object(p.a)(Object(p.a)(a)))),"alertgroup"==a.props.type&&X()("#detail-container").find("a, .entity").not(".not_selectable").each(function(e,t){X()(t).off("mousedown"),X()(t).on("mousedown",function(e){var t=e.target;if("extras"==X()(t)[0].className&&(t=X()(t)[0].parentNode),X()(t).attr("url")){var a=X()(t).attr("url");this.linkWarningToggle(a)}else{var n=X()(t).attr("data-entity-id"),r=X()(t).attr("data-entity-value"),i=X()(t).offset(),o=X()(t);this.flairToolbarToggle(n,r,"entity",i,o)}}.bind(this))}.bind(Object(p.a)(Object(p.a)(a))))},a.checkHighlight=function(e){var t;if(null!==e.contentWindow){if(t=e.contentWindow.getSelection().toString(),a.state.highlightedText==t)return;a.setState({highlightedText:t})}},a.checkFlairHover=function(e,t){null!=e.contentDocument&&(X()(e).contents().find(".entity").each(function(t,a){if("rgb(255, 0, 0)"==X()(a).css("background-color"))X()(a).data("state","down");else if("down"==X()(a).data("state")){X()(a).data("state","up");var n=X()(a).attr("data-entity-id"),r=X()(a).attr("data-entity-value"),i=X()(a),o=e,s={top:X()(a).offset().top+X()(o).offset().top,left:X()(a).offset().left+X()(o).offset().left};this.flairToolbarToggle(n,r,"entity",s,i)}}.bind(Object(p.a)(Object(p.a)(a)))),X()(e).contents().find("a").each(function(e,t){if("rgb(255, 0, 0)"==X()(t).css("color"))X()(t).data("state","down");else if("down"==X()(t).data("state")){X()(t).data("state","up");var a=X()(t).attr("url");this.linkWarningToggle(a)}}.bind(Object(p.a)(Object(p.a)(a)))))},a.summaryUpdate=function(){a.forceUpdate()},a.scrollTo=function(){void 0!==a.props.taskid&&X()(".entry-wrapper").scrollTop(X()(".entry-wrapper").scrollTop()+X()("#iframe_"+a.props.taskid).position().top-30)},a.guideRedirectToAlertListWithFilter=function(){RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},a.props.handleFilter(null,null,!0,"alertgroup"),a.props.handleFilter([{id:"subject",value:RegExp.escape(a.state.headerData.data.applies_to[0])}],null,!1,"alertgroup"),window.open("#/alertgroup/")},a.showSignatureOptionsToggle=function(){!1===a.state.showSignatureOptions?a.setState({showSignatureOptions:!0}):a.setState({showSignatureOptions:!1})},a.markModalToggle=function(){!1===a.state.showMarkModal?a.setState({showMarkModal:!0}):a.setState({showMarkModal:!1})},a.ToggleProcessingMessage=function(e){a.setState({processing:e}),a.props.togglePreventClick()},a.linksModalToggle=function(){var e=!a.state.showLinksModal;a.setState({showLinksModal:e})},a.toggleFlair=function(){a.state.flairOff?(a.setState({flairOff:!1,runWatcher:!0}),setTimeout(function(){Si.entityUpdate(this.state.entityData,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id)}.bind(Object(p.a)(Object(p.a)(a))))):a.setState({flairOff:!0})},a.handleSelection=function(e){console.log("Got selection click!"),a.setState({alertsSelected:[e]})},a.handleMultiSelection=function(e){if(a.checkSelection(e.id))a.setState({alertsSelected:a.state.alertsSelected.filter(function(t){return t.id!==e.id})});else{var t=[].concat(Object(T.a)(a.state.alertsSelected),[e]);a.setState({alertsSelected:t})}},a.handleSelectAll=function(e){var t=e.map(function(e){return e.id});a.setState({alertsSelected:t})},a.handleShiftSelect=function(e,t,n){e>t&&(e=[t,t=e][0]);var r=[];n.forEach(function(a){a.id<=t&&a.id>=e&&(this.checkSelection(a)||r.push(a))}.bind(Object(p.a)(Object(p.a)(a)))),a.setState({alertsSelected:[].concat(Object(T.a)(a.state.alertsSelected),r)})};var n=Math.floor(1e3*Math.random());return a.state={showEventData:!1,headerData:{},sourceData:"",tagData:"",permissionsToolbar:!1,entitiesToolbar:!1,changeHistoryToolbar:!1,viewedByHistoryToolbar:!1,entryToolbar:!1,deleteToolbar:!1,deleteType:null,promoteToolbar:!1,notificationType:null,notificationMessage:null,key:a.props.id,showEntryData:!1,entryData:"",showEntityData:!1,entityData:[],entityid:null,entitytype:null,entityoffset:null,entityobj:null,flairToolbar:!1,linkWarningToolbar:!1,exportModal:!1,refreshing:!1,loading:!1,eventLoaded:!1,entryLoaded:!1,entityLoaded:!1,guideID:null,fileUploadToolbar:!1,isNotFound:!1,runWatcher:!1,entityDetailKey:n,processing:!1,showSignatureOptions:!1,showMarkModal:!1,showLinksModal:!1,flairOff:!1,highlightedText:"",flairing:!1,isMounted:!1,alertsSelected:[],isDeleted:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.setState({loading:!0})}},{key:"componentDidMount",value:function(){this.setState({isMounted:!0});var e={delay:function(){var e="entry";"alertgroup"===this.props.type&&(e="alert"),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id,success:function(e){if(this.state.isMounted){var t=e;this.setState({headerData:t,showEventData:!0,isNotFound:!1,tagData:t.tag,sourceData:t.source}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),"alertgroup"===this.props.type&&-1===t.parsed?this.setState({flairing:!0}):this.setState({flairing:!1})}}.bind(this),error:function(e){this.setState({showEventData:!0,isNotFound:!0}),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load detail data. Error message: "+e.responseText,e)}.bind(this)}),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/"+e,success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntryData:!0,entryData:t,runWatcher:!0}),this.Watcher(),!0===this.state.showEventData&&!0===this.state.showEntryData&&!0===this.state.showEntityData&&this.setState({loading:!1})}}.bind(this),error:function(e){this.setState({showEntryData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entry data. Error message: "+e.responseText,e)}}),X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/entity",success:function(e){if(this.state.isMounted){var t=e.records;this.setState({showEntityData:!0,entityData:t});var a={waitEntry:function(){0==this.state.showEntryData?setTimeout(a.waitEntry,50):(setTimeout(function(){Si.entityUpdate(t,this.flairToolbarToggle,this.props.type,this.linkWarningToggle,this.props.id,this.scrollTo)}.bind(this)),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}))}.bind(this)};a.waitEntry()}}.bind(this),error:function(e){this.setState({showEntityData:!0}),1==this.state.showEventData&&1==this.state.showEntryData&&1==this.state.showEntityData&&this.setState({loading:!1}),this.props.errorToggle("Error: Failed to load entity data.",e)}.bind(this)}),"alertgroup"==this.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/"+this.props.type+"/"+this.props.id+"/guide",success:function(e){if(this.state.isMounted){for(var t=[],a=0;a<e.records.length;a++)t.push(e.records[a].id);0===t.length&&(t=null),this.setState({guideID:t})}}.bind(this),error:function(e){this.setState({guideID:null}),this.props.errorToggle("Error: Failed to load guide data. Error message:"+e.responseText,e)}.bind(this)}),this.props.createCallback(this.props.id,this.updated)}.bind(this)};Ni=setTimeout(e.delay,400)}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1}),clearTimeout(Ni),"function"===this.state.entryData.forEach&&this.state.entryData.forEach(function(e){this.props.removeCallback(e.id)}.bind(this))}},{key:"componentDidUpdate",value:function(){!0===this.state.runWatcher&&this.Watcher()}},{key:"checkSelection",value:function(e){return!!this.state.alertsSelected.some(function(t){return e===t.id})}},{key:"render",value:function(){var e=this.state.headerData,t=this.viewedbyfunc(e),a=this.props.type,n=this.titleCase(this.props.type),i=this.props.id,o="";return this.state.headerData.subject?o=this.state.headerData.subject:this.state.headerData.value?o=this.state.headerData.value:this.state.headerData.name?o=this.state.headerData.name:this.state.headerData.body&&(o=this.state.headerData.body),r.a.createElement("div",null," ",this.state.isNotFound?r.a.createElement("h1",null,"No record found."):r.a.createElement("div",null,r.a.createElement("div",{id:"header"},r.a.createElement("div",{id:"NewEventInfo",className:"entry-header-info-null"},r.a.createElement("div",{className:"details-subject",style:{display:"inline-flex",paddingLeft:"5px"}},this.state.showEventData?r.a.createElement(Wi,{data:this.state.headerData,subjectType:n,type:a,id:this.props.id,errorToggle:this.props.errorToggle}):null,this.state.refreshing?r.a.createElement("span",{style:{color:"lightblue"}},"Refreshing Data..."):null,this.state.loading?r.a.createElement("span",{style:{color:"lightblue"}},"Loading..."):null,this.state.processing?r.a.createElement("span",{style:{color:"lightblue"}},"Processing Actions..."):null,this.state.flairing?r.a.createElement("span",{style:{color:"lightblue"}},"Flairing..."):null),"entity"!==a?r.a.createElement("div",{className:"details-table toolbar",style:{display:"flex"}},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("td",null,r.a.createElement("div",{style:{marginLeft:"5px"}},this.state.showEventData?r.a.createElement(Ha,{data:this.state.headerData,status:this.state.headerData.status,id:i,type:a,errorToggle:this.props.errorToggle}):null)),"entity"!==a?r.a.createElement("th",null,"Owner: "):null,"entity"!==a?r.a.createElement("td",null,r.a.createElement("span",null,this.state.showEventData?r.a.createElement(Nn,{key:i,data:this.state.headerData.owner,type:a,id:i,updated:this.updated,errorToggle:this.props.errorToggle}):null)):null,"entity"!==a?r.a.createElement("th",null,"Updated: "):null,"entity"!==a?r.a.createElement("td",null,r.a.createElement("span",{id:"event_updated"},this.state.showEventData?r.a.createElement(Hi,{data:this.state.headerData.updated}):null)):null,("event"===a||"incident"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?r.a.createElement("th",null,"Promoted From:"):null,("event"===a||"incident"===a)&&this.state.showEventData&&this.state.headerData.promoted_from.length>0?r.a.createElement(Fi,{data:this.state.headerData.promoted_from,type:a,id:i}):null,"entity"!==a&&this.state.showEventData?r.a.createElement(fi,{data:this.state.tagData,id:i,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"tag"}):null,"entity"!==a&&this.state.showEventData?r.a.createElement(fi,{data:this.state.sourceData,id:i,type:a,updated:this.updated,errorToggle:this.props.errorToggle,badgeType:"source"}):null)))):null),r.a.createElement(ki.a,{ref:"notificationSystem"}),this.state.exportModal?r.a.createElement(Ii,{type:a,errorToggle:this.props.errorToggle,exportToggle:this.exportToggle,id:i}):null,this.state.linkWarningToolbar?r.a.createElement(Wr,{linkWarningToggle:this.linkWarningToggle,link:this.state.link}):null,this.state.viewedByHistoryToolbar?r.a.createElement(Vn,{viewedByHistoryToggle:this.viewedByHistoryToggle,id:i,type:a,subjectType:n,viewedby:t,errorToggle:this.props.errorToggle}):null,this.state.changeHistoryToolbar?r.a.createElement(Un,{changeHistoryToggle:this.changeHistoryToggle,id:i,type:a,subjectType:n,errorToggle:this.props.errorToggle}):null,this.state.entitiesToolbar?r.a.createElement(Ln,{entitiesToggle:this.entitiesToggle,entityData:this.state.entityData,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff}):null,this.state.deleteToolbar?r.a.createElement("div",null,"alert"!==this.state.deleteType?r.a.createElement(Tn,{deleteType:this.state.deleteType,subjectType:n,id:i,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,removeCallback:this.props.removeCallback}):r.a.createElement(Tn,{deleteType:this.state.deleteType,type:a,deleteToggle:this.deleteToggle,updated:this.updated,errorToggle:this.props.errorToggle,history:this.props.history,alertsSelected:this.state.alertsSelected,removeCallback:this.props.removeCallback})):null,this.state.showMarkModal?r.a.createElement(Ci,{modalActive:!0,type:a,id:i,string:o,errorToggle:this.props.errorToggle,markModalToggle:this.markModalToggle}):null,this.state.showLinksModal?r.a.createElement(Ti,{modalActive:!0,type:a,id:i,errorToggle:this.props.errorToggle,linksModalToggle:this.linksModalToggle}):null,this.state.showEventData?r.a.createElement(gn,{type:a,subjectType:n,id:i,entryData:this.state.entryData,headerData:this.state.headerData,status:this.state.headerData.status,promoteToggle:this.promoteToggle,permissionsToggle:this.permissionsToggle,entryToggle:this.entryToggle,entitiesToggle:this.entitiesToggle,changeHistoryToggle:this.changeHistoryToggle,viewedByHistoryToggle:this.viewedByHistoryToggle,exportToggle:this.exportToggle,deleteToggle:this.deleteToggle,updated:this.updated,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,sourceToggle:this.sourceToggle,subjectName:this.state.headerData.subject,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,guideRedirectToAlertListWithFilter:this.guideRedirectToAlertListWithFilter,showSignatureOptionsToggle:this.showSignatureOptionsToggle,markModalToggle:this.markModalToggle,linksModalToggle:this.linksModalToggle,ToggleProcessingMessage:this.ToggleProcessingMessage,errorToggle:this.props.errorToggle,toggleFlair:this.toggleFlair,alertsSelected:this.state.alertsSelected,guideID:this.state.guideID}):null,this.state.permissionsToolbar?r.a.createElement(Gn,{updateid:i,id:i,type:a,permissionData:this.state.headerData,permissionsToggle:this.permissionsToggle,updated:this.updated,errorToggle:this.props.errorToggle}):null),this.state.showEventData&&"entity"!==a?r.a.createElement(ci,{id:i,type:a,entryToggle:this.entryToggle,updated:this.updated,entryData:this.state.entryData,headerData:this.state.headerData,showEntryData:this.state.showEntryData,showEntityData:this.state.showEntityData,summaryUpdate:this.summaryUpdate,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entryToolbar:this.state.entryToolbar,alertPreSelectedId:this.props.alertPreSelectedId,errorToggle:this.props.errorToggle,fileUploadToggle:this.fileUploadToggle,fileUploadToolbar:this.state.fileUploadToolbar,showSignatureOptions:this.state.showSignatureOptions,flairOff:this.state.flairOff,highlightedText:this.state.highlightedText,form:this.props.form,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Si.entityUpdate,handleSelection:this.handleSelection,handleShiftSelect:this.handleShiftSelect,handleMultiSelection:this.handleMultiSelection,handleSelectAll:this.handleSelectAll,alertsSelected:this.state.alertsSelected}):null,this.state.showEventData&&"entity"===a?r.a.createElement(kr,{entityid:i,form:this.props.form,entitytype:"entity",id:i,type:"entity",fullScreen:!0,errorToggle:this.props.errorToggle,linkWarningToggle:this.linkWarningToggle,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Si.entityUpdate}):null,this.state.flairToolbar?r.a.createElement(kr,{key:this.state.entityDetailKey,form:this.props.form,flairToolbarToggle:this.flairToolbarToggle,flairToolbarOff:this.flairToolbarOff,linkWarningToggle:this.linkWarningToggle,entityid:parseInt(this.state.entityid,10),data:this.state.headerData,entityvalue:this.state.entityvalue,entitytype:this.state.entitytype,type:this.props.type,id:this.props.id,errorToggle:this.props.errorToggle,entityoffset:this.state.entityoffset,watcher:this.Watcher,entityobj:this.state.entityobj,createCallback:this.props.createCallback,removeCallback:this.props.removeCallback,addFlair:Si.entityUpdate}):null))}}]),t}(r.a.Component),Hi=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.data;return r.a.createElement("div",null,r.a.createElement(Ba.a,{value:1e3*e,format:"MM/DD/YY hh:mm:ss a"}))}}]),t}(r.a.Component),Wi=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e){if(null!==e){var t=a.state.keyName,n=Object(ze.a)({},t,e.target.value),r=e.target.value;X.a.ajax({type:"put",url:"scot/api/v2/"+a.props.type+"/"+a.props.id,data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",success:function(e){console.log("success: "+e),this.setState({value:r}),this.calculateWidth(r)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("error: Failed to update the subject/name",e)}.bind(Object(p.a)(Object(p.a)(a)))})}},a.onChange=function(e){a.setState({value:e.target.value})},a.handleEnterKey=function(e){"Enter"===e.key&&a.handleChange(e)},a.calculateWidth=function(e){var t;X()("#invisible").html(X()("<span></span>").text(e)),t=X()("#invisible").width()+25+"px",a.setState({width:t})},a.componentWillReceiveProps=function(e){var t=e.data.subject;"signature"===e.type?t=e.data.name:"entity"===e.type&&(t=e.data.value),a.setState({value:t}),a.calculateWidth(t)};var n="subject",r=a.props.data.subject;return"signature"===a.props.type?(n="name",r=a.props.data.name):"entity"===a.props.type&&(n="value",r=a.props.data.value),a.state={value:r,width:"",keyName:n},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.calculateWidth(this.state.value)}},{key:"render",value:function(){var e=!1;return"entity"===this.props.type&&""!==this.state.value&&(e=!0),r.a.createElement("div",null,this.props.subjectType," ",this.props.id,":"," ",r.a.createElement("input",{type:"text",value:this.state.value,onKeyPress:this.handleEnterKey,onChange:this.onChange,onBlur:this.handleChange,style:{width:this.state.width,lineHeight:"normal"},className:"detail-header-input",disabled:e}))}}]),t}(r.a.Component),Bi=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).render=function(){var e=[];e.push(r.a.createElement(Ui,{key:a.props.id,id:a.props.id,type:a.props.type,toggleEventDisplay:a.props.viewEvent,taskid:a.props.taskid,alertPreSelectedId:a.props.alertPreSelectedId,handleFilter:a.props.handleFilter,errorToggle:a.props.errorToggle,history:a.props.history,form:a.props.form,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback,togglePreventClick:a.props.togglePreventClick}));var t="100%";return void 0!==X()("#list-view")[0]&&(t="calc(100% - "+X()("#list-view").width()+"px)"),r.a.createElement("div",{id:"main-detail-container",className:"entry-container",style:{width:t,position:"relative"},tabIndex:"3"},e)},a}return Object(d.a)(t,e),t}(r.a.Component),Vi=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentWillMount=function(){void 0===a.props.viewMode||"default"===a.props.viewMode?a.Landscape():"landscape"===a.props.viewMode?a.Landscape():"portrait"===a.props.viewMode&&a.Portrait(),a.props.id&&a.ConvertAlertIdToAlertgroupId(a.props.id),a.ConvertEntryIdToType(a.props.id),X.a.ajax({type:"get",url:"/scot/api/v2/form",success:function(e){this.setState({form:e})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("Failed to get form structure",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.componentDidMount=function(){var e=a.state.scrollheight,t=a.state.sort,n=a.state.filter,r=a.state.activepage.limit,i=a.state.activepage.page,o=[];void 0!==a.props.id&&a.props.id.length>0&&(a.props.id,"landscape"===a.state.viewMode&&(e="30vh"));var s=[],l=a.props.type+":listview";a.props.createCallback(l,a.reloadactive);var c="/scot/api/v2/"+a.state.type;"alert"===a.props.type&&(c="/scot/api/v2/alertgroup");var d={limit:r,offset:i*r};if(void 0!==t||null===t){var u={};X.a.each(t,function(e,t){var a=-1;t.desc||(a=1),u[t.id]=a}),d.sort=JSON.stringify(u)}void 0===t&&null!==t||X.a.each(n,function(e,t){if("source"===t.id||"tag"===t.id){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=t.value[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;a.push(l.name)}}catch(p){r=!0,i=p}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}d[t.id]=JSON.stringify(a)}else if("created"===t.id||"updated"===t.id){var c=[];c.push(t.value.start),c.push(t.value.end),d[t.id]=JSON.stringify(c)}else d[t.id]=JSON.stringify(t.value)}),Li=X.a.ajax({type:"GET",url:c,data:d,traditional:!0,success:function(t){Ai=t,X.a.each(Ai.records,function(e,t){s[e]={},X.a.each(t,function(t,a){if("sources"===t||"source"===t){if(void 0!==a){var n=a.join(", ");s[e].source=n}}else if("tags"===t||"tag"===t){if(void 0!==a){var r=a.join(", ");s[e].tag=r}}else s[e][t]=a;"id"===t&&(this.props.createCallback(a,this.reloadactive),o.push(a))}.bind(this)),s[e].classname=e%2===0?"table-row roweven":"table-row rowodd"}.bind(this));var a=this.getPages(t.totalRecordCount);this.setState({scrollheight:e,objectarray:s,totalCount:t.totalRecordCount,loading:!1,idsarray:o,totalPages:a}),"alert"===this.props.type&&!1===this.state.showSelectedContainer?this.setState({showSelectedContainer:!1}):void 0===this.state.id||null===this.state.id?this.setState({showSelectedContainer:!1}):this.setState({showSelectedContainer:!0})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){"abort"===!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(Object(p.a)(Object(p.a)(a)))}),X()("#list-view-container").keydown(a.keyNavigate),X()(document.body).keydown(function(e){X()("input").is(":focus")||X()("textarea").is(":focus")||70===e.keyCode&&!0!==e.ctrlKey&&!0!==e.metaKey&&this.toggleView()}.bind(Object(p.a)(Object(p.a)(a))))},a.componentWillUnmount=function(){document.removeEventListener("keydown",a.keyNavigate)},a.togglePreventClick=function(){a.setState({preventClick:!a.state.preventClick})},a.keyNavigate=function(e){if("click"!==e.type){if(!["j","k","ArrowUp","ArrowDown"].includes(e.key))return;var t=(e.target||e.srcElement).tagName.toLowerCase();if("input"===t||"textarea"===t)return}var n=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected");if(n){var r=null;switch(e.key){case"j":case"ArrowDown":default:r=n.parentElement.nextElementSibling;break;case"k":case"ArrowUp":r=n.parentElement.previousElementSibling}if(r){var i=r.children[0].children[0].innerHTML;a.props.history.push("/".concat(a.state.type,"/").concat(i)),e.preventDefault(),e.stopPropagation()}}},a.reloadactive=function(){a.getNewData()},a.ToggleCreateEntity=function(){a.setState({showEntityCreateModal:!a.state.showEntityCreateModal})},a.render=function(){var e=!1,t=a.state.scrollheight;a.state.listViewContainerDisplay,null!=a.state.id&&null!=a.state.typeCapitalized&&(document.title=a.state.typeCapitalized.charAt(0)+"-"+a.state.id),null==At("listViewFilter"+a.props.type)&&null==At("listViewSort"+a.props.type)&&null==At("listViewPage"+a.props.type)||(e=!0);var n=Da(a.props.type,{},{},!1);return r.a.createElement("div",null,"entry"!==a.state.type?r.a.createElement("div",{key:a.state.listViewKey,className:"allComponents"},r.a.createElement("div",{className:"black-border-line"},r.a.createElement("div",{className:"mainview"},r.a.createElement("div",null,r.a.createElement("div",{className:"list-buttons"},"on"===a.props.notificationSetting?r.a.createElement(Ka.a,{eventkey:"1",onClick:a.props.notificationToggle,bsSize:"xsmall"},"Mute Notifications"):r.a.createElement(Ka.a,{eventkey:"2",onClick:a.props.notificationToggle,bsSize:"xsmall"},"Turn On Notifications"),"event"===a.props.type||"intel"===a.props.type||"incident"===a.props.type||"signature"===a.props.type||"guide"===a.props.type||"entity"===a.props.type?r.a.createElement(Ka.a,{onClick:a.createNewThing,eventkey:"6",bsSize:"xsmall"},"Create ",a.state.typeCapitalized):null,r.a.createElement(Ka.a,{eventkey:"5",bsSize:"xsmall",onClick:a.exportCSV},"Export to CSV"),r.a.createElement(Ka.a,{bsSize:"xsmall",onClick:a.toggleView},"Full Screen Toggle (f)"),e?r.a.createElement(Ka.a,{onClick:a.clearAll,eventkey:"3",bsSize:"xsmall",bsStyle:"info"},"Clear All Filters"):null),r.a.createElement("div",{id:"list-view-container",tabIndex:"1"},r.a.createElement("div",{id:"list-view",tabIndex:"2"},r.a.createElement(Yt.a,{columns:n,data:a.state.objectarray,style:{height:t},page:a.state.activepage.page,pages:a.state.totalPages,defaultPageSize:50,onPageChange:a.handlePageChange,onPageSizeChange:a.handlePageSizeChange,pageSize:a.state.activepage.limit,onFilteredChange:a.handleFilter,filtered:a.state.filter,onSortedChange:a.handleSort,sorted:a.state.sort,manual:!0,sortable:!0,filterable:!0,resizable:!0,styleName:"styles.ReactTable",className:"-striped -highlight",minRows:0,LoadingComponent:a.CustomTableLoader,loading:a.state.loading,getTrProps:a.handleRowSelection}))),r.a.createElement("div",{onMouseDown:a.dragdiv,className:"splitter",style:{display:"block",height:"5px",backgroundColor:"black",borderTop:"1px solid #AAA",borderBottom:"1px solid #AAA",cursor:"row-resize",overflow:"hidden"}}),a.state.showSelectedContainer?r.a.createElement(Bi,Object(ze.a)({key:a.state.id,id:a.state.id,type:a.state.queryType,alertPreSelectedId:a.state.alertPreSelectedId,taskid:a.state.entryid,handleFilter:a.handleFilter,errorToggle:a.props.errorToggle,history:a.props.history,togglePreventClick:a.togglePreventClick,form:a.state.form,createCallback:a.props.createCallback,removeCallback:a.props.removeCallback},"togglePreventClick",a.togglePreventClick)):null,a.state.showEntityCreateModal?r.a.createElement(Yr,{match:"",modalActive:a.state.showEntityCreateModal,ToggleCreateEntity:a.ToggleCreateEntity,errorToggle:a.props.errorToggle}):null)))):null)},a.CustomTableLoader=function(){return r.a.createElement("div",{className:"-loading"+(a.state.loading?" -active":"")},r.a.createElement(yt,{loading:a.state.loading}))},a.AutoScrollToId=function(){var e=document.querySelector(".ReactTable .rt-tbody .rt-tr.selected"),t=document.querySelector(".ReactTable .rt-tbody");e?((t.scrollTop+t.offsetHeight-e.offsetHeight<e.offsetTop||e.offsetTop<t.scrollTop)&&(t.scrollTop=e.offsetTop-t.offsetHeight/2+e.offsetHeight/2),a.setState({initialAutoScrollToId:!0})):t.scrollTop=0},a.componentDidUpdate=function(e,t){for(var n=0;n<a.state.objectarray.length;n++){var r=a.state.objectarray[n].id;(null!=a.state.id&&a.state.id===r&&a.state.id!==t.id||null!=a.state.id&&a.state.id===r&&!1===t.initialAutoScrollToId)&&setTimeout(a.AutoScrollToId,300)}},a.componentWillReceiveProps=function(e){void 0===e.id?a.setState({type:e.type,id:null,showSelectedContainer:!1,scrollheight:X()(window).height()-170+"px"}):e.id!==a.props.id&&("alert"===a.props.type?(a.ConvertAlertIdToAlertgroupId(e.id),a.ConvertEntryIdToType(e.id),a.setState({type:e.type,alertPreSelectedId:e.id})):"task"===a.props.type?a.setState({type:e.type,queryType:e.queryType,id:e.id,entryid:e.id2}):a.setState({type:e.type,id:e.id}))},a.ConvertAlertIdToAlertgroupId=function(e){"alert"===a.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/alert/"+e,success:function(e){var t=e;this.setState({id:t.alertgroup,showSelectedContainer:!0})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.ConvertEntryIdToType=function(e){"entry"===a.props.type&&X.a.ajax({type:"get",url:"scot/api/v2/entry/"+e,async:!1,success:function(e){this.selected(e.target.type,e.target.id,this.props.id)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to convert alert id to alertgroup id",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.startdrag=function(e){X()("iframe").each(function(e,t){X()(t).addClass("pointerEventsOff")}),a.setState({manualScrollHeight:Mi+e.clientY-_i+"px",scrollheight:Mi+e.clientY-_i+"px"})},a.stopdrag=function(e){X()("iframe").each(function(e,t){X()(t).removeClass("pointerEventsOff")}),document.onmousemove=null},a.dragdiv=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=document.getElementsByClassName("ReactTable");_i=e.clientY,Mi=parseInt(document.defaultView.getComputedStyle(t[0]).height,10),document.onmousemove=a.startdrag,document.onmouseup=a.stopdrag},a.toggleView=function(){0!==a.state.id.length&&!0===a.state.showSelectedContainer&&"none"!==a.state.listViewContainerDisplay?a.setState({listViewContainerDisplay:"none",scrollheight:"0px"}):a.setState({listViewContainerDisplay:null,scrollheight:"30vh"})},a.Portrait=function(){document.onmousemove=null,document.onmousedown=null,document.onmouseup=null,X()(".container-fluid2").css("width","650px"),X()(".splitter").css("width","5px"),X()(".mainview").show();var e;e=["dates-small","status-owner-small","module-reporter-small"],a.setState({splitter:!0,display:"flex",alldetail:!0,scrollheight:X()(window).height()-170+"px",maxheight:X()(window).height()-170+"px",resize:"horizontal",differentviews:"",maxwidth:"",minwidth:"",scrollwidth:"650px",sizearray:e}),a.setState({listViewOrientation:"portrait-list-view"}),Lt("viewMode","portrait",1e3)},a.Landscape=function(){document.onmousemove=null,document.onmousedown=null,document.onmouseup=null,X()(".splitter").css("width","100%"),X()(".mainview").show(),a.setState({classname:[" "," "," "," "],splitter:!1,display:"block",maxheight:"",alldetail:!0,differentviews:"100%",scrollheight:null!=a.state.id?"300px":X()(window).height()-170+"px",maxwidth:"",minwidth:"",scrollwidth:"100%",resize:"vertical"}),a.setState({listViewOrientation:"landscape-list-view"}),Lt("viewMode","landscape",1e3)},a.clearAll=function(){var e=a.state.listViewKey+1;a.setState({listViewKey:e,activepage:{page:0,limit:a.state.activepage.limit},sort:[{id:"id",desc:!0}],filter:[]}),a.getNewData({page:0},[{id:"id",desc:!0}],{}),Mt("listViewFilter"+a.props.type),Mt("listViewSort"+a.props.type),Mt("listViewPage"+a.props.type)},a.selected=function(e,t,n,r){var i;null==r&&null==n?a.props.history.push("/"+e+"/"+t):null==r&&null!=n?a.props.history.push("/"+e+"/"+t+"/"+n):a.props.history.push("/"+e+"/"+r+"/"+t+"/"),"block"===a.state.display&&(i="30vh"),a.setState({alertPreSelectedId:0,scrollheight:i,showSelectedContainer:!0})},a.getNewData=function(e,t,n){a.setState({loading:!0});var r,i,o,s=t,l=n,c=(a.state.idsarray,[]);a.ConvertAlertIdToAlertgroupId(a.props.id),a.ConvertEntryIdToType(a.props.id),void 0==e?(i=a.state.activepage.page,r=a.state.activepage.limit):(i=void 0==e.page?a.state.activepage.page:e.page,r=void 0==e.limit?a.state.activepage.limit:e.limit),o=i*r,void 0==s&&(s=a.state.sort),void 0==l&&(l=a.state.filter);var d={limit:r,offset:o};if(void 0!=s){var u={};X.a.each(s,function(e,t){var a=-1;t.desc||(a=1),u[t.id]=a}),d.sort=JSON.stringify(u)}void 0!=l&&X.a.each(l,function(e,t){if("source"==t.id||"tag"==t.id){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=t.value[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;a.push(l.name)}}catch(p){r=!0,i=p}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}d[t.id]=JSON.stringify(a)}else if("created"==t.id||"updated"==t.id||"occurred"==t.id){var c=[];c.push(t.value.start),c.push(t.value.end),d[t.id]=JSON.stringify(c)}else d[t.id]=JSON.stringify(t.value)});var h=[];1==a.state.loading&&Li.abort(),Li=X.a.ajax({type:"GET",url:"/scot/api/v2/"+a.state.type,data:d,traditional:!0,success:function(e){Ai=e,X.a.each(Ai.records,function(e,t){h[e]={},X.a.each(t,function(t,a){if("sources"==t||"source"==t){if(void 0!=a){var n=a.join(", ");h[e].source=n}}else if("tags"==t||"tag"==t){if(void 0!=a){var r=a.join(", ");h[e].tag=r}}else h[e][t]=a;"id"==t&&(this.props.createCallback(a,this.reloadactive),c.push(a))}.bind(this)),h[e].classname=e%2==0?"table-row roweven":"table-row rowodd"}.bind(this));var t=this.getPages(e.totalRecordCount);this.setState({totalCount:e.totalRecordCount,activepage:{page:i,limit:r},objectarray:h,loading:!1,idsarray:c,totalPages:t})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){"abort"==!e.statusText&&this.props.errorToggle("failed to get list data",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.exportCSV=function(){var e=[],t=a.state.columns;X.a.each(t,function(t,a){e.push(a)});var n="";X()(".rt-tbody").find(".rt-tr").each(function(e,t){var a=[];X()(t).find(".rt-td").each(function(e,t){var n=X()(t).text();n=n.replace(/,/g,"|"),a.push(n)}),n+=a.join()+"\n"});var r=e.join()+"\n";n=r+n;var i="data:text/csv;charset=utf-8,"+encodeURIComponent(n);window.open(i)},a.handleSort=function(e,t){var n=[];if(!0===t)a.setState({sort:[{id:"id",desc:!0}]});else{var r=!0,i=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;c.id&&n.push(c)}}catch(p){i=!0,o=p}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}a.setState({sort:n}),a.getNewData(null,n,null);var d="listViewSort"+a.props.type;Lt(d,JSON.stringify(n),1e3)},a.handleFilter=function(e,t,n,r){var i=[],o=a.props.type;if(void 0!==r&&(o=r),!0!==n){var s=!0,l=!1,c=void 0;try{for(var d,p=e[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var u=d.value;u.id&&i.push(u)}}catch(h){l=!0,c=h}finally{try{s||null==p.return||p.return()}finally{if(l)throw c}}a.setState({filter:i}),r!==a.props.type&&void 0!==r||a.getNewData({page:0},null,i),Lt("listViewFilter"+o,JSON.stringify(i),1e3)}else a.setState({filter:i})},a.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a.createNewThing=function(){var e;if("signature"===a.props.type)e=JSON.stringify({name:"Name your Signature",status:"disabled"});else if("guide"===a.props.type)e=JSON.stringify({subject:"ENTER A GUIDE NAME",applies_to:["documentation"]});else{if("entity"===a.props.type)return void a.ToggleCreateEntity();e=JSON.stringify({subject:"No Subject"})}X.a.ajax({type:"POST",url:"/scot/api/v2/"+a.props.type,data:e,success:function(e){this.selected(this.props.type,e.id)}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.props.errorToggle("failed to create new thing",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.handlePageChange=function(e){a.getNewData({page:e});var t="listViewPage"+a.props.type;Lt(t,JSON.stringify({page:e,limit:a.state.activepage.limit}))},a.handlePageSizeChange=function(e,t){a.getNewData({limit:e,page:t});var n="listViewPage"+a.props.type;Lt(n,JSON.stringify({page:t,limit:e}))},a.getPages=function(e){return Math.ceil((e||1)/a.state.activepage.limit)};var n=a.props.type,i=a.props.id,o=a.props.type,d=null,u=X()(window).height()-170+"px",h=!1,m=[{id:"id",desc:!0}],g={page:0,limit:50},y=[];Ma.columnsDisplay[a.props.type],Ma.columns[a.props.type],Ma.columnsClassName[a.props.type];null!=a.props.listViewSort&&(m=JSON.parse(a.props.listViewSort)),null!=a.props.listViewPage&&(g=JSON.parse(a.props.listViewPage)),null!=a.props.listViewFilter&&(y=JSON.parse(a.props.listViewFilter)),"alert"===a.props.type&&(h=!1,f="Alertgroup",n="alertgroup",o="alertgroup",d=i),"task"===a.props.type&&(n="task",o=a.props.queryType);var f=a.titleCase(a.props.type);return a.state={togglePreventClick:!1,splitter:!0,selectedColor:"#AEDAFF",sourcetags:[],tags:[],startepoch:"",endepoch:"",idtext:"",totalCount:0,activepage:g,statustext:"",subjecttext:"",idsarray:[],classname:[" "," "," "," "],alldetail:!0,viewsarrow:[0,0],idarrow:[-1,-1],subjectarrow:[0,0],statusarrow:[0,0],resize:"horizontal",createdarrow:[0,0],sourcearrow:[0,0],tagsarrow:[0,0],viewstext:"",entriestext:"",scrollheight:u,display:"flex",differentviews:"",maxwidth:"915px",maxheight:u,minwidth:"650px",suggestiontags:[],suggestionssource:[],sourcetext:"",tagstext:"",scrollwidth:"650px",reload:!1,viewfilter:!1,viewevent:!1,showevent:!0,objectarray:[],csv:!0,fsearch:"",listViewOrientation:"landscape-list-view",columns:Ma.columns[a.props.type],columnsDisplay:Ma.columnsDisplay[a.props.type],columnsClassName:Ma.columnsClassName[a.props.type],typeCapitalized:f,type:n,queryType:o,id:i,showSelectedContainer:h,listViewContainerDisplay:null,viewMode:a.props.viewMode,offset:0,sort:m,filter:y,match:null,alertPreSelectedId:d,entryid:a.props.id2,listViewKey:1,loading:!0,initialAutoScrollToId:!1,manualScrollHeight:null,showEntityCreateModal:!1,form:[]},a.handleRowSelection=a.handleRowSelection.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"handleRowSelection",value:function(e,t,a,n){var r=this;return{onClick:function(e){if(!0!==r.state.preventClick){if(r.state.id===t.row.id)return;var a=r.state.scrollheight;return"block"==r.state.display&&(a="30vh"),"task"===r.state.type?r.props.history.push("/task/"+t.row.target_type+"/"+t.row.target_id+"/"+t.row.id):r.props.history.push("/"+r.state.type+"/"+t.row.id),void r.setState({alertPreSelectedId:0,scrollheight:a,showSelectedContainer:!0})}r.props.errorToggle("Currently processing action(s). Please wait.")},className:t.row.id===parseInt(this.props.id)?"selected":null}}}]),t}(r.a.Component),zi=a(68),qi=a.n(zi),Ki=a(4),Gi=a.n(Ki),Ji=a(492),Yi=a.n(Ji),Qi=a(493),Xi=a.n(Qi),$i=a(232),Zi=a.n($i),eo=a(231),to=a.n(eo),ao=a(145),no=a.n(ao),ro=a(490),io=a.n(ro),oo=a(171),so=a.n(oo),lo=a(172),co=a.n(lo),po=function(e){return{textField:{marginLeft:"-8px",marginRight:e.spacing.unit},root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},textInput:{backgroundColor:"white",color:"black"}}},uo={username:"",fullname:"",password:"",description:"",name:"",id:null,suggestions:[],groups:[],active:0},ho=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).formatGroups=function(){if(a.props.groups.length>0){var e=[];a.props.groups.forEach(function(t){var a={};a.id=t.name,a.text=t.name,e.push(a)}),a.setState({suggestions:e})}},a.resetState=function(){a.setState(uo)},a.checkBlankInputs=function(e){var t=!1;return"user"===e?""!==a.state.username&&""!==a.state.fullname&&""!==a.state.password&&(t=!0):""!==a.state.name&&""!==a.state.description&&(t=!0),t},a.buildDataObj=function(e){var t={};return"user"===e?(t.username=a.state.username,t.fullname=a.state.fullname,t.password=a.state.password,t.groups=a.state.groups,t.active=a.state.active?1:0):"group"===e&&(t.name=a.state.name,t.description=a.state.description),t},a.handleGroups=function(e){var t=a.props,n=t.enqueueSnackbar,r=t.type;if(e.length>0){var i=[];e.forEach(function(e){i.push(e.id)}),a.setState({groups:i})}else n("Error handling groups  ".concat(r),{variant:"error"})},a.handlePUT=function(){var e=a.props,t=e.enqueueSnackbar,n=e.type,r=a.buildDataObj(n);a.checkBlankInputs(n)&&Le.a.put("/scot/api/v2/".concat(n,"/").concat(a.state.id),r).then(function(e){t("Successfully updated ".concat(n,"."),{variant:"success"}),this.resetState(),this.props.fetchData(n),this.props.handleClose()}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){t("Failed updating ".concat(n),{variant:"error"})})},a.handlePOST=function(){var e=a.props,t=e.enqueueSnackbar,n=e.type,r=a.buildDataObj(n);a.checkBlankInputs(n)&&Le.a.post("/scot/api/v2/".concat(n,"/"),r).then(function(e){console.log(e),t("Successfully added ".concat(n,"."),{variant:"success"}),this.resetState(),this.props.fetchData(n),this.props.handleClose()}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){t("Failed creating ".concat(n),{variant:"error"}),console.log(e)})},a.handleChange=function(e,t){if("input"===e.nativeEvent.type){var n=e.target.value;a.setState(Object(ze.a)({},e.target.id,n))}else"click"===e.nativeEvent.type?"checkbox"===e.target.type&&a.setState(Object(ze.a)({},e.target.value,t)):a.setState(Object(ze.a)({},e.target.name,t.props.value))},a.state=uo,a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.formatGroups(),this.props.editObject&&("user"===this.props.type?this.setState({username:this.props.editObject.username,fullname:this.props.editObject.fullname,password:this.props.editObject.password,id:this.props.editObject.id,active:this.props.editObject.active,groups:this.props.editObject.groups}):"group"===this.props.type&&this.setState({name:this.props.editObject.name,description:this.props.editObject.description,id:this.props.editObject.id}))}},{key:"render",value:function(){var e=this.props,t=e.classes;e.onClose,e.selectedValue,e.type,Object(w.a)(e,["classes","onClose","selectedValue","type"]);return r.a.createElement("div",null,r.a.createElement(or.a,{className:t.card},r.a.createElement(lr.a,null,this.props.editObject?r.a.createElement(rr.a,{variant:"h5",component:"h2"},"Edit ",this.props.type," ",r.a.createElement("b",null,this.props.editObject.username," ")):r.a.createElement(rr.a,{variant:"h5",component:"h2"},"Create ",this.props.type," "),"group"===this.props.type?r.a.createElement("div",null,r.a.createElement(no.a,{id:"name",label:"Group Name",value:this.state.name,onChange:this.handleChange,variant:"outlined",helperText:"Enter name of group",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(no.a,{id:"description",label:"Description",value:this.state.description,onChange:this.handleChange,variant:"outlined",helperText:"Enter description for group",InputLabelProps:{shrink:!0},fullWidth:!0,style:{marginTop:8,marginBottom:8}})):r.a.createElement("div",null,r.a.createElement(no.a,{id:"username",label:"Username",value:this.state.username,onChange:this.handleChange,variant:"outlined",helperText:"Enter a valid username",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(no.a,{id:"fullname",label:"Full Name",value:this.state.fullname,onChange:this.handleChange,variant:"outlined",helperText:"Provide your full name",fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(no.a,{id:"password",label:"Password",type:"password",autoComplete:"current-password",margin:"normal",variant:"outlined",helperText:"Enter a valid password",value:this.state.password,onChange:this.handleChange,fullWidth:!0,InputLabelProps:{shrink:!0},style:{marginTop:8,marginBottom:8}}),r.a.createElement("br",null),r.a.createElement(so.a,{control:r.a.createElement(co.a,{checked:this.state.active,onChange:this.handleChange,value:"active"}),label:"Active?"}),r.a.createElement("br",null),r.a.createElement("b",null,"Groups"),r.a.createElement(go,{editObject:this.props.editObject,handleGroups:this.handleGroups,id:this.state.id,suggestions:this.state.suggestions}),r.a.createElement("br",null)),r.a.createElement("br",null)),r.a.createElement(io.a,null,this.props.editObject?r.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},r.a.createElement(da.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),r.a.createElement(da.a,{variant:"contained",color:"secondary",onClick:this.handlePUT,className:t.button},"Submit")):r.a.createElement("div",{style:{marginLeft:350,marginBottom:5}},r.a.createElement(da.a,{style:{marginRight:5},variant:"contained",onClick:this.props.handleClose,className:t.button},"Cancel"),r.a.createElement(da.a,{variant:"contained",color:"secondary",onClick:this.handlePOST,className:t.button},"Submit")))))}}]),t}(r.a.Component),mo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).mapUsersGroupsToTags=function(){Le.a.get("/scot/api/v2/user?id=".concat(a.props.id)).then(function(e){var t=[];e.data.totalRecordCount>0&&(e.data.records.forEach(function(e){var a={};a.id=e.name,a.text=e.name,t.push(a)}),a.setState({groups:t}))})},a.handleDelete=function(e){var t=a.state.groups;a.setState({groups:t.filter(function(t,a){return a!==e})})},a.handleAddition=function(e){var t=a.props.enqueueSnackbar;if(a.checkValidGroup(e.id)){var n=a.state.groups;n.push(e),a.setState({groups:n}),a.props.handleGroups(a.state.groups)}else t("Invalid group. Please add an existing group")},a.state={groups:[]},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){if(this.props.editObject){var e=[];this.props.editObject.groups.forEach(function(t){var a={};a.id=t,a.text=t,e.push(a)}),this.setState({groups:e})}}},{key:"shouldComponentUpdate",value:function(e,t){return this.state!==t&&(this.props.handleGroups(t.groups),!0)}},{key:"checkValidGroup",value:function(e){return!!this.props.suggestions.some(function(t){return t.id===e})}},{key:"render",value:function(){var e=this.state.groups,t=this.props.suggestions;this.props.classes;return r.a.createElement("div",null,r.a.createElement(yi.WithContext,{classNames:{tagInput:"tagInputClass",tagInputField:"tagInputFieldClass"},placeholder:"Add a new group",inline:!1,tags:e,suggestions:t,handleDelete:this.handleDelete,handleAddition:this.handleAddition}))}}]),t}(r.a.Component),go=Object(gt.withStyles)(po)(mo),yo=Object(bn.withSnackbar)(Object(gt.withStyles)(po)(ho)),fo=a(1109),bo=a(1110),vo=a(307),Eo=a.n(vo),ko=a(308),wo=a.n(ko),So=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleDelete=function(){var e=a.props,t=e.enqueueSnackbar,n=e.type,r=e.id,i="/scot/api/v2/".concat(n,"/").concat(r);Le.a.delete(i).then(function(){t("Successfully deleted ".concat(n,"."),{variant:"success"}),this.props.fetchData(n),this.props.handleClose()}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){console.log(e),t("Failed deleting ".concat(n,"."),{variant:"error"}),this.props.handleClose()})},a.state={deletetext:""},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",null,r.a.createElement(or.a,{className:t.card},r.a.createElement(lr.a,null,r.a.createElement(rr.a,{variant:"h5",component:"h2"},"Are you sure you want to delete ",this.props.type," ",this.props.text,"?"),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(da.a,{style:{marginLeft:5,backgroundColor:"red",color:"white"},onClick:function(){return e.handleDelete(e.props.id)},variant:"contained"},"Yes"),r.a.createElement(da.a,{style:{marginLeft:5},onClick:this.props.handleClose,variant:"contained"},"Cancel")))))}}]),t}(r.a.Component),To=Object(bn.withSnackbar)(Object(gt.withStyles)(function(e){return{card:{minWidth:400,marginBottom:20}}})(So)),jo=a(112),Oo=a.n(jo),xo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).edit=function(e,t){var n="/scot/api/v2/".concat(e,"?id=").concat(t);Le.a.get(n).then(function(t){this.setState({editObject:t.data.records[0],type:e,showModal:!0})}.bind(Object(p.a)(Object(p.a)(a)))).catch(function(e){console.log(e)})},a.showUserDialog=function(){a.setState({showModal:!0,type:"user"})},a.showGroupDialog=function(){a.setState({showModal:!0,type:"group"})},a.handleUserClose=function(){a.setState({showModal:!1})},a.handleClose=function(e){a.setState({showModal:!1,id:null,type:"",editObject:null})},a.handleListItemClick=function(e){a.props.onClose(e)},a.getColumns=function(e){var t=[];return"user"===e?t=[{Header:"ID",accessor:"id",width:50},{Header:"Full Name",accessor:"fullname",width:90},{Header:"Username",accessor:"username",width:70},{Header:"Active",id:"active",accessor:function(e){return r.a.createElement("center",null,(e.active,r.a.createElement("div",null,r.a.createElement(so.a,{control:r.a.createElement(co.a,{onChange:function(){return a.handleActiveToggle(e.id)},checked:e.active,value:e.active})}))))},width:80},{Header:"Edit / Delete",id:"edit",accessor:function(t){return r.a.createElement("center",null,r.a.createElement(da.a,{size:"small",style:{marginLeft:5},onClick:function(){return a.edit(e,t.id)},variant:"contained"},"Edit"),r.a.createElement(da.a,{size:"small",style:{marginLeft:5},onClick:function(){return a.toggleAreYouSure(t.id,e)},color:"secondary",variant:"contained"},r.a.createElement(Eo.a,null)))},width:200}]:"group"===e&&(t=[{Header:"ID",accessor:"id",width:50},{Header:"Group Name",accessor:"name",width:100},{Header:"Group Description",accessor:"description",width:100},{Header:"Edit / Delete",id:"edit",accessor:function(t){return r.a.createElement("center",null,r.a.createElement(da.a,{size:"small",style:{marginLeft:5},onClick:function(){return a.edit(e,t.id)},variant:"contained"},"Edit"),r.a.createElement(da.a,{size:"small",style:{marginLeft:5},onClick:function(){return a.toggleAreYouSure(t.id,e)},color:"secondary",variant:"contained"},r.a.createElement(Eo.a,null)))},width:200}]),t},a.setUserGroupResults=function(e,t){"user"===e?a.setState({userdata:t.records}):"group"===e&&a.setState({groupdata:t.records})},a.toggleAreYouSure=function(e,t){a.setState({areYouSure:!0,id:e,type:t})},a.handleAreYouSureClose=function(){a.setState({areYouSure:!1})},a.fetchData=function(e){Le.a.get("/scot/api/v2/".concat(e,"?limit=0")).then(function(t){var n=t.data;return a.setUserGroupResults(e,n)})},a.handleActiveToggle=function(e){var t=a.getUserObject(e);a.setState({userdata:a.state.userdata.map(function(t){return t.id===e?Object(S.a)({},t,{active:!t.active}):t}),updateId:t.id})},a.getUserObject=function(e){return a.state.userdata.filter(function(t){return e===t.id?t:null})[0]},a.state={userdata:[],groupdata:[],showModal:!1,editObject:null,id:null,type:"",areYouSure:!1,updateId:null},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.props.enqueueSnackbar;if(t.userdata!==this.state.userdata&&null!==this.state.updateId){var n=this.getUserObject(this.state.updateId);Le.a.put("/scot/api/v2/user/".concat(this.state.updateId),{active:n.active}).then(function(e){a("Successfully updated user.",{variant:"success"}),this.setState({updateId:null})}.bind(this)).catch(function(e){a("Failed updating user",{variant:"error"})})}}},{key:"componentDidMount",value:function(){this.fetchData("user"),this.fetchData("group")}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=Object(w.a)(t,["classes"]),i=this.state,o=i.groupdata,s=i.userdata.length>10,l=o.length>10;return r.a.createElement("div",{className:a.root},r.a.createElement("br",null),r.a.createElement(Oo.a,{className:a.paper,elevation:1},r.a.createElement(rr.a,{variant:"h5",component:"h3"},"Please be advised"),r.a.createElement(rr.a,{component:"p"},"In order to properly add a user, they must belong to a group. A user is added to a group at time of creatino or upon 'Edit'. Groups MUST include the string 'scot' in the name or they will be ignored by the system. You must activate a user in order to begin logging in as the user.")),r.a.createElement("br",null),r.a.createElement(to.a,{container:!0,spacing:8},r.a.createElement(to.a,{item:!0,xs:12,sm:6},r.a.createElement(rr.a,{variant:"h4",gutterBottom:!0},"Users ",r.a.createElement(fo.a,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(rr.a,{variant:"h5",gutterBottom:!0},"Add User"),r.a.createElement(wo.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showUserDialog,color:"secondary","aria-label":"Add"},r.a.createElement(ka.a,null))),r.a.createElement(Yt.a,{data:this.state.userdata,columns:this.getColumns("user"),pageSize:this.state.userdata.length,defaultPageSize:10,showPagination:s})),r.a.createElement(to.a,{item:!0,xs:12,sm:6},r.a.createElement(rr.a,{variant:"h4",gutterBottom:!0},"Groups ",r.a.createElement(bo.a,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(rr.a,{variant:"h5",gutterBottom:!0},"Add Group"),r.a.createElement(wo.a,{style:{marginLeft:5,marginBottom:10,marginTop:-6},size:"small",onClick:this.showGroupDialog,color:"secondary","aria-label":"Add"},r.a.createElement(ka.a,null))),r.a.createElement(Yt.a,{data:this.state.groupdata,columns:this.getColumns("group"),pageSize:this.state.groupdata.length,defaultPageSize:10,showPagination:l}))),r.a.createElement(ur.a,{open:this.state.showModal,onClose:this.handleClose,"aria-labelledby":"simple-dialog-title"},r.a.createElement(yo,{id:this.state.id,groups:this.state.groupdata,type:this.state.type,editObject:this.state.editObject,handleClose:this.handleClose,fetchData:function(t){e.fetchData(t)}})),this.state.areYouSure?r.a.createElement(ur.a,Object.assign({open:this.state.areYouSure,onClose:this.handleAreYouSureClose,"aria-labelledby":"simple-dialog-title"},n),r.a.createElement(To,{type:this.state.type,fetchData:function(t){e.fetchData(t)},handleClose:this.handleAreYouSureClose,id:this.state.id})):null)}}]),t}(r.a.Component),Co=Object(bn.withSnackbar)(Object(gt.withStyles)(function(e){return{root:{flexGrow:1},paper:Object(S.a)({},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit})}})(xo)),Do=a(491),No=a.n(Do),Ao=a(176),_o=a.n(Ao),Mo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).GetKeys=a.GetKeys.bind(Object(p.a)(Object(p.a)(a))),a.GetAvailableGroups=a.GetAvailableGroups.bind(Object(p.a)(Object(p.a)(a))),a.CreateKey=a.CreateKey.bind(Object(p.a)(Object(p.a)(a))),a.DeleteKey=a.DeleteKey.bind(Object(p.a)(Object(p.a)(a))),a.GroupChange=a.GroupChange.bind(Object(p.a)(Object(p.a)(a))),a.ToggleActiveStatus=a.ToggleActiveStatus.bind(Object(p.a)(Object(p.a)(a))),a.state={Api:null,keys:null,availableGroups:null},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"GetKeys",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/apikey",success:function(e){this.setState({keys:e.records})}.bind(this),error:function(){this.setState({keys:"failed to get keys"})}.bind(this)})}},{key:"GetAvailableGroups",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/group?limit=0",success:function(e){this.setState({availableGroups:e.records})}.bind(this)})}},{key:"CreateKey",value:function(){X.a.ajax({type:"post",url:"/scot/api/v2/apikey",success:function(){this.GetKeys()}.bind(this)})}},{key:"DeleteKey",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/apikey/".concat(e.target.id),success:function(){this.GetKeys()}.bind(this)})}},{key:"GroupChange",value:function(e,t){X.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),data:JSON.stringify({groups:t}),contentType:"application/json; charset=UTF-8",success:function(){this.GetKeys()}.bind(this)})}},{key:"ToggleActiveStatus",value:function(e,t){X.a.ajax({type:"PUT",url:"/scot/api/v2/apikey/".concat(e),contentType:"application/json; charset=UTF-8",data:JSON.stringify({active:t}),success:function(){this.GetKeys()}.bind(this)})}},{key:"componentDidMount",value:function(){this.GetKeys(),this.GetAvailableGroups()}},{key:"render",value:function(){var e=[];if(void 0!=this.state.keys)for(var t=0;t<this.state.keys.length;t++){var a=void 0,n=[];if(a=1==this.state.keys[t].active?r.a.createElement("span",{style:{color:"green"}},"active"):r.a.createElement("span",{style:{color:"red"}},"not active"),void 0!=this.state.keys[t].groups)for(var i=0;i<this.state.keys[t].groups.length;i++)n.push(r.a.createElement("div",null,"this.state.keys[i].groups[j]"));e.push(r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",null,this.state.keys[t].apikey),r.a.createElement("div",null,this.state.keys[t].username),r.a.createElement("span",null,"Key is ",a),r.a.createElement("span",{className:"pull-right pointer"},r.a.createElement("i",{id:this.state.keys[t].id,className:"fa fa-trash","aria-hidden":"true",onClick:this.DeleteKey})),r.a.createElement("div",null,r.a.createElement(Lo,{id:this.state.keys[t].id,currentGroups:this.state.keys[t].groups,allGroups:this.state.availableGroups,GroupChange:this.GroupChange,ToggleActiveStatus:this.ToggleActiveStatus,keyActiveStatus:a,keyActiveStatusCss:void 0}))),r.a.createElement("hr",null)))}return r.a.createElement("div",{id:"api",className:"administration_api"},r.a.createElement("h1",null,"API"),r.a.createElement(No.a,{bsStyle:"info",header:"Your api keys"},e),r.a.createElement(Ka.a,{bsStyle:"success",onClick:this.CreateKey},"Create API Key"))}}]),t}(r.a.Component),Lo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).Open=a.Open.bind(Object(p.a)(Object(p.a)(a))),a.Close=a.Close.bind(Object(p.a)(Object(p.a)(a))),a.DeleteGroup=a.DeleteGroup.bind(Object(p.a)(Object(p.a)(a))),a.ToggleActiveStatus=a.ToggleActiveStatus.bind(Object(p.a)(Object(p.a)(a))),a.state={showModal:!1},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"Open",value:function(){this.setState({showModal:!0})}},{key:"Close",value:function(){this.setState({showModal:!1})}},{key:"DeleteGroup",value:function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var i,o=this.props.currentGroups[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var s=i.value;void 0!=s&&s!=e.target.parentNode.textContent&&t.push(s)}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}this.props.GroupChange(this.props.id,t)}},{key:"ToggleActiveStatus",value:function(){var e;e="active"==this.props.keyActiveStatus?0:1,this.props.ToggleActiveStatus(this.props.id,e)}},{key:"render",value:function(){var e=[],t=[];if(this.props.currentGroups){var a=!0,n=!1,i=void 0;try{for(var o,s=this.props.currentGroups[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;t.push(r.a.createElement("span",{className:"tagButton"},l,r.a.createElement("i",{id:this.props.id,onClick:this.DeleteGroup,className:"fa fa-times tagButtonClose"})))}}catch(g){n=!0,i=g}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}var c=!0,d=!1,p=void 0;try{for(var u,h=this.props.currentGroups[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var m=u.value;e.push(r.a.createElement("span",{className:"tagButton"},m))}}catch(g){d=!0,p=g}finally{try{c||null==h.return||h.return()}finally{if(d)throw p}}}return r.a.createElement("div",null,"Current Groups: ",e,r.a.createElement("div",null,r.a.createElement(Ka.a,{onClick:this.Open,bsSize:"small"},"Edit API key settings")),r.a.createElement(_o.a,{show:this.state.showModal,onHide:this.Close},r.a.createElement(_o.a.Header,{closeButton:!0},r.a.createElement(_o.a.Title,null,"Edit API key settings")),r.a.createElement(_o.a.Body,null,r.a.createElement("div",null,r.a.createElement("h4",null,"Current Groups:"),t),r.a.createElement("hr",null),r.a.createElement("div",null,"Key is ",r.a.createElement("span",{className:this.props.keyActiveStatusCss},this.props.keyActiveStatus),r.a.createElement(Ka.a,{onClick:this.ToggleActiveStatus,bsSize:"xsmall"},"Toggle Active Status")))))}}]),t}(r.a.Component),Io={READY:{style:"default"},LOADING:{text:"Processing...",style:"default",disabled:!0},SUCCESS:{text:"Success!",style:"success"},ERROR:{text:"Error!",style:"danger"}},Po=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={data:[],allSelected:!1},a.handleTHeadCheckboxSelection=a.handleTHeadCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleRowSelection=a.handleRowSelection.bind(Object(p.a)(Object(p.a)(a))),a.handleCheckboxSelection=a.handleCheckboxSelection.bind(Object(p.a)(Object(p.a)(a))),a.getDeletedItems=a.getDeletedItems.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0,this.getDeletedItems()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this,t=[{Header:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.state.allSelected?"-check":"","-square-o"),"aria-hidden":"true"})))},id:"selected",accessor:function(e){return e.selected},Cell:function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"mark-checkbox"},r.a.createElement("i",{className:"fa fa".concat(e.row.selected?"-check":"","-square-o"),"aria-hidden":"true"})))},maxWidth:100,filterable:!1},{Header:"Type",accessor:"type",maxWidth:150,sortable:!0},{Header:"ID",accessor:"data.id",id:"data.id",column:"id",maxWidth:100,sortable:!0},{Header:"Subject",accessor:"data.subject",id:"data.subject",column:"subject",maxWidth:"100%",sortable:!0},{Header:"Body",accessor:"data.body",id:"data.body",column:"body",maxWidth:"100%",sortable:!0}],a=[];for(var n in this.state.data)a.push(this.state.data[n].data);return r.a.createElement("div",null,this.state.data.length>0?r.a.createElement(Yt.a,{columns:t,data:this.state.data,defaultPageSize:10,getTdProps:this.handleCheckboxSelection,getTheadThProps:this.handleTHeadCheckboxSelection,getTrProps:this.handleRowSelection,minRows:0,noDataText:"No deleted items were found.",style:{maxHeight:"60vh"},filterable:!0}):r.a.createElement("h3",null,"No deleted items were found."),this.state.data.length>0?r.a.createElement(Ro,{data:this.state.data,id:this.props.id,type:this.props.type,getDeletedItems:this.getDeletedItems,errorToggle:this.props.errorToggle}):null)}},{key:"handleRowSelection",value:function(e,t,a){var n=this;return{onClick:function(e){var a=n.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;t.row["data.id"]==c.data.id&&t.row.type==c.type?c.selected=!0:c.selected=!1}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}n.setState({data:a,allSelected:!1})},style:{background:void 0!=t&&t.row.selected?"rgb(174, 218, 255)":null}}}},{key:"handleCheckboxSelection",value:function(e,t,a){var n=this;return"selected"==a.id?{onClick:function(e){var a=n.state.data,r=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;if(t.row["data.id"]==c.data.id&&t.row.type==c.type){c.selected?c.selected=!c.selected:c.selected=!0;break}}}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}n.setState({data:a,allSelected:n.checkAllSelected(a)}),e.stopPropagation()}}:{}}},{key:"handleTHeadCheckboxSelection",value:function(e,t,a,n){var r=this;return"selected"===a.id?{onClick:function(t){var a=r.state.data,n=!r.state.allSelected,i=!0,o=!1,s=void 0;try{for(var l,c=a[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value,p=!0,u=!1,h=void 0;try{for(var m,g=e.pageRows[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var y=m.value;if(d.data.id==y["data.id"]&&d.data.type==y["data.type"]){d.selected=n;break}}}catch(f){u=!0,h=f}finally{try{p||null==g.return||g.return()}finally{if(u)throw h}}}}catch(f){o=!0,s=f}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}r.setState({data:a,allSelected:n})}}:{}}},{key:"checkAllSelected",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(!r.value.selected)return!1}}catch(o){a=!0,n=o}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}return!0}},{key:"getDeletedItems",value:function(){X.a.ajax({type:"get",url:"/scot/api/v2/deleted/?limit=0",success:function(e){this.setState({data:e.records})}.bind(this),error:function(e){console.log("unable to get deleted items")}.bind(this)})}}]),t}(n.Component),Ro=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={entry:!1,thing:!1,actionSuccess:!1,linkContextString:null,linkPanel:!1,pendingDelete:!1,reparseButton:Io.READY,deleteButton:Io.READY,promoteButton:Io.READY},a.RemoveSelected=a.RemoveSelected.bind(Object(p.a)(Object(p.a)(a))),a.MoveEntry=a.MoveEntry.bind(Object(p.a)(Object(p.a)(a))),a.CopyEntry=a.CopyEntry.bind(Object(p.a)(Object(p.a)(a))),a.EntryAjax=a.EntryAjax.bind(Object(p.a)(Object(p.a)(a))),a.Link=a.Link.bind(Object(p.a)(Object(p.a)(a))),a.LinkAjax=a.LinkAjax.bind(Object(p.a)(Object(p.a)(a))),a.Reparse=a.Reparse.bind(Object(p.a)(Object(p.a)(a))),a.ReparseAjax=a.ReparseAjax.bind(Object(p.a)(Object(p.a)(a))),a.Promote=a.Promote.bind(Object(p.a)(Object(p.a)(a))),a.PromoteAjax=a.PromoteAjax.bind(Object(p.a)(Object(p.a)(a))),a.ToggleActionSuccess=a.ToggleActionSuccess.bind(Object(p.a)(Object(p.a)(a))),a.ExpandLinkToggle=a.ExpandLinkToggle.bind(Object(p.a)(Object(p.a)(a))),a.LinkContextChange=a.LinkContextChange.bind(Object(p.a)(Object(p.a)(a))),a.deleteCallback=a.deleteCallback.bind(Object(p.a)(Object(p.a)(a))),a.StartDelete=a.StartDelete.bind(Object(p.a)(Object(p.a)(a))),a.Restore=a.Restore.bind(Object(p.a)(Object(p.a)(a))),a.Purge=a.Purge.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"componentWillMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"deleteCallback",value:function(e){!0===e&&this.RemoveSelected(),this.setState({pendingDelete:!1})}},{key:"render",value:function(){var e=!0,t=0,a=!0,n=!1,i=void 0;try{for(var o,s=this.props.data[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;l.type&&l.selected&&(t++,"entry"===l.type?!0:!0,"alert"!==l.type&&(e=!1))}}catch(d){n=!0,i=d}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}0!=t&&e&&this.props.type;var c=this.state;c.reparseButton,c.deleteButton,c.promoteButton;return c.pendingDelete&&this.props.data.filter(function(e){return e.selected}).map(function(e){return{type:e.type,id:e.id}}),r.a.createElement("div",null,r.a.createElement(ki.a,{ref:"notificationSystem"}),this.state.actionSuccess?r.a.createElement("div",null,r.a.createElement(W.a,{bsStyle:"success",onClick:this.props.getDeletedItems},"Action Successful! Click to reload data.")):r.a.createElement("div",{style:{display:"grid"}},r.a.createElement("div",null,r.a.createElement("h4",{style:{float:"left"}})," ",this.props.data.length>0?r.a.createElement("h4",{style:{float:"left"}},"Select a Deleted Object"):null,r.a.createElement(Zt.a,{style:{float:"right"}},r.a.createElement(W.a,{bsStyle:"success",onClick:this.Restore},"Restore"),r.a.createElement(W.a,{bsStyle:"danger",onClick:this.Purge},"Purge")))))}},{key:"Restore",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=this.props.data[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.selected&&X.a.ajax({type:"put",url:"/scot/api/v2/deleted/"+o.id,data:JSON.stringify({status:"undelete"}),success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Restored",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to restore items")}.bind(this)})}}catch(s){a=!0,n=s}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}}},{key:"Purge",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,i=this.props.data[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.selected&&X.a.ajax({type:"delete",url:"/scot/api/v2/deleted/"+o.id,success:function(){this.refs.notificationSystem.addNotification({message:"Successfully Purged",level:"success",autoDismiss:0}),this.props.getDeletedItems()}.bind(this),error:function(){console.log("failed to purge items")}.bind(this)})}}catch(s){a=!0,n=s}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}}},{key:"LinkContextChange",value:function(e){this.setState({linkContextString:e.target.value})}},{key:"ExpandLinkToggle",value:function(e){if(1==e||0==e)this.setState({linkPanel:e,linkContextString:""});else{var t=!this.state.linkPanel;this.setState({linkPanel:t,linkContextString:""})}}},{key:"RemoveSelected",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;i.selected&&$a(i.type,i.id)}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}this.props.getDeletedItems(),this.state.actionSuccess&&this.setState({actionSuccess:!1})}},{key:"StartDelete",value:function(){this.setState({pendingDelete:!0})}},{key:"MoveEntry",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;i.selected&&"entry"==i.type&&this.EntryAjax(i.id,!0)}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}},{key:"CopyEntry",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;i.selected&&"entry"==i.type&&this.EntryAjax(i.id,!1)}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}},{key:"Link",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;if(i.selected){var o=[],s={},l={};s.id=parseInt(i.id),s.type=i.type,l.id=parseInt(this.props.id),l.type=this.props.type,o.push(s),o.push(l),this.LinkAjax(o)}}}catch(c){t=!0,a=c}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}},{key:"Reparse",value:function(){var e=this;this.setState({reparseButton:Io.LOADING}),X.a.when.apply(X.a,Object(T.a)(this.props.data.filter(function(e){return e.selected}).map(function(t){return e.ReparseAjax(t)}))).then(function(){e.setState({reparseButton:Io.SUCCESS})},function(t){console.error(t),e.setState({reparseButton:Io.ERROR}),e.props.errorToggle("error reparsing",t)}).always(function(){setTimeout(function(){e.setState({reparseButton:Io.READY})},2e3)})}},{key:"ReparseAjax",value:function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/"+e.type+"/"+e.id,data:JSON.stringify({parsed:0}),contentType:"application/json; charset=UTF-8"})}},{key:"Promote",value:function(){var e=this;this.setState({promoteButton:Io.LOADING});var t=!0;X.a.when.apply(X.a,Object(T.a)(this.props.data.filter(function(e){return e.selected}).map(function(t){return e.PromoteAjax(t)}))).then(function(){e.setState({promoteButton:Io.SUCCESS})},function(a){t=!1,console.error(a),e.setState({promoteButton:Io.ERROR}),e.props.errorToggle("error adding alerts to event",a)}).always(function(){setTimeout(function(){e.setState({promoteButton:Io.READY}),t&&window.location.reload()},2e3)})}},{key:"PromoteAjax",value:function(e){return X.a.ajax({type:"put",url:"/scot/api/v2/alert/"+e.id,data:JSON.stringify({promote:parseInt(this.props.id)}),contentType:"application/json; charset=UTF-8"})}},{key:"LinkAjax",value:function(e){var t={weight:1};t.vertices=e,this.state.linkContextString&&(t.context=this.state.linkContextString),X.a.ajax({type:"post",url:"/scot/api/v2/link",data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){console.log("successfully linked"),this.ExpandLinkToggle(!1),this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to link",e)}.bind(this)})}},{key:"EntryAjax",value:function(e,t){X.a.ajax({type:"get",url:"/scot/api/v2/entry/"+e,success:function(a){var n;n={parent:0,body:a.body,target_id:parseInt(this.props.id),target_type:this.props.type},X.a.ajax({type:"post",url:"/scot/api/v2/entry",data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(a){t?(this.RemoveEntryAfterMove(e),this.RemoveSelected()):this.state.actionSuccess||this.ToggleActionSuccess(!0)}.bind(this),error:function(e){this.props.errorToggle("failed to create new entry",e)}.bind(this)})}.bind(this),error:function(e){this.props.errorToggle("failed to get entry data",e)}.bind(this)})}},{key:"RemoveEntryAfterMove",value:function(e){X.a.ajax({type:"delete",url:"/scot/api/v2/entry/"+e,success:function(e){console.log("removed original entry")}.bind(this),error:function(e){this.props.errorToggle("Failed to remove original entry",e)}.bind(this)})}},{key:"ToggleActionSuccess",value:function(e){if(1==e||0==e)this.setState({actionSuccess:e});else{var t=!this.state.actionSuccess;this.setState({actionSuccess:t})}}}]),t}(n.Component);function Fo(e){return r.a.createElement(rr.a,{component:"div",style:{padding:24}},e.children)}Ro.defaultProps={data:{}},Po.defaultProps={modalActive:!0};var Uo=Object(gt.createMuiTheme)({typography:{fontSize:20}}),Ho=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={value:0},a.handleChange=function(e,t){a.setState({value:t})},a}return Object(d.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state.value;return r.a.createElement(gt.MuiThemeProvider,{theme:Uo},r.a.createElement("div",{className:e.root},r.a.createElement(Yi.a,{className:Gi()(e.appBar,e.typography),position:"static"},r.a.createElement(Xi.a,{value:t,indicatorColor:"primary",centered:!0,onChange:this.handleChange},r.a.createElement(Zi.a,{label:"Users / Groups"}),r.a.createElement(Zi.a,{label:"API"}),r.a.createElement(Zi.a,{label:"Undelete"}))),0===t&&r.a.createElement(Fo,null,r.a.createElement(Co,null)),1===t&&r.a.createElement(Fo,null,r.a.createElement(Mo,null)),2===t&&r.a.createElement(Fo,null,r.a.createElement(Po,null))))}}]),t}(r.a.Component),Wo=Object(gt.withStyles)(function(e){return{root:{flexGrow:1},appBar:{backgroundColor:"#2196f3"},typography:{fontSize:20}}})(Ho),Bo=function(){function e(){var t=this;Object(s.a)(this,e),this.s4=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},this.get_guid=function(){return t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()+t.s4()},this.register_client=function(e){t.client=t.get_guid(),t.whoami=ue("whoami"),X.a.ajax({type:"POST",url:"/scotaq/amq",data:{message:"chat",type:"listen",clientId:t.client,destination:"topic://scot"},success:function(t){console.log("Registered client as "+this.client),e||setTimeout(function(){this.get_data()}.bind(this),1e3)}.bind(t),error:function(e){console.log("Error: failed to register client, retry in 1 sec"),setTimeout(function(){this.register_client()},1e3)}})},this.get_data=function(){var e=new Date;X.a.ajax({type:"GET",url:"/scotaq/amq",data:{clientId:t.client,timeout:2e4,d:e.getTime(),r:Math.random(),json:"true",username:t.whoami},success:function(e){console.log("Received Message"),setTimeout(function(){this.get_data()}.bind(this),40),X()(e).text().split("\n").forEach(function(e,t){if(""!==e){var a=JSON.parse(e);return console.log(a),this.process_message(a),this.handle_update(a),!0}}.bind(this))}.bind(t),error:function(){setTimeout(function(){this.getData(this.client)}.bind(this),1e3),console.log("AMQ not detected, retrying in 1 second.")}})},this.create_callback_object=function(e,a){var n=e;if(t.checkNumber(n)&&(n=parseInt(n,10)),t.cb_map.has(n))t.cb_map.get(n).add(a);else{var r=new Set;r.add(a),t.cb_map.set(n,r)}},this.remove_callback_object=function(e){t.cb_map.delete(e)},this.process_message=function(e){"wall"===e.action?(t.activemqwho=e.data.who,t.activemqmessage=e.data.message,t.activemqwhen=e.data.when,t.activemqwall=!0):(t.activemqaction=e.action,t.activemqid=e.data.id,t.activemqtype=e.data.type,t.activemqwho=e.data.who,t.activemqguid=e.guid,t.activemqhostname=e.hostname,t.activemqpid=e.pid)},this.execute_callback_function=function(e){try{var a=t.cb_map.get(e);void 0!==a&&a.forEach(function(e){e()});var n=t.cb_map.get("notification");void 0!==n&&n.forEach(function(e){e()})}catch(r){throw r}},this.handle_update=function(e){var a="";"wall"===e.action?a="wall":"created"===e.action?a="".concat(e.data.type,":listview"):"updated"===e.action?a=e.data.id:"deleted"===e.action&&(a=e.data.id),t.execute_callback_function(a)},this.client="",this.whoami="",this.amqdebug="",this.activemqaction="",this.activemqaction="",this.activemqid="",this.activemqwho="",this.activemqtype="",this.activemqguid="",this.activemqhostname="",this.activemqpid="",this.activemqwhen="",this.activemqwall="",this.cb_map=new Map}return Object(j.a)(e,[{key:"checkNumber",value:function(e){var t=parseInt(e,10);return!isNaN(t)}}]),e}(),Vo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).componentWillReceiveProps=function(e){var t=At("viewMode"),n=At("notification");if(e.match.params.value)var r=At("listViewFilter"+e.match.params.value.toLowerCase()),i=At("listViewSort"+e.match.params.value.toLowerCase()),o=At("listViewPage"+e.match.params.value.toLowerCase());void 0===n&&(n="on"),a.state.handler||a.GetHandler(),a.state.whoami||a.WhoAmIQuery(),a.setState({viewMode:t,notificationSetting:n,listViewFilter:r,listViewSort:i,listViewPage:o})},a.componentDidMount=function(){a.GetHandler(),a.WhoAmIQuery(),a.AMQ.register_client(),a.AMQ.create_callback_object("wall",a.wall),a.AMQ.create_callback_object("notification",a.notification),"/"===a.props.match.url&&X()(document.body).keydown(function(e){this.ee(e)}.bind(Object(p.a)(Object(p.a)(a))))},a.eedraw=function(){X()("#content").css("transform","rotateX(20deg)"),X()(document.body).prepend('<span id="ee">Lbh sbhaq gur rtt. Cbfg gb gur jnyy "V sbhaq gur rtt, pna lbh?"</span>')},a.eeremove=function(){X()("#content").css("transform","rotateX(0deg)"),X()("#ee").remove()},a.componentWillUnmount=function(){pe("whoami")},a.componentWillMount=function(){var e=At("notification");void 0==e&&(e="on"),a.setState({notificationSetting:e})},a.ee=function(e){var t="837279877769847269697171";if(t.includes(a.state.eestring))if(a.state.eestring+e.keyCode===t)a.eedraw(),setTimeout(a.eeremove,2e3);else{if(X()("input").is(":focus"))return;if(!0!==e.ctrlKey&&!0!==e.metaKey){var n=a.state.eestring+e.keyCode;a.setState({eestring:n})}}else a.setState({eestring:""})},a.notification=function(){if("/"!==a.props.match.path||!a.props.match.isExact||!Te.includes(a.props.stateProps.activemqstate)){var e=a.refs.notificationSystem;if("scot-alerts"!==a.AMQ.activemqwho&&"scot-admin"!==a.AMQ.activemqwho&&"scot-flair"!==a.AMQ.activemqwho&&void 0!==e&&a.AMQ.activemqwho!==a.state.whoami&&""!==a.AMQ.activemqwho&&"api"!==a.AMQ.activemqwho&&!0!==a.AMQ.activemqwall&&"entity"!==a.AMQ.activemqtype&&"on"===a.state.notificationSetting){var t="".concat(a.AMQ.activemqwho," ").concat(a.AMQ.activemqaction," ").concat(a.AMQ.activemqtype," : ").concat(a.AMQ.activemqid),n=a.AMQ.activemqtype,r=a.AMQ.activemqstate,i=a.AMQ.activemqid;e.addNotification({message:t,level:"info",autoDismiss:5,action:"delete"!==r?{label:"View",callback:function(){window.open("/#/"+n+"/"+i)}}:null})}}},a.wall=function(e){if("/"!==a.props.match.path||!a.props.match.isExact){var t=a.refs.notificationSystem,n=new Date(1e3*a.AMQ.activemqwhen);n=n.toLocaleString(),!0===a.AMQ.activemqwall&&t.addNotification({message:n+" "+a.AMQ.activemqwho+": "+a.AMQ.activemqmessage,level:"warning",autoDismiss:0})}},a.errorToggle=function(e,t){var n=e;if(t)if(t.responseJSON){if("Authentication Required"===t.responseJSON.error)return a.setState({csrf:t.responseJSON.csrf}),void a.loginToggle(t.responseJSON.csrf)}else"Service Unavailable"===t.statusText&&(n=t.statusText);a.refs.notificationSystem.addNotification({message:n,level:"error",autoDismiss:0})},a.notificationToggle=function(){"off"===a.state.notificationSetting?(a.setState({notificationSetting:"on"}),Lt("notification","on",1e3)):(a.setState({notificationSetting:"off"}),Lt("notification","off",1e3))},a.loginToggle=function(e,t){if(a.state.login||!0===t)a.state.login&&!0===t&&(a.setState({login:!1}),a.props.history.push(a.state.origurl));else{var n=a.props.location.pathname;a.props.history.push("/"),a.setState({login:!0,origurl:n})}},a.LogOut=function(){X.a.ajax({type:"get",url:"/logout",success:function(e){this.setState({login:!0}),console.log("Successfully logged out"),this.WhoAmIQuery()}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.error("Failed to log out",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.WhoAmIQuery=function(){X.a.ajax({type:"get",url:"scot/api/v2/whoami",success:function(e){de("whoami",e.user),e.data&&this.setState({sensitivity:e.data.sensitivity,whoami:e.user})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.GetHandler=function(){X.a.ajax({type:"get",url:"/scot/api/v2/handler?current=1",success:function(e){this.setState({handler:e.records[0].username})}.bind(Object(p.a)(Object(p.a)(a))),error:function(e){this.errorToggle("Failed to get current user",e)}.bind(Object(p.a)(Object(p.a)(a)))})},a.render=function(){var e,t="Incident Handler: "+a.state.handler;return a.props.match.params.value&&(e=a.props.match.params.value.toLowerCase()),r.a.createElement(R,null,r.a.createElement(h.a,{inverse:!0,fixedTop:!0,fluid:!0},r.a.createElement(h.a.Header,null,r.a.createElement(h.a.Brand,null,r.a.createElement(Ae.a,{to:"/",style:{margin:"0",padding:"0"}},r.a.createElement("img",{src:"/images/scot-600h.png",alt:"",style:{width:"50px"}}))),r.a.createElement(h.a.Toggle,null)),r.a.createElement(h.a.Collapse,null,r.a.createElement(g.a,null,r.a.createElement(qi.a,{to:"/alertgroup",activeClassName:"active"},r.a.createElement(f.a,null,"Alert")),r.a.createElement(qi.a,{to:"/event",activeClassName:"active"},r.a.createElement(f.a,null,"Event")),r.a.createElement(qi.a,{to:"/incident",activeClassName:"active"},r.a.createElement(f.a,null,"Incident")),r.a.createElement(qi.a,{to:"/intel",activeClassName:"active"},r.a.createElement(f.a,null,"Intel")),r.a.createElement(v.a,{id:"nav-dropdown",title:"More"},r.a.createElement(qi.a,{to:"/task",activeClassName:"active"},r.a.createElement(k.a,null,"Task")),r.a.createElement(qi.a,{to:"/guide",activeClassName:"active"},r.a.createElement(k.a,null,"Guide")),r.a.createElement(k.a,{href:"/revl.html#/visualization"},"Visualization"),r.a.createElement(qi.a,{to:"/signature",activeClassName:"active"},r.a.createElement(k.a,null,"Signature")),r.a.createElement(qi.a,{to:"/entity",activeClassName:"active"},r.a.createElement(k.a,null,"Entity")),r.a.createElement(qi.a,{to:"/reports",activeClassName:"active"},r.a.createElement(k.a,null,"Reports")),r.a.createElement(k.a,{divider:!0}),r.a.createElement(qi.a,{to:"/admin",activeClassName:"active"},r.a.createElement(k.a,null,"Administration")),r.a.createElement(k.a,{href:"/docs/index.html"},"Documentation"),r.a.createElement(k.a,{divider:!0}),r.a.createElement(k.a,{href:"/cyberchef.htm"},"Cyber Chef"),r.a.createElement(k.a,{divider:!0}),r.a.createElement(k.a,{href:"/#/",onClick:a.LogOut},"Log Out")),r.a.createElement(f.a,{href:"/incident_handler.html"},t)),r.a.createElement("span",{id:"ouo_warning",className:"ouo-warning"},a.state.sensitivity),r.a.createElement("span",{id:"scot_version",style:{float:"right",marginTop:"3px",padding:"10px 10px",position:"relative",color:"white"},className:"scot_version"},"V3.7"),r.a.createElement(Ut,{errorToggle:a.errorToggle}))),r.a.createElement("div",{className:"mainNavPadding"},r.a.createElement(Gt,{csrf:a.state.csrf,modalActive:a.state.login,loginToggle:a.loginToggle,WhoAmIQuery:a.WhoAmIQuery,GetHandler:a.GetHandler,errorToggle:a.errorToggle,origurl:a.state.origurl}),r.a.createElement(ki.a,{ref:"notificationSystem"}),r.a.createElement(Jt.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(Nt,{loggedIn:!a.state.login,sensitivity:a.state.sensitivity,errorToggle:a.errorToggle,clientId:a.state.clientId,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object})}}),"admin"===e?r.a.createElement(Jt.a,{exact:!0,path:"/admin"},r.a.createElement(Wo,null)):null,"alert"===e?r.a.createElement(Jt.a,{exact:!0,path:"/alert"},r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object})):null,"alertgroup"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"entry"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"event"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"incident"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"task"===e?r.a.createElement(Vi,{isTask:!0,queryType:a.props.match.params.type,viewMode:a.state.viewMode,type:a.props.match.params.value,id:a.props.match.params.id,id2:a.props.match.params.id2,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"guide"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"intel"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"signature"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"entity"===e?r.a.createElement(Vi,{id:a.props.match.params.id,id2:a.props.match.params.id2,viewMode:a.state.viewMode,type:e,notificationToggle:a.notificationToggle,notificationSetting:a.state.notificationSetting,listViewFilter:a.state.listViewFilter,listViewSort:a.state.listViewSort,listViewPage:a.state.listViewPage,errorToggle:a.errorToggle,history:a.props.history,createCallback:a.AMQ.create_callback_object,removeCallback:a.AMQ.remove_callback_object}):null,"reports"===e&&!a.props.match.params.id&&r.a.createElement(dt,null),"reports"===e&&a.props.match.params.id&&r.a.createElement(pt,{reportType:a.props.match.params.id}),"wall"===e?r.a.createElement(Vt,{errorToggle:a.errorToggle}):null))},a.state={open:!1,notificationSetting:"on",login:!1,csrf:"",origurl:"",sensitivity:"",whoami:void 0,handler:void 0,eestring:"",clientId:null},a.notification=a.notification.bind(Object(p.a)(Object(p.a)(a))),a.loginToggle=a.loginToggle.bind(Object(p.a)(Object(p.a)(a))),a.errorToggle=a.errorToggle.bind(Object(p.a)(Object(p.a)(a))),a.AMQ=new Bo,a}return Object(d.a)(t,e),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var zo=a(223),qo=a(222),Ko=a(47).createBrowserHistory;o.a.render(r.a.createElement(qo.a,{history:Ko()},r.a.createElement(bn.SnackbarProvider,null,r.a.createElement(zo.a,null,r.a.createElement(Jt.a,{exact:!0,path:"/",component:Vo}),r.a.createElement(Jt.a,{exact:!0,path:"/:value",component:Vo}),r.a.createElement(Jt.a,{exact:!0,path:"/:value/:id",component:Vo}),r.a.createElement(Jt.a,{exact:!0,path:"/:value/:id/:id2",component:Vo}),r.a.createElement(Jt.a,{path:"/:value/:type/:id/:id2",component:Vo})))),document.getElementById("root"))},303:function(e,t,a){},477:function(e,t,a){e.exports=a.p+"static/media/scot_logo_473x473.981c5c79.png"},511:function(e,t,a){e.exports=a(1093)}},[[511,1,2]]]);
//# sourceMappingURL=main.3044e650.chunk.js.map